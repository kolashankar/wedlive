(()=>{var e={};e.id=4730,e.ids=[4730],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},85923:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d}),a(79043),a(73603),a(35866);var s=a(23191),r=a(88716),i=a(37922),l=a.n(i),n=a(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d=["",{children:["admin",{children:["video-templates",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,79043)),"/app/frontend/app/admin/video-templates/page.js"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,73603)),"/app/frontend/app/layout.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/app/frontend/app/admin/video-templates/page.js"],m="/admin/video-templates/page",p={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/video-templates/page",pathname:"/admin/video-templates",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},58744:(e,t,a)=>{Promise.resolve().then(a.bind(a,2179))},2179:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(10326),r=a(17577),i=a(35047),l=a(94464),n=a(18729),o=a(38705),d=a(50560),c=a(20835),m=a(83855),p=a(88307),u=a(49758),x=a(33734),h=a(69508),f=a(98091),g=a(78364);let v=(0,a(61358).bR)();function y(){let e=(0,i.useRouter)(),{toast:t}=(0,g.pm)(),[a,y]=(0,r.useState)([]),[b,j]=(0,r.useState)(!0),[N,w]=(0,r.useState)(""),[_,S]=(0,r.useState)("all"),T=async()=>{let e=localStorage.getItem("token");if(e)try{j(!0);let t=(await l.Z.get(`${v}/api/admin/video-templates`,{headers:{Authorization:`Bearer ${e}`},params:{search:N||void 0,category:"all"!==_?_:void 0}})).data||[];if(console.log("[VIDEO_TEMPLATES] Loaded templates:",t.length),t.length>0){let e=t[0];console.log("[VIDEO_TEMPLATES] First template thumbnail:",{name:e.name,has_thumbnail:!!e.preview_thumbnail,thumbnail_url:e.preview_thumbnail?.url,thumbnail_file_id:e.preview_thumbnail?.telegram_file_id})}y(t)}catch(e){console.error("Failed to load templates:",e),t({title:"Error",description:"Failed to load video templates",variant:"destructive"})}finally{j(!1)}},E=async e=>{if(!confirm("Are you sure you want to delete this template?"))return;let a=localStorage.getItem("token");try{await l.Z.delete(`${v}/api/admin/video-templates/${e}`,{headers:{Authorization:`Bearer ${a}`}}),t({title:"Success",description:"Template deleted successfully"}),T()}catch(e){console.error("Failed to delete template:",e),t({title:"Error",description:"Failed to delete template",variant:"destructive"})}},C=async(e,a)=>{let s=localStorage.getItem("token");try{await l.Z.put(`${v}/api/admin/video-templates/${e}`,{is_featured:!a},{headers:{Authorization:`Bearer ${s}`}}),t({title:"Success",description:`Template ${a?"unfeatured":"featured"}`}),T()}catch(e){console.error("Failed to toggle featured:",e),t({title:"Error",description:"Failed to update template",variant:"destructive"})}},Z=a.filter(e=>{let t=e.name.toLowerCase().includes(N.toLowerCase())||e.description?.toLowerCase().includes(N.toLowerCase()),a="all"===_||e.category===_;return t&&a});return s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Video Templates"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage wedding video templates with dynamic overlays"})]}),(0,s.jsxs)(n.z,{onClick:()=>e.push("/admin/video-templates/new"),className:"gap-2","data-testid":"create-template-btn",children:[s.jsx(m.Z,{className:"w-4 h-4"}),"Create Template"]})]}),s.jsx(d.Zb,{className:"p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[s.jsx("div",{className:"flex-1 min-w-[200px]",children:(0,s.jsxs)("div",{className:"relative",children:[s.jsx(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(o.I,{placeholder:"Search templates...",value:N,onChange:e=>w(e.target.value),className:"pl-10","data-testid":"search-templates-input"})]})}),s.jsx("div",{className:"flex gap-2",children:["all","invitation","announcement","save-the-date","general"].map(e=>s.jsx(n.z,{variant:_===e?"default":"outline",onClick:()=>S(e),size:"sm","data-testid":`filter-${e}-btn`,children:e.replace("-"," ").charAt(0).toUpperCase()+e.slice(1).replace("-"," ")},e))})]})}),b?(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading templates..."})]}):0===Z.length?(0,s.jsxs)(d.Zb,{className:"p-12 text-center",children:[s.jsx(u.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No templates found"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"Create your first video template to get started"}),(0,s.jsxs)(n.z,{onClick:()=>e.push("/admin/video-templates/new"),children:[s.jsx(m.Z,{className:"w-4 h-4 mr-2"}),"Create Template"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Z.map(t=>(0,s.jsxs)(d.Zb,{className:"overflow-hidden hover:shadow-lg transition-shadow","data-testid":`template-card-${t.id}`,children:[(0,s.jsxs)("div",{className:"relative aspect-video bg-gradient-to-br from-gray-800 to-gray-900",children:[t.preview_thumbnail?.url?(0,s.jsxs)(s.Fragment,{children:[s.jsx("img",{src:t.preview_thumbnail.url,alt:t.name,className:"w-full h-full object-cover",onError:e=>{console.error(`[VIDEO_TEMPLATES] Failed to load thumbnail for ${t.name}:`,t.preview_thumbnail.url),e.target.style.display="none";let a=e.target.parentElement.querySelector(".thumbnail-placeholder");a&&(a.style.display="flex")},onLoad:e=>{console.log(`[VIDEO_TEMPLATES] Successfully loaded thumbnail for ${t.name}`)}}),(0,s.jsxs)("div",{className:"thumbnail-placeholder flex-col items-center justify-center h-full absolute inset-0 bg-gradient-to-br from-gray-800 to-gray-900",style:{display:"none"},children:[s.jsx(u.Z,{className:"w-16 h-16 text-gray-500 mb-2"}),s.jsx("p",{className:"text-xs text-gray-500 text-center px-4",children:"Thumbnail unavailable"})]})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[s.jsx(u.Z,{className:"w-16 h-16 text-gray-500 mb-2"}),s.jsx("p",{className:"text-xs text-gray-500 text-center px-4",children:"No thumbnail"})]}),t.metadata?.is_featured&&s.jsx("div",{className:"absolute top-2 right-2",children:(0,s.jsxs)(c.C,{className:"bg-yellow-500 text-white",children:[s.jsx(x.Z,{className:"w-3 h-3 mr-1"}),"Featured"]})}),s.jsx("div",{className:"absolute bottom-2 left-2",children:(0,s.jsxs)(c.C,{variant:"secondary",children:[t.video_data?.duration_seconds,"s"]})})]}),(0,s.jsxs)("div",{className:"p-4",children:[s.jsx("div",{className:"flex justify-between items-start mb-2",children:s.jsx("h3",{className:"font-semibold text-lg truncate flex-1",title:t.name,children:t.name})}),s.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:t.description||"No description"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-3 flex-wrap",children:[s.jsx(c.C,{variant:"outline",children:t.category}),(0,s.jsxs)(c.C,{variant:"outline",children:[t.text_overlays?.length||0," overlays"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(n.z,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>e.push(`/admin/video-templates/${t.id}`),"data-testid":"edit-template-btn",children:[s.jsx(h.Z,{className:"w-4 h-4 mr-1"}),"Edit"]}),s.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>C(t.id,t.metadata?.is_featured),"data-testid":"toggle-featured-btn",children:s.jsx(x.Z,{className:`w-4 h-4 ${t.metadata?.is_featured?"fill-yellow-500 text-yellow-500":""}`})}),s.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>E(t.id),className:"text-red-600 hover:text-red-700","data-testid":"delete-template-btn",children:s.jsx(f.Z,{className:"w-4 h-4"})})]})]})]},t.id))})]})})}},20835:(e,t,a)=>{"use strict";a.d(t,{C:()=>n});var s=a(10326);a(17577);var r=a(79360),i=a(46084);let l=(0,r.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:t,...a}){return s.jsx("div",{className:(0,i.cn)(l({variant:t}),e),...a})}},50560:(e,t,a)=>{"use strict";a.d(t,{Ol:()=>n,SZ:()=>d,Zb:()=>l,aY:()=>c,eW:()=>m,ll:()=>o});var s=a(10326),r=a(17577),i=a(46084);let l=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...t}));l.displayName="Card";let n=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));n.displayName="CardHeader";let o=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let d=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let c=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let m=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t}));m.displayName="CardFooter"},38705:(e,t,a)=>{"use strict";a.d(t,{I:()=>l});var s=a(10326),r=a(17577),i=a(46084);let l=r.forwardRef(({className:e,type:t,...a},r)=>s.jsx("input",{type:t,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...a}));l.displayName="Input"},78364:(e,t,a)=>{"use strict";a.d(t,{pm:()=>p});var s=a(17577);let r=0,i=new Map,l=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=n(d,e),o.forEach(e=>{e(d)})}function m({...e}){let t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function p(){let[e,t]=s.useState(d);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},83855:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},88307:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},69508:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},33734:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},98091:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},49758:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]])},79043:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>n});var s=a(68570);let r=(0,s.createProxy)(String.raw`/app/frontend/app/admin/video-templates/page.js`),{__esModule:i,$$typeof:l}=r;r.default;let n=(0,s.createProxy)(String.raw`/app/frontend/app/admin/video-templates/page.js#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[8948,168,4342],()=>a(85923));module.exports=s})();