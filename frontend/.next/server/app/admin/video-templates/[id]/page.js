(()=>{var e={};e.id=2609,e.ids=[2609],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},86996:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),a(33140),a(73603),a(35866);var i=a(23191),s=a(88716),l=a(37922),n=a.n(l),r=a(95231),o={};for(let e in r)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>r[e]);a.d(t,o);let d=["",{children:["admin",{children:["video-templates",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,33140)),"/app/frontend/app/admin/video-templates/[id]/page.js"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,73603)),"/app/frontend/app/layout.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/app/frontend/app/admin/video-templates/[id]/page.js"],u="/admin/video-templates/[id]/page",m={require:a,loadChunk:()=>Promise.resolve()},x=new i.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/video-templates/[id]/page",pathname:"/admin/video-templates/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},37292:(e,t,a)=>{Promise.resolve().then(a.bind(a,92724))},92724:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Y});var i=a(10326),s=a(17577),l=a(35047),n=a(94464),r=a(50560),o=a(18729),d=a(240),c=a(6917),u=a(99597),m=a(20835),x=a(79349),h=a(38705),p=a(64745),g=a(63096),y=a(1572),v=a(31215);let f=[{value:"bride_name",label:"Bride's Name"},{value:"groom_name",label:"Groom's Name"},{value:"bride_first_name",label:"Bride's First Name"},{value:"groom_first_name",label:"Groom's First Name"},{value:"couple_names",label:"Couple Names"},{value:"event_date",label:"Event Date (Day)"},{value:"event_date_full",label:"Event Date (Full)"},{value:"event_month",label:"Event Month"},{value:"event_year",label:"Event Year"},{value:"event_day",label:"Event Day"},{value:"event_time",label:"Event Time"},{value:"venue",label:"Venue"},{value:"venue_address",label:"Venue Address"},{value:"city",label:"City"},{value:"welcome_message",label:"Welcome Message"},{value:"description",label:"Description"},{value:"countdown_days",label:"Countdown Days"},{value:"custom_text_1",label:"Custom Text 1"},{value:"custom_text_2",label:"Custom Text 2"},{value:"custom_text_3",label:"Custom Text 3"},{value:"custom_text_4",label:"Custom Text 4"},{value:"custom_text_5",label:"Custom Text 5"}],b=[{value:"fade-in",label:"Fade In"},{value:"fade-out",label:"Fade Out"},{value:"slide-up",label:"Slide Up"},{value:"slide-down",label:"Slide Down"},{value:"slide-left",label:"Slide Left"},{value:"slide-right",label:"Slide Right"},{value:"scale-up",label:"Scale Up"},{value:"scale-down",label:"Scale Down"},{value:"zoom-in",label:"Zoom In"},{value:"bounce-in",label:"Bounce In"},{value:"bounce-out",label:"Bounce Out"},{value:"rotate-in",label:"Rotate In"},{value:"spin",label:"Spin"},{value:"typewriter",label:"Typewriter"},{value:"blur-in",label:"Blur In"},{value:"blur-out",label:"Blur Out"},{value:"fade-slide-up",label:"Fade + Slide Up"},{value:"scale-fade",label:"Scale + Fade"}],j=["Playfair Display","Montserrat","Roboto","Open Sans","Lato","Arial","Helvetica","Times New Roman","Georgia","Courier New","Verdana","Trebuchet MS","Palatino","Garamond","Impact"],_=[{value:"normal",label:"Normal"},{value:"bold",label:"Bold"},{value:"100",label:"Thin"},{value:"300",label:"Light"},{value:"500",label:"Medium"},{value:"700",label:"Bold"},{value:"900",label:"Black"}],w=[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}],N=[{value:"ease-in-out",label:"Ease In-Out"},{value:"ease-in",label:"Ease In"},{value:"ease-out",label:"Ease Out"},{value:"linear",label:"Linear"},{value:"cubic-bezier(0.68, -0.55, 0.265, 1.55)",label:"Bounce"}];function k({overlay:e,duration:t,currentTime:a,onUpdate:l,onSeek:n}){let[r,m]=(0,s.useState)({endpoint_key:e?.endpoint_key??"couple_names",label:e?.label??"Couple Names",placeholder_text:e?.placeholder_text??"Sample Text",position:e?.position??{x:50,y:50,alignment:"center",anchor_point:"center",unit:"percent"},dimensions:e?.dimensions??{width:50,height:null,unit:"percent"},timing:e?.timing??{start_time:0,end_time:t||10},styling:{font_family:e?.styling?.font_family??"Playfair Display",font_size:e?.styling?.font_size??72,font_weight:e?.styling?.font_weight??"bold",color:e?.styling?.color??"#ffffff",text_align:e?.styling?.text_align??"center",letter_spacing:e?.styling?.letter_spacing??2,line_height:e?.styling?.line_height??1.2,text_shadow:e?.styling?.text_shadow??"0 2px 4px rgba(0,0,0,0.3)",stroke:e?.styling?.stroke??{enabled:!1,color:"#000000",width:2}},animation:{type:e?.animation?.type??"fade-in",duration:e?.animation?.duration??1,easing:e?.animation?.easing??"ease-in-out",entrance:e?.animation?.entrance??{type:"fade-in",duration:1,easing:"ease-in-out"},exit:e?.animation?.exit??{type:"fade-out",duration:1,easing:"ease-in-out"}},responsive:e?.responsive??{mobile_font_size:48,mobile_position:{x:50,y:30,unit:"percent"}}}),[k,C]=(0,s.useState)({}),T=(0,s.useRef)(!1),M=e?.template?.reference_resolution||{width:1920,height:1080},z=e=>(e/(M.height||1080)*100).toFixed(2),O=(e,t)=>t&&0!==t?(e/t).toFixed(3):0,P=(e,t)=>t&&0!==t?(e/t).toFixed(3):0,E=(e,t)=>{m(a=>{let i={...a},s=e.split("."),l=i;for(let e=0;e<s.length-1;e++)l[s[e]]?l[s[e]]={...l[s[e]]}:l[s[e]]={},l=l[s[e]];return l[s[s.length-1]]=t,i}),C(a=>{let i={...a},s=e.split("."),l=i;for(let e=0;e<s.length-1;e++)l[s[e]]||(l[s[e]]={}),l=l[s[e]];return l[s[s.length-1]]=t,i}),D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{A()},100)},D=(0,s.useRef)(null),A=async()=>{if(0===Object.keys(k).length)return;T.current=!0;let e={};void 0!==k.endpoint_key&&(e.endpoint_key=r.endpoint_key),void 0!==k.label&&(e.label=r.label),void 0!==k.placeholder_text&&(e.placeholder_text=r.placeholder_text),k.position&&(e.position=r.position),k.dimensions&&(e.dimensions=r.dimensions),k.timing&&(e.timing=r.timing),k.responsive&&(e.responsive=r.responsive),void 0!==k.layer_index&&(e.layer_index=r.layer_index),k.styling&&(e.styling={font_family:r.styling.font_family,font_size:r.styling.font_size,font_weight:r.styling.font_weight,color:r.styling.color,text_align:r.styling.text_align,letter_spacing:r.styling.letter_spacing,line_height:r.styling.line_height,text_shadow:r.styling.text_shadow,stroke:{enabled:r.styling.stroke.enabled,color:r.styling.stroke.color,width:r.styling.stroke.width}}),k.animation&&(e.animation={type:r.animation.type,duration:r.animation.duration,easing:r.animation.easing,entrance:{type:r.animation.entrance.type,duration:r.animation.entrance.duration,easing:r.animation.entrance.easing},exit:{type:r.animation.exit.type,duration:r.animation.exit.duration,easing:r.animation.exit.easing}}),console.log("Saving overlay update with changes:",e);try{await l(e),C({})}finally{setTimeout(()=>{T.current=!1},100)}};return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("h3",{className:"font-semibold flex items-center gap-2",children:[i.jsx(y.Z,{className:"w-4 h-4 text-blue-500"}),"Configure Overlay"]}),i.jsx(o.z,{size:"sm",onClick:A,"data-testid":"save-overlay-btn",children:i.jsx(v.Z,{className:"w-4 h-4"})})]}),(0,i.jsxs)("div",{className:"p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:[i.jsx("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:"\uD83D\uDCA1 Interactive Controls"}),(0,i.jsxs)("ul",{className:"text-xs text-blue-800 space-y-1",children:[(0,i.jsxs)("li",{children:["• ",i.jsx("strong",{children:"Drag"})," the overlay on the video to reposition"]}),(0,i.jsxs)("li",{children:["• ",i.jsx("strong",{children:"Resize"})," using the corner/edge handles"]}),(0,i.jsxs)("li",{children:["• Hold ",i.jsx("strong",{children:"Shift"})," while resizing for proportional scaling"]})]})]}),i.jsx(u.x,{className:"h-[calc(100vh-280px)]",children:(0,i.jsxs)(c.mQ,{defaultValue:"content",className:"w-full",children:[(0,i.jsxs)(c.dr,{className:"grid w-full grid-cols-4",children:[i.jsx(c.SP,{value:"content",children:"Content"}),i.jsx(c.SP,{value:"style",children:"Style"}),i.jsx(c.SP,{value:"timing",children:"Timing"}),i.jsx(c.SP,{value:"animation",children:"Animation"})]}),(0,i.jsxs)(c.nU,{value:"content",className:"space-y-4 mt-4",children:[(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Data Source"}),(0,i.jsxs)(d.Ph,{value:r.endpoint_key,onValueChange:e=>{E("endpoint_key",e);let t=f.find(t=>t.value===e);t&&E("label",t.label)},children:[i.jsx(d.i4,{className:"mt-1","data-testid":"endpoint-select",children:i.jsx(d.ki,{})}),i.jsx(d.Bw,{children:f.map(e=>i.jsx(d.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Preview Text"}),i.jsx(h.I,{value:r.placeholder_text,onChange:e=>E("placeholder_text",e.target.value),placeholder:"Sample text for preview",className:"mt-1","data-testid":"placeholder-text-input"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This text will be shown in preview. Real wedding data will populate automatically."})]}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Position (Drag on video or use inputs)"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[(0,i.jsxs)("div",{children:[i.jsx(x._,{className:"text-xs",children:"X (%)"}),i.jsx(h.I,{type:"number",min:"0",max:"100",step:"0.1",value:r.position.x,onChange:e=>E("position.x",parseFloat(e.target.value)||0),className:"mt-1","data-testid":"position-x-input"})]}),(0,i.jsxs)("div",{children:[i.jsx(x._,{className:"text-xs",children:"Y (%)"}),i.jsx(h.I,{type:"number",min:"0",max:"100",step:"0.1",value:r.position.y,onChange:e=>E("position.y",parseFloat(e.target.value)||0),className:"mt-1","data-testid":"position-y-input"})]})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Percentage-based positioning (0-100%). Center: (50%, 50%)"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["Text Box Width: ",r.dimensions?.width||"Auto","%"]}),i.jsx(p.i,{value:[r.dimensions?.width||50],onValueChange:([e])=>E("dimensions.width",e),min:10,max:100,step:1,className:"mt-2","data-testid":"textbox-width-slider"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Controls text wrapping width. Text will automatically wrap to new lines when it exceeds this width."})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["Text Box Height: ",r.dimensions?.height?`${r.dimensions.height}%`:"Auto"]}),i.jsx(p.i,{value:[r.dimensions?.height||20],onValueChange:([e])=>E("dimensions.height",e),min:5,max:100,step:1,className:"mt-2","data-testid":"textbox-height-slider"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Controls text box height. Set to control vertical space for text. Text will wrap within this box."})]})]}),(0,i.jsxs)(c.nU,{value:"style",className:"space-y-4 mt-4",children:[(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Font Family"}),(0,i.jsxs)(d.Ph,{value:r.styling.font_family,onValueChange:e=>E("styling.font_family",e),children:[i.jsx(d.i4,{className:"mt-1","data-testid":"font-family-select",children:i.jsx(d.ki,{})}),i.jsx(d.Bw,{children:j.map(e=>i.jsx(d.Ql,{value:e,children:i.jsx("span",{style:{fontFamily:e},children:e})},e))})]}),(0,i.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Preview:"}),i.jsx("p",{className:"text-2xl font-medium",style:{fontFamily:r.styling.font_family},children:e?.placeholder_text||r.placeholder_text||"Sample Text"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["Font Size: ",r.styling.font_size,"px (",z(r.styling.font_size),"% of video height)"]}),i.jsx(p.i,{value:[r.styling.font_size],onValueChange:([e])=>E("styling.font_size",e),min:12,max:200,step:1,className:"mt-2","data-testid":"font-size-slider"}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Font will automatically scale on all devices. ",z(r.styling.font_size),"% = ",r.styling.font_size,"px on ",M.height,"px video"]})]}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Font Weight"}),(0,i.jsxs)(d.Ph,{value:r.styling.font_weight,onValueChange:e=>E("styling.font_weight",e),children:[i.jsx(d.i4,{className:"mt-1",children:i.jsx(d.ki,{})}),i.jsx(d.Bw,{children:_.map(e=>i.jsx(d.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Text Color"}),(0,i.jsxs)("div",{className:"flex gap-2 mt-1",children:[i.jsx(h.I,{type:"color",value:r.styling.color,onChange:e=>{E("styling.color",e.target.value),setTimeout(()=>A(),10)},onInput:e=>{E("styling.color",e.target.value)},className:"w-20 h-10 p-1","data-testid":"text-color-input"}),i.jsx(h.I,{type:"text",value:r.styling.color,onChange:e=>{E("styling.color",e.target.value)},onBlur:()=>{A()},placeholder:"#ffffff",className:"flex-1"})]})]}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Text Alignment"}),(0,i.jsxs)(d.Ph,{value:r.styling.text_align,onValueChange:e=>E("styling.text_align",e),children:[i.jsx(d.i4,{className:"mt-1",children:i.jsx(d.ki,{})}),i.jsx(d.Bw,{children:w.map(e=>i.jsx(d.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["Letter Spacing: ",r.styling.letter_spacing,"px (",O(r.styling.letter_spacing,r.styling.font_size),"em)"]}),i.jsx(p.i,{value:[r.styling.letter_spacing],onValueChange:([e])=>E("styling.letter_spacing",e),min:0,max:20,step:1,className:"mt-2"}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Responsive unit: ",O(r.styling.letter_spacing,r.styling.font_size),"em scales automatically with font size"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["Line Height: ",r.styling.line_height]}),i.jsx(p.i,{value:[r.styling.line_height],onValueChange:([e])=>E("styling.line_height",e),min:.8,max:3,step:.1,className:"mt-2"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Already using responsive ratio (1.0 = normal, 1.5 = 1.5x spacing). Scales automatically with all screen sizes."})]}),(0,i.jsxs)("div",{className:"border-t pt-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[i.jsx(x._,{children:"Text Stroke/Outline"}),i.jsx(g.r,{checked:r.styling.stroke.enabled,onCheckedChange:e=>E("styling.stroke.enabled",e),"data-testid":"stroke-enabled-switch"})]}),r.styling.stroke.enabled&&(0,i.jsxs)("div",{className:"space-y-3 pl-4 border-l-2 border-blue-200",children:[(0,i.jsxs)("div",{children:[i.jsx(x._,{className:"text-xs",children:"Stroke Color"}),(0,i.jsxs)("div",{className:"flex gap-2 mt-1",children:[i.jsx(h.I,{type:"color",value:r.styling.stroke.color,onChange:e=>E("styling.stroke.color",e.target.value),className:"w-16 h-8 p-1"}),i.jsx(h.I,{type:"text",value:r.styling.stroke.color,onChange:e=>E("styling.stroke.color",e.target.value),className:"flex-1"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{className:"text-xs",children:["Stroke Width: ",r.styling.stroke.width,"px (",P(r.styling.stroke.width,r.styling.font_size),"em)"]}),i.jsx(p.i,{value:[r.styling.stroke.width],onValueChange:([e])=>E("styling.stroke.width",e),min:1,max:10,step:1,className:"mt-2"}),(0,i.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[P(r.styling.stroke.width,r.styling.font_size),"em scales proportionally with font size"]})]})]})]})]}),(0,i.jsxs)(c.nU,{value:"timing",className:"space-y-4 mt-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["Start Time: ",S(r.timing.start_time)]}),i.jsx(p.i,{value:[r.timing.start_time],onValueChange:([e])=>E("timing.start_time",e),max:t||100,step:.1,className:"mt-2","data-testid":"start-time-slider"}),(0,i.jsxs)(o.z,{size:"sm",variant:"outline",onClick:()=>{E("timing.start_time",a),n(a)},className:"mt-2 w-full",children:["Set to Current Time (",S(a),")"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["End Time: ",S(r.timing.end_time)]}),i.jsx(p.i,{value:[r.timing.end_time],onValueChange:([e])=>E("timing.end_time",e),max:t||100,step:.1,className:"mt-2","data-testid":"end-time-slider"}),(0,i.jsxs)(o.z,{size:"sm",variant:"outline",onClick:()=>{E("timing.end_time",a),n(a)},className:"mt-2 w-full",children:["Set to Current Time (",S(a),")"]})]}),i.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:(0,i.jsxs)("p",{className:"text-xs text-blue-900",children:[i.jsx("strong",{children:"Duration:"})," ",S(r.timing.end_time-r.timing.start_time)]})})]}),(0,i.jsxs)(c.nU,{value:"animation",className:"space-y-4 mt-4",children:[(0,i.jsxs)("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-sm",children:"Entrance Animation"}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Animation Type"}),(0,i.jsxs)(d.Ph,{value:r.animation.entrance.type,onValueChange:e=>E("animation.entrance.type",e),children:[i.jsx(d.i4,{className:"mt-1","data-testid":"entrance-animation-select",children:i.jsx(d.ki,{})}),i.jsx(d.Bw,{children:b.map(e=>i.jsx(d.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["Duration: ",r.animation.entrance.duration,"s"]}),i.jsx(p.i,{value:[r.animation.entrance.duration],onValueChange:([e])=>E("animation.entrance.duration",e),min:.1,max:5,step:.1,className:"mt-2"})]}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Easing"}),(0,i.jsxs)(d.Ph,{value:r.animation.entrance.easing,onValueChange:e=>E("animation.entrance.easing",e),children:[i.jsx(d.i4,{className:"mt-1",children:i.jsx(d.ki,{})}),i.jsx(d.Bw,{children:N.map(e=>i.jsx(d.Ql,{value:e.value,children:e.label},e.value))})]})]})]}),(0,i.jsxs)("div",{className:"border-t pt-4 space-y-4",children:[i.jsx("h4",{className:"font-medium text-sm",children:"Exit Animation"}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Animation Type"}),(0,i.jsxs)(d.Ph,{value:r.animation.exit.type,onValueChange:e=>E("animation.exit.type",e),children:[i.jsx(d.i4,{className:"mt-1","data-testid":"exit-animation-select",children:i.jsx(d.ki,{})}),i.jsx(d.Bw,{children:b.map(e=>i.jsx(d.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(x._,{children:["Duration: ",r.animation.exit.duration,"s"]}),i.jsx(p.i,{value:[r.animation.exit.duration],onValueChange:([e])=>E("animation.exit.duration",e),min:.1,max:5,step:.1,className:"mt-2"})]}),(0,i.jsxs)("div",{children:[i.jsx(x._,{children:"Easing"}),(0,i.jsxs)(d.Ph,{value:r.animation.exit.easing,onValueChange:e=>E("animation.exit.easing",e),children:[i.jsx(d.i4,{className:"mt-1",children:i.jsx(d.ki,{})}),i.jsx(d.Bw,{children:N.map(e=>i.jsx(d.Ql,{value:e.value,children:e.label},e.value))})]})]})]}),i.jsx("div",{className:"p-3 bg-purple-50 rounded-lg border border-purple-200",children:(0,i.jsxs)("p",{className:"text-xs text-purple-900",children:[i.jsx("strong",{children:"Tip:"})," Entrance plays when text appears, exit when it disappears"]})})]})]})})]})}function S(e){return!e||isNaN(e)?"0:00":`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}var C=a(62881);let T=(0,C.Z)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var M=a(98091);let z=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#14b8a6","#f97316","#6366f1","#84cc16"];function O({overlays:e,duration:t,currentTime:a,selectedOverlay:l,onSelectOverlay:n,onUpdateOverlay:r,onDeleteOverlay:d,onReorder:c,onSeek:u}){let x=(0,s.useRef)(null),[h,p]=(0,s.useState)(!1),[g,y]=(0,s.useState)(null),[v,f]=(0,s.useState)(null),b=(e,t)=>{t.stopPropagation(),n(e)},j=(e,t,a)=>{a.stopPropagation(),p(!0),y(e),f(t)},_=e=>z[e%z.length],w=e=>!e||isNaN(e)?"0:00":`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{ref:x,className:"relative bg-gray-100 rounded-lg p-4 min-h-[300px] cursor-pointer",onClick:e=>{if(h)return;let a=e.currentTarget.getBoundingClientRect();u((e.clientX-a.left)/a.width*t)},"data-testid":"timeline-canvas",children:[i.jsx("div",{className:"absolute top-0 left-0 right-0 flex justify-between text-xs text-gray-500 px-4 py-2",children:Array.from({length:11},(e,a)=>i.jsx("span",{children:w(t/10*a)},a))}),i.jsx("div",{className:"absolute top-8 bottom-0 w-0.5 bg-red-500 z-20",style:{left:`${a/t*100}%`},children:i.jsx("div",{className:"absolute -top-2 -left-2 w-4 h-4 bg-red-500 rounded-full"})}),i.jsx("div",{className:"mt-12 space-y-3",children:0===e.length?i.jsx("div",{className:"text-center py-12 text-gray-500",children:'No overlays yet. Click "Add Overlay" to get started.'}):e.map((e,a)=>{let s=(e.timing?.start_time||0)/t*100,n=(e.timing?.end_time||t)/t*100,r=_(a),c=l?.id===e.id;return(0,i.jsxs)("div",{className:"relative h-12","data-testid":`timeline-overlay-${a}`,children:[i.jsx("div",{className:"absolute inset-0 bg-gray-200 rounded"}),(0,i.jsxs)("div",{className:`absolute h-full rounded cursor-move transition-all ${c?"ring-2 ring-offset-2 ring-blue-500":""}`,style:{left:`${s}%`,width:`${n-s}%`,backgroundColor:r,opacity:c?1:.8},onClick:t=>b(e,t),onMouseDown:t=>j(e,"move",t),children:[i.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-2 bg-black bg-opacity-30 cursor-ew-resize hover:bg-opacity-50",onMouseDown:t=>j(e,"start",t),onClick:e=>e.stopPropagation()}),(0,i.jsxs)("div",{className:"px-3 py-2 flex items-center justify-between h-full",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 text-white text-sm font-medium truncate",children:[i.jsx(T,{className:"w-3 h-3 flex-shrink-0"}),i.jsx("span",{className:"truncate",children:e.label||e.endpoint_key})]}),i.jsx(o.z,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-white hover:bg-white hover:bg-opacity-20",onClick:t=>{t.stopPropagation(),d(e.id)},children:i.jsx(M.Z,{className:"w-3 h-3"})})]}),i.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-2 bg-black bg-opacity-30 cursor-ew-resize hover:bg-opacity-50",onMouseDown:t=>j(e,"end",t),onClick:e=>e.stopPropagation()})]}),i.jsx("div",{className:"absolute -bottom-5 left-0 text-xs text-gray-500",children:w(e.timing?.start_time||0)}),i.jsx("div",{className:"absolute -bottom-5 right-0 text-xs text-gray-500",children:w(e.timing?.end_time||0)})]},e.id||a)})})]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:e.map((e,t)=>i.jsx(m.C,{className:"cursor-pointer",style:{backgroundColor:_(t)},onClick:()=>n(e),"data-testid":`overlay-badge-${t}`,children:e.label||e.endpoint_key},e.id||t))}),(0,i.jsxs)("div",{className:"text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded p-3",children:[i.jsx("p",{className:"font-medium mb-1",children:"Timeline Controls:"}),(0,i.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[i.jsx("li",{children:"Click on timeline to seek to that position"}),i.jsx("li",{children:"Drag overlay bars to move them"}),i.jsx("li",{children:"Drag edges to adjust start/end times"}),i.jsx("li",{children:"Click overlay to select and edit details"})]})]})]})}function P({overlays:e=[],currentTime:t,duration:a,selectedOverlay:l,showOverlays:n=!0,onSelectOverlay:r,onUpdateOverlay:o,containerRef:d,videoResolution:c=null}){let u=c?.width||1920,m=c?.height||1080,x=(0,s.useRef)(null),[h,p]=(0,s.useState)(!1),[g,y]=(0,s.useState)(!1),[v,f]=(0,s.useState)(null),[b,j]=(0,s.useState)({x:0,y:0}),[_,w]=(0,s.useState)({x:0,y:0}),[N,k]=(0,s.useState)(null),[S,C]=(0,s.useState)({}),[T,M]=(0,s.useState)(!1),[z,O]=(0,s.useState)([]),[P,E]=(0,s.useState)(-1),[D,A]=(0,s.useState)(!1),F=(0,s.useCallback)(e=>({x:(void 0!==e.x?e.x:50)/100*u,y:(void 0!==e.y?e.y:50)/100*m}),[u,m]),I=(0,s.useCallback)(e=>({x:Math.round(e.x/u*1e4)/100,y:Math.round(e.y/m*1e4)/100,unit:"percent"}),[u,m]),$=(0,s.useCallback)((e,t,a,i)=>[{x:e,y:t,cursor:"nw-resize",position:"nw"},{x:e+a/2,y:t,cursor:"n-resize",position:"n"},{x:e+a,y:t,cursor:"ne-resize",position:"ne"},{x:e+a,y:t+i/2,cursor:"e-resize",position:"e"},{x:e+a,y:t+i,cursor:"se-resize",position:"se"},{x:e+a/2,y:t+i,cursor:"s-resize",position:"s"},{x:e,y:t+i,cursor:"sw-resize",position:"sw"},{x:e,y:t+i/2,cursor:"w-resize",position:"w"}],[]);(0,s.useCallback)(()=>{P>0&&E(P-1)},[P]),(0,s.useCallback)(()=>{P<z.length-1&&E(P+1)},[P,z.length]),(0,s.useCallback)((e,t,a,i=0)=>{let s=t.split(" "),l=[],n="";for(let t=0;t<s.length;t++){let r=n?n+" "+s[t]:s[t],o=e.measureText(r).width;i>0&&(o+=i*(r.length-1)),o>a&&n?(l.push(n),n=s[t]):n=r}return n&&l.push(n),l.length>0?l:[t]},[]);let R=(0,s.useCallback)((e,t,a,i,s,l)=>{let n=t.split(""),r=a,o=n.reduce((t,a)=>t+e.measureText(a).width+s,-s);"center"===e.textAlign?r=a-o/2:"right"===e.textAlign&&(r=a-o),n.forEach(t=>{l?e.strokeText(t,r,i):e.fillText(t,r,i),r+=e.measureText(t).width+s})},[]),B=(0,s.useCallback)((e,t)=>{switch(t){case"linear":default:return e;case"ease-in":return e*e;case"ease-out":return e*(2-e);case"ease-in-out":return e<.5?2*e*e:-1+(4-2*e)*e;case"cubic-bezier(0.68, -0.55, 0.265, 1.55)":return(1-e)*(1-e)*(1-e)*0+-(3*(1-e)*(1-e)*e*.55)+3*(1-e)*e*e*1.55+e*e*e*1}},[]),U=(0,s.useCallback)((e,t,a)=>{let i={opacity:1,scale:1,rotation:0,translateX:0,translateY:0},s=1-t,l=a?t:s;switch(e){case"fade-in":case"fade-out":default:i.opacity=l;break;case"slide-up":i.opacity=l,i.translateY=a?-(100*s):100*t;break;case"slide-down":i.opacity=l,i.translateY=a?100*s:-(100*t);break;case"slide-left":i.opacity=l,i.translateX=a?-(100*s):100*t;break;case"slide-right":i.opacity=l,i.translateX=a?100*s:-(100*t);break;case"scale-up":i.opacity=l,i.scale=a?.5+.5*t:.5+.5*s;break;case"scale-down":i.opacity=l,i.scale=a?1.5-.5*t:1.5-.5*s;break;case"zoom-in":i.opacity=l,i.scale=a?t:s;break;case"bounce-in":case"bounce-out":i.opacity=l;let n=a?t:s;i.scale=1+.1*Math.sin(n*Math.PI*3)*(1-n);break;case"rotate-in":i.opacity=l,i.rotation=a?2*Math.PI*s:2*Math.PI*t,i.scale=l;break;case"spin":i.opacity=l,i.rotation=a?4*Math.PI*s:4*Math.PI*t;break;case"blur-in":case"blur-out":i.opacity=l,i.scale=1-.05*s;break;case"fade-slide-up":i.opacity=l,i.translateY=a?-(50*s):50*t;break;case"scale-fade":i.opacity=l,i.scale=a?.8+.2*t:.8+.2*s;break;case"typewriter":i.opacity=1}return i},[]),V=(0,s.useCallback)((e,t)=>{let i=e.timing?.start_time||0,s=e.timing?.end_time||a,l=e.animation?.entrance||{type:"fade-in",duration:1,easing:"ease-in-out"},n=e.animation?.exit||{type:"fade-out",duration:1,easing:"ease-in-out"},r={opacity:1,scale:1,rotation:0,translateX:0,translateY:0};if(t<i+l.duration){let e=B(Math.min(1,(t-i)/l.duration),l.easing);r=U(l.type,e,!0)}else if(t>s-n.duration){let e=B(Math.min(1,(t-(s-n.duration))/n.duration),n.easing);r=U(n.type,e,!1)}return r},[a,B,U]),Q=(0,s.useCallback)((e,a)=>{let i=a.placeholder_text||a.endpoint_key||"Sample Text",s=a.position||{x:50,y:50,unit:"percent"},l=a.styling||{},n=S[a.id],r=F(s),o=l.font_size||48,d=l.font_weight||"normal",c=l.font_family||"Arial",u=l.letter_spacing||0,m=l.line_height||1.2,x=l.text_align||"center",h=c.includes(" ")?`"${c}"`:c;e.font=`${d} ${o}px ${h}`,e.fillStyle=l.color||"#ffffff",e.textAlign=x,e.textBaseline="middle";let p=V(a,t),g=n?.lines||[i],y=n?.height||o*m,v=o*m;e.save(),e.translate(r.x,r.y),e.globalAlpha=p.opacity,e.scale(p.scale,p.scale),e.rotate(p.rotation),e.translate(p.translateX,p.translateY);let f=-(y/2)+v/2;g.forEach((t,a)=>{let i=f+a*v;l.stroke?.enabled&&(e.strokeStyle=l.stroke.color||"#000000",e.lineWidth=l.stroke.width||2,u>0?R(e,t,0,i,u,!0):e.strokeText(t,0,i)),l.text_shadow&&(e.shadowColor="rgba(0,0,0,0.5)",e.shadowBlur=4,e.shadowOffsetX=0,e.shadowOffsetY=2),u>0?R(e,t,0,i,u,!1):e.fillText(t,0,i)}),e.restore()},[t,V,R,F,S]),L=(0,s.useCallback)((e,t)=>{let a=S[t.id];if(!a)return;let i=t.position||{x:50,y:50,unit:"percent"},s=F(i),l=s.x-a.width/2-10,n=s.y-a.height/2-10,r=a.width+20,o=a.height+20;e.fillStyle="rgba(59, 130, 246, 0.1)",e.fillRect(l,n,r,o),e.strokeStyle="#3b82f6",e.lineWidth=2,e.setLineDash([5,5]),e.strokeRect(l,n,r,o),e.setLineDash([]),$(l,n,r,o).forEach(t=>{e.fillStyle="#ffffff",e.fillRect(t.x-6,t.y-6,12,12),e.strokeStyle="#3b82f6",e.lineWidth=2,e.strokeRect(t.x-6,t.y-6,12,12)});let d=t.dimensions||{},c=d.width?d.width.toFixed(1):"auto";e.fillStyle="rgba(59, 130, 246, 0.9)",e.fillRect(l,n-25,180,20),e.fillStyle="#ffffff",e.font="12px Arial",e.textAlign="left",e.textBaseline="top",e.fillText(`(${i.x?.toFixed(1)}%, ${i.y?.toFixed(1)}%) W:${c}%`,l+5,n-23)},[S,$,F]),Z=(0,s.useCallback)((e,t)=>{let a=S[t.id];if(!a)return;let i=F(t.position||{x:50,y:50,unit:"percent"}),s=i.x-a.width/2-10,l=i.y-a.height/2-10,n=a.width+20,r=a.height+20;e.strokeStyle="#60a5fa",e.lineWidth=1,e.setLineDash([3,3]),e.strokeRect(s,l,n,r),e.setLineDash([])},[S,F]);(0,s.useCallback)(()=>{let i=x.current;if(!i)return;let s=i.getContext("2d");s.clearRect(0,0,i.width,i.height);let n=e.filter(e=>{let i=e.timing?.start_time||0,s=e.timing?.end_time||a;return t>=i-.016&&t<=s+.016});n.sort((e,t)=>(e.layer_index||0)-(t.layer_index||0)),n.forEach(e=>{Q(s,e)}),l&&S[l.id]&&L(s,l),N&&N.id!==l?.id&&S[N.id]&&Z(s,N)},[t,e,a,l,N,S,Q,L,Z]);let q=e=>{let t=x.current;if(!t)return{x:0,y:0};let a=t.getBoundingClientRect(),i=u/a.width,s=m/a.height;return{x:(e.clientX-a.left)*i,y:(e.clientY-a.top)*s}},W=(i,s)=>{for(let l of e.filter(e=>{let i=e.timing?.start_time||0,s=e.timing?.end_time||a;return t>=i-.016&&t<=s+.016}).sort((e,t)=>(t.layer_index||0)-(e.layer_index||0))){let e=S[l.id];if(!e)continue;let t=F(l.position||{x:50,y:50,unit:"percent"}),a=t.x-e.width/2-10,n=t.y-e.height/2-10,r=e.width+20,o=e.height+20;if(i>=a&&i<=a+r&&s>=n&&s<=n+o)return l}return null},Y=(e,t,a)=>{let i=S[a.id];if(!i)return null;let s=F(a.position||{x:50,y:50,unit:"percent"}),l=s.x-i.width/2-10;for(let a of $(l,s.y-i.height/2-10,i.width+20,i.height+20))if(12>=Math.sqrt(Math.pow(e-a.x,2)+Math.pow(t-a.y,2)))return a;return null},G=()=>{p(!1),y(!1),f(null)};return i.jsx("canvas",{ref:x,width:u,height:m,className:"absolute top-0 left-0 w-full h-full cursor-default",style:{display:n?"block":"none"},onMouseDown:e=>{let t=q(e);if(l){let e=Y(t.x,t.y,l);if(e){let a=F(l.position),i=S[l.id],s=l.dimensions||{};y(!0),f(e),j(t),w({x:a.x,y:a.y,fontSize:l.styling?.font_size||48,width:i?.width||200,height:i?.height||100,widthPercent:s.width||(i?.width||200)/u*100,heightPercent:s.height||(i?.height||100)/m*100,percentX:l.position.x,percentY:l.position.y});return}}let a=W(t.x,t.y);if(a){r(a);let e=F(a.position);p(!0),j(t),w({x:e.x,y:e.y,percentX:a.position.x,percentY:a.position.y})}else r(null)},onMouseMove:e=>{let t=q(e),a=x.current;if(!a)return;if(g&&l&&v){let e=t.x-b.x,i=t.y-b.y;if(!S[l.id])return;let s=v.position,n=_.width,r=_.height;if(T){let t=(e+i)/2;n=Math.max(50,_.width+t),r=Math.max(20,_.height+t)}else s.includes("e")?n=Math.max(50,_.width+e):s.includes("w")&&(n=Math.max(50,_.width-e)),s.includes("s")?r=Math.max(20,_.height+i):s.includes("n")&&(r=Math.max(20,_.height-i));let d=n/u*100,c=r/m*100;o(l.id,{dimensions:{width:Math.round(100*d)/100,height:Math.round(100*c)/100,unit:"percent"}}),a.style.cursor=v.cursor;return}if(h&&l){let e=t.x-b.x,i=t.y-b.y,s=I({x:Math.max(0,Math.min(u,_.x+e)),y:Math.max(0,Math.min(m,_.y+i))});o(l.id,{position:{...l.position,...s}}),a.style.cursor="move";return}if(l){let e=Y(t.x,t.y,l);if(e){a.style.cursor=e.cursor;return}}let i=W(t.x,t.y);k(i),a.style.cursor=i?"move":"default"},onMouseUp:G,onMouseLeave:G,"data-testid":"interactive-overlay-canvas"})}var E=a(9015);let D=(0,C.Z)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);var A=a(43810);let F=(0,C.Z)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);var I=a(12714),$=a(91216),R=a(71059),B=a(94893),U=a(83855),V=a(78364),Q=a(61358);!function(){var e=Error("Cannot find module 'react-player'");throw e.code="MODULE_NOT_FOUND",e}();let L=(0,Q.bR)();function Z({template:e,onSave:t}){let{toast:a}=(0,V.pm)(),l=(0,s.useRef)(null);(0,s.useRef)(null);let c=(0,s.useRef)(null),[x,h]=(0,s.useState)(!1),[p,g]=(0,s.useState)(0),[y,f]=(0,s.useState)(0),[b,j]=(0,s.useState)(e?.text_overlays||[]),[_,w]=(0,s.useState)(null),[N,S]=(0,s.useState)(!0),[C,T]=(0,s.useState)(!1),[z,Q]=(0,s.useState)("timeline"),[Z,W]=(0,s.useState)(new Set),[Y,G]=(0,s.useState)(!1),[X,H]=(0,s.useState)("couple_names"),[J,K]=(0,s.useState)(e?.video_data?.aspect_ratio||"16:9"),ee=async()=>{let t={bride_name:{label:"Bride's Name",placeholder:"Sarah"},groom_name:{label:"Groom's Name",placeholder:"Michael"},bride_first_name:{label:"Bride's First Name",placeholder:"Sarah"},groom_first_name:{label:"Groom's First Name",placeholder:"Michael"},couple_names:{label:"Couple Names",placeholder:"John & Jane"},event_date:{label:"Event Date (Day)",placeholder:"15"},event_date_full:{label:"Event Date (Full)",placeholder:"June 15, 2025"},event_month:{label:"Event Month",placeholder:"June"},event_year:{label:"Event Year",placeholder:"2025"},event_day:{label:"Event Day",placeholder:"Monday"},event_time:{label:"Event Time",placeholder:"3:00 PM"},venue:{label:"Venue",placeholder:"Grand Hotel"},venue_address:{label:"Venue Address",placeholder:"123 Main St"},city:{label:"City",placeholder:"New York"},welcome_message:{label:"Welcome Message",placeholder:"Welcome to Our Wedding"},description:{label:"Description",placeholder:"Join us for our special day"},countdown_days:{label:"Countdown Days",placeholder:"30 Days"},custom_text_1:{label:"Custom Text 1",placeholder:"Custom Text"},custom_text_2:{label:"Custom Text 2",placeholder:"Custom Text"},custom_text_3:{label:"Custom Text 3",placeholder:"Custom Text"},custom_text_4:{label:"Custom Text 4",placeholder:"Custom Text"},custom_text_5:{label:"Custom Text 5",placeholder:"Custom Text"}},i=t[X]||t.couple_names,s={endpoint_key:X,label:i.label,placeholder_text:i.placeholder,position:{x:50,y:50,alignment:"center",anchor_point:"center",unit:"percent"},dimensions:{width:50,height:null,unit:"percent"},timing:{start_time:0,end_time:y||10},styling:{font_family:"Playfair Display",font_size:72,font_weight:"bold",color:"#ffffff",text_align:"center",letter_spacing:2,line_height:1.2,text_shadow:"0 2px 4px rgba(0,0,0,0.3)",stroke:{enabled:!1,color:"#000000",width:2}},animation:{type:"fade-in",duration:1,easing:"ease-in-out",entrance:{type:"fade-in",duration:1,easing:"ease-in-out"},exit:{type:"fade-out",duration:1,easing:"ease-in-out"}},responsive:{mobile_font_size:48,mobile_position:{x:50,y:30,unit:"percent"}},layer_index:b.length};try{let t=localStorage.getItem("token"),l=await n.Z.post(`${L}/api/admin/video-templates/${e.id}/overlays`,s,{headers:{Authorization:`Bearer ${t}`}});j(l.data.text_overlays),a({title:"Success",description:`${i.label} overlay added successfully`})}catch(e){console.error("Failed to add overlay:",e),a({title:"Error",description:e.response?.data?.detail||"Failed to add overlay",variant:"destructive"})}},et=async(t,i)=>{if(Z.has(t)){a({title:"Overlay Locked",description:"Unlock the overlay to make changes",variant:"destructive"});return}try{console.log("Updating overlay:",t,"with updates:",i),j(e=>e.map(e=>{if(e.id===t){let t={...e};return i.styling&&(t.styling={...e.styling,...i.styling,stroke:i.styling.stroke?{...e.styling?.stroke,...i.styling.stroke}:e.styling?.stroke}),i.animation&&(t.animation={...e.animation,...i.animation,entrance:i.animation.entrance?{...e.animation?.entrance,...i.animation.entrance}:e.animation?.entrance,exit:i.animation.exit?{...e.animation?.exit,...i.animation.exit}:e.animation?.exit}),i.position&&(t.position={...e.position,...i.position}),i.dimensions&&(t.dimensions={...e.dimensions,...i.dimensions}),i.timing&&(t.timing={...e.timing,...i.timing}),Object.keys(i).forEach(e=>{["styling","animation","position","dimensions","timing"].includes(e)||(t[e]=i[e])}),t}return e})),_?.id===t&&w(e=>{let t={...e};return i.styling&&(t.styling={...e.styling,...i.styling,stroke:i.styling.stroke?{...e.styling?.stroke,...i.styling.stroke}:e.styling?.stroke}),i.animation&&(t.animation={...e.animation,...i.animation,entrance:i.animation.entrance?{...e.animation?.entrance,...i.animation.entrance}:e.animation?.entrance,exit:i.animation.exit?{...e.animation?.exit,...i.animation.exit}:e.animation?.exit}),i.position&&(t.position={...e.position,...i.position}),i.dimensions&&(t.dimensions={...e.dimensions,...i.dimensions}),i.timing&&(t.timing={...e.timing,...i.timing}),Object.keys(i).forEach(e=>{["styling","animation","position","dimensions","timing"].includes(e)||(t[e]=i[e])}),t});let s=localStorage.getItem("token"),l=await n.Z.put(`${L}/api/admin/video-templates/${e.id}/overlays/${t}`,i,{headers:{Authorization:`Bearer ${s}`}});console.log("Update response:",l.data),console.log("Returned overlays:",l.data.text_overlays);let r=l.data.text_overlays;if(j(r),_?.id===t){let e=r.find(e=>e.id===t);e&&(console.log("Updated overlay data from server:",JSON.stringify(e.styling,null,2)),console.log("Updated overlay animation from server:",JSON.stringify(e.animation,null,2)),w(e))}(!i.position||Object.keys(i).length>1)&&a({title:"Success",description:"Overlay updated successfully"})}catch(i){if(console.error("Failed to update overlay:",i),console.error("Error details:",i.response?.data),j(e?.text_overlays||[]),_?.id===t){let a=e?.text_overlays?.find(e=>e.id===t);a&&w(a)}throw a({title:"Error",description:i.response?.data?.detail||"Failed to update overlay",variant:"destructive"}),i}},ea=async t=>{if(confirm("Are you sure you want to delete this overlay?"))try{let i=localStorage.getItem("token"),s=await n.Z.delete(`${L}/api/admin/video-templates/${e.id}/overlays/${t}`,{headers:{Authorization:`Bearer ${i}`}});j(s.data.text_overlays),w(null),a({title:"Success",description:"Overlay deleted"})}catch(e){console.error("Failed to delete overlay:",e),a({title:"Error",description:"Failed to delete overlay",variant:"destructive"})}},ei=async t=>{try{let a=localStorage.getItem("token");await n.Z.put(`${L}/api/admin/video-templates/${e.id}/overlays/reorder`,t,{headers:{Authorization:`Bearer ${a}`}});let i=t.map(e=>b.find(t=>t.id===e)).filter(Boolean);j(i)}catch(e){console.error("Failed to reorder overlays:",e)}},es=async()=>{T(!0);try{t&&await t(),a({title:"Success",description:"Template saved successfully"})}catch(e){a({title:"Error",description:"Failed to save template",variant:"destructive"})}finally{T(!1)}},el=async()=>{if(!_)return;let t={..._,position:{..._.position,x:_.position.x+50,y:_.position.y+50},label:`${_.label} (Copy)`,layer_index:b.length};delete t.id;try{let i=localStorage.getItem("token"),s=await n.Z.post(`${L}/api/admin/video-templates/${e.id}/overlays`,t,{headers:{Authorization:`Bearer ${i}`}});j(s.data.text_overlays),a({title:"Success",description:"Overlay duplicated successfully"})}catch(e){console.error("Failed to duplicate overlay:",e),a({title:"Error",description:"Failed to duplicate overlay",variant:"destructive"})}},en=async t=>{if(confirm(`Changing aspect ratio from ${J} to ${t} may affect overlay positioning. Continue?`))try{let i=localStorage.getItem("token");await n.Z.put(`${L}/api/admin/video-templates/${e.id}/aspect-ratio`,{aspect_ratio:t},{headers:{Authorization:`Bearer ${i}`}}),K(t),a({title:"Success",description:`Aspect ratio changed to ${t}. Please review overlay positions.`}),window.location.reload()}catch(e){console.error("Failed to change aspect ratio:",e),a({title:"Error",description:e.response?.data?.detail||"Failed to change aspect ratio",variant:"destructive"})}};return(0,i.jsxs)("div",{className:"space-y-6",children:[i.jsx(r.Zb,{className:"p-4",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsxs)("div",{children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),i.jsx(m.C,{className:"ml-2",variant:"default",children:"In Progress"})]}),(0,i.jsxs)("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:b.length})," overlays configured"]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 pl-4 border-l",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Aspect Ratio:"}),(0,i.jsxs)(d.Ph,{value:J,onValueChange:en,children:[i.jsx(d.i4,{className:"w-[120px]","data-testid":"aspect-ratio-select",children:i.jsx(d.ki,{})}),(0,i.jsxs)(d.Bw,{children:[i.jsx(d.Ql,{value:"16:9",children:"16:9 (Landscape)"}),i.jsx(d.Ql,{value:"9:16",children:"9:16 (Portrait)"})]})]})]}),_&&(0,i.jsxs)("div",{className:"flex items-center gap-2 ml-4 pl-4 border-l",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Selected:"}),i.jsx(m.C,{variant:"secondary",children:_.label||_.endpoint_key}),(0,i.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>{_&&W(e=>{let t=new Set(e);return t.has(_.id)?(t.delete(_.id),a({title:"Overlay Unlocked",description:"You can now edit this overlay"})):(t.add(_.id),a({title:"Overlay Locked",description:"This overlay is now protected from changes"})),t})},"data-testid":"toggle-lock-btn",children:[Z.has(_.id)?i.jsx(E.Z,{className:"w-4 h-4 mr-1"}):i.jsx(D,{className:"w-4 h-4 mr-1"}),Z.has(_.id)?"Unlock":"Lock"]}),(0,i.jsxs)(o.z,{variant:"outline",size:"sm",onClick:el,"data-testid":"duplicate-overlay-btn",children:[i.jsx(A.Z,{className:"w-4 h-4 mr-1"}),"Duplicate"]}),(0,i.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>{_&&ea(_.id)},className:"text-red-600 hover:text-red-700","data-testid":"delete-selected-btn",children:[i.jsx(M.Z,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]}),i.jsx("div",{className:"flex gap-2",children:(0,i.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>Q("timeline"===z?"list":"timeline"),"data-testid":"toggle-editor-mode-btn",children:[i.jsx(F,{className:"w-4 h-4 mr-2"}),"timeline"===z?"List View":"Timeline View"]})})]})}),(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,i.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,i.jsxs)(r.Zb,{className:"p-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"font-semibold",children:"Video Preview"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)(o.z,{size:"sm",variant:"outline",onClick:()=>G(!Y),"data-testid":"toggle-grid-snap-btn",className:Y?"bg-blue-100":"",children:["Grid Snap ",Y?"ON":"OFF"]}),(0,i.jsxs)(o.z,{size:"sm",variant:"outline",onClick:()=>S(!N),"data-testid":"toggle-overlays-btn",children:[N?i.jsx(I.Z,{className:"w-4 h-4 mr-1"}):i.jsx($.Z,{className:"w-4 h-4 mr-1"}),N?"Hide":"Show"," Overlays"]}),(0,i.jsxs)(o.z,{size:"sm",onClick:()=>h(!x),"data-testid":"play-pause-btn",children:[x?i.jsx(R.Z,{className:"w-4 h-4 mr-1"}):i.jsx(B.Z,{className:"w-4 h-4 mr-1"}),x?"Pause":"Play"]})]})]}),(0,i.jsxs)("div",{className:`relative bg-black rounded-lg overflow-hidden ${"9:16"===J?"aspect-[9/16] max-w-md mx-auto":"aspect-video"}`,ref:c,children:[i.jsx(Object(function(){var e=Error("Cannot find module 'react-player'");throw e.code="MODULE_NOT_FOUND",e}()),{ref:l,url:e?.video_data?.original_url,playing:x,controls:!1,width:"100%",height:"100%",onProgress:({playedSeconds:e})=>g(e),onDuration:f,onPlay:()=>h(!0),onPause:()=>h(!1),config:{file:{attributes:{controlsList:"nodownload",disablePictureInPicture:!0}}}}),i.jsx(P,{overlays:b,currentTime:p,duration:y,selectedOverlay:_,showOverlays:N,onSelectOverlay:w,onUpdateOverlay:et,containerRef:c,videoResolution:{width:e?.video_data?.width||1920,height:e?.video_data?.height||1080}})]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[i.jsx("span",{children:q(p)}),i.jsx("span",{children:q(y)})]}),i.jsx("input",{type:"range",min:0,max:y||100,value:p,onChange:e=>{let t=parseFloat(e.target.value);g(t),l.current&&l.current.seekTo(t)},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer","data-testid":"timeline-slider"})]})]}),(0,i.jsxs)(r.Zb,{className:"p-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4 flex-wrap gap-2",children:[(0,i.jsxs)("h3",{className:"font-semibold",children:["Text Overlays (",b.length,")"]}),(0,i.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,i.jsxs)(d.Ph,{value:X,onValueChange:H,children:[i.jsx(d.i4,{className:"w-[180px]","data-testid":"overlay-type-select",children:i.jsx(d.ki,{placeholder:"Select overlay type"})}),(0,i.jsxs)(d.Bw,{children:[i.jsx(d.Ql,{value:"bride_name",children:"Bride's Name"}),i.jsx(d.Ql,{value:"groom_name",children:"Groom's Name"}),i.jsx(d.Ql,{value:"bride_first_name",children:"Bride's First Name"}),i.jsx(d.Ql,{value:"groom_first_name",children:"Groom's First Name"}),i.jsx(d.Ql,{value:"couple_names",children:"Couple Names"}),i.jsx(d.Ql,{value:"event_date",children:"Event Date (Day)"}),i.jsx(d.Ql,{value:"event_date_full",children:"Event Date (Full)"}),i.jsx(d.Ql,{value:"event_month",children:"Event Month"}),i.jsx(d.Ql,{value:"event_year",children:"Event Year"}),i.jsx(d.Ql,{value:"event_day",children:"Event Day"}),i.jsx(d.Ql,{value:"event_time",children:"Event Time"}),i.jsx(d.Ql,{value:"venue",children:"Venue"}),i.jsx(d.Ql,{value:"venue_address",children:"Venue Address"}),i.jsx(d.Ql,{value:"city",children:"City"}),i.jsx(d.Ql,{value:"welcome_message",children:"Welcome Message"}),i.jsx(d.Ql,{value:"description",children:"Description"}),i.jsx(d.Ql,{value:"countdown_days",children:"Countdown Days"}),i.jsx(d.Ql,{value:"custom_text_1",children:"Custom Text 1"}),i.jsx(d.Ql,{value:"custom_text_2",children:"Custom Text 2"}),i.jsx(d.Ql,{value:"custom_text_3",children:"Custom Text 3"}),i.jsx(d.Ql,{value:"custom_text_4",children:"Custom Text 4"}),i.jsx(d.Ql,{value:"custom_text_5",children:"Custom Text 5"})]})]}),(0,i.jsxs)(o.z,{size:"sm",onClick:ee,"data-testid":"add-overlay-btn",children:[i.jsx(U.Z,{className:"w-4 h-4 mr-1"}),"Add Overlay"]})]})]}),"timeline"===z?i.jsx(O,{overlays:b,duration:y,currentTime:p,selectedOverlay:_,onSelectOverlay:w,onUpdateOverlay:et,onDeleteOverlay:ea,onReorder:ei,onSeek:e=>{g(e),l.current&&l.current.seekTo(e)}}):i.jsx(u.x,{className:"h-64",children:0===b.length?i.jsx("p",{className:"text-gray-500 text-center py-8",children:"No overlays added yet"}):i.jsx("div",{className:"space-y-2",children:b.map((e,t)=>i.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${_?.id===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>w(e),"data-testid":`overlay-item-${t}`,children:(0,i.jsxs)("div",{className:"flex justify-between items-start",children:[(0,i.jsxs)("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium text-sm",children:e.label||e.endpoint_key}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[q(e.timing?.start_time||0)," - ",q(e.timing?.end_time||0)]})]}),i.jsx(o.z,{size:"sm",variant:"ghost",onClick:t=>{t.stopPropagation(),ea(e.id)},className:"text-red-600 hover:text-red-700",children:i.jsx(M.Z,{className:"w-4 h-4"})})]})},e.id||t))})})]})]}),i.jsx("div",{className:"lg:col-span-1",children:i.jsx(r.Zb,{className:"p-4 sticky top-6",children:_?i.jsx(k,{overlay:_,duration:y,currentTime:p,onUpdate:e=>et(_.id,e),onSeek:e=>{g(e),l.current&&l.current.seekTo(e)}}):i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"Select an overlay to configure"})})})})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)(r.Zb,{className:"p-4 flex-1 mr-4",children:[i.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Keyboard Shortcuts"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[(0,i.jsxs)("div",{children:[i.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"Delete"})," - Delete selected overlay"]}),(0,i.jsxs)("div",{children:[i.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"Ctrl/Cmd + D"})," - Duplicate overlay"]}),(0,i.jsxs)("div",{children:[i.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"Arrow Keys"})," - Move overlay (1px)"]}),(0,i.jsxs)("div",{children:[i.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"Shift + Arrow"})," - Move overlay (10px)"]}),(0,i.jsxs)("div",{children:[i.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"Ctrl/Cmd + L"})," - Lock/Unlock overlay"]}),(0,i.jsxs)("div",{children:[i.jsx("kbd",{className:"px-2 py-1 bg-gray-100 rounded",children:"Shift + Drag"})," - Proportional resize"]})]})]}),(0,i.jsxs)(o.z,{onClick:es,disabled:C,size:"lg","data-testid":"save-template-btn",children:[i.jsx(v.Z,{className:"w-4 h-4 mr-2"}),C?"Saving...":"Save Template"]})]})]})}function q(e){return!e||isNaN(e)?"0:00":`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}var W=a(86333);function Y(){let e=(0,l.useRouter)();(0,l.useParams)();let{toast:t}=(0,V.pm)(),[a,n]=(0,s.useState)(null),[r,d]=(0,s.useState)(!0),c=async()=>{try{t({title:"Success",description:"Template saved successfully"}),await new Promise(e=>setTimeout(e,500)),e.push("/admin/video-templates")}catch(e){console.error("Error during save:",e),t({title:"Error",description:"Failed to save template",variant:"destructive"})}};return r?i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Loading template..."})]})}):a?(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("div",{className:"border-b bg-white px-6 py-4",children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,i.jsxs)(o.z,{variant:"ghost",onClick:()=>e.push("/admin/video-templates"),className:"mb-2","data-testid":"back-to-templates-btn",children:[i.jsx(W.Z,{className:"w-4 h-4 mr-2"}),"Back to Templates"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.name}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:a.description})]})}),i.jsx("div",{className:"max-w-7xl mx-auto p-6",children:i.jsx(Z,{template:a,onSave:c})})]}):null}a(89420)},99597:(e,t,a)=>{"use strict";a.d(t,{B:()=>o,x:()=>r});var i=a(10326),s=a(17577),l=a(16999),n=a(46084);let r=s.forwardRef(({className:e,children:t,...a},s)=>(0,i.jsxs)(l.fC,{ref:s,className:(0,n.cn)("relative overflow-hidden",e),...a,children:[i.jsx(l.l_,{className:"h-full w-full rounded-[inherit]",children:t}),i.jsx(o,{}),i.jsx(l.Ns,{})]}));r.displayName=l.fC.displayName;let o=s.forwardRef(({className:e,orientation:t="vertical",...a},s)=>i.jsx(l.gb,{ref:s,orientation:t,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...a,children:i.jsx(l.q4,{className:"relative flex-1 rounded-full bg-border"})}));o.displayName=l.gb.displayName},64745:(e,t,a)=>{"use strict";a.d(t,{i:()=>r});var i=a(10326),s=a(17577),l=a(87131),n=a(46084);let r=s.forwardRef(({className:e,...t},a)=>(0,i.jsxs)(l.fC,{ref:a,className:(0,n.cn)("relative flex w-full touch-none select-none items-center",e),...t,children:[i.jsx(l.fQ,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:i.jsx(l.e6,{className:"absolute h-full bg-primary"})}),i.jsx(l.bU,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));r.displayName=l.fC.displayName},78364:(e,t,a)=>{"use strict";a.d(t,{pm:()=>m});var i=a(17577);let s=0,l=new Map,n=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},r=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=r(d,e),o.forEach(e=>{e(d)})}function u({...e}){let t=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function m(){let[e,t]=i.useState(d);return i.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},94893:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});let i=(0,a(62881).Z)("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},1572:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});let i=(0,a(62881).Z)("sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},33140:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>r});var i=a(68570);let s=(0,i.createProxy)(String.raw`/app/frontend/app/admin/video-templates/[id]/page.js`),{__esModule:l,$$typeof:n}=s;s.default;let r=(0,i.createProxy)(String.raw`/app/frontend/app/admin/video-templates/[id]/page.js#default`)},9815:(e,t,a)=>{"use strict";a.d(t,{z:()=>n});var i=a(17577),s=a(48051),l=a(65819),n=e=>{let{present:t,children:a}=e,n=function(e){var t,a;let[s,n]=i.useState(),o=i.useRef(null),d=i.useRef(e),c=i.useRef("none"),[u,m]=(t=e?"mounted":"unmounted",a={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},i.useReducer((e,t)=>a[e][t]??e,t));return i.useEffect(()=>{let e=r(o.current);c.current="mounted"===u?e:"none"},[u]),(0,l.b)(()=>{let t=o.current,a=d.current;if(a!==e){let i=c.current,s=r(t);e?m("MOUNT"):"none"===s||t?.display==="none"?m("UNMOUNT"):a&&i!==s?m("ANIMATION_OUT"):m("UNMOUNT"),d.current=e}},[e,m]),(0,l.b)(()=>{if(s){let e;let t=s.ownerDocument.defaultView??window,a=a=>{let i=r(o.current).includes(CSS.escape(a.animationName));if(a.target===s&&i&&(m("ANIMATION_END"),!d.current)){let a=s.style.animationFillMode;s.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===s.style.animationFillMode&&(s.style.animationFillMode=a)})}},i=e=>{e.target===s&&(c.current=r(o.current))};return s.addEventListener("animationstart",i),s.addEventListener("animationcancel",a),s.addEventListener("animationend",a),()=>{t.clearTimeout(e),s.removeEventListener("animationstart",i),s.removeEventListener("animationcancel",a),s.removeEventListener("animationend",a)}}m("ANIMATION_END")},[s,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:i.useCallback(e=>{o.current=e?getComputedStyle(e):null,n(e)},[])}}(t),o="function"==typeof a?a({present:n.isPresent}):i.Children.only(a),d=(0,s.e)(n.ref,function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,a=t&&"isReactWarning"in t&&t.isReactWarning;return a?e.ref:(a=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(o));return"function"==typeof a||n.isPresent?i.cloneElement(o,{ref:d}):null};function r(e){return e?.animationName||"none"}n.displayName="Presence"}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),i=t.X(0,[8948,168,1961,6451,3789,4596,7131,9622,4342,370],()=>a(86996));module.exports=i})();