(()=>{var e={};e.id=1297,e.ids=[1297],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},57508:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(20768),s(73603),s(35866);var r=s(23191),a=s(88716),i=s(37922),l=s.n(i),o=s(95231),n={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);s.d(t,n);let c=["",{children:["webhooks",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,20768)),"/app/frontend/app/webhooks/page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,73603)),"/app/frontend/app/layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/app/frontend/app/webhooks/page.js"],x="/webhooks/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/webhooks/page",pathname:"/webhooks",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},68537:(e,t,s)=>{Promise.resolve().then(s.bind(s,67509))},67509:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var r=s(10326),a=s(17577),i=s(35047),l=s(94464),o=s(85999);let n=(0,s(62881).Z)("webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);var c=s(83855),d=s(30361),x=s(69669),u=s(48998),h=s(71059),p=s(94893),g=s(12714),m=s(98091);let y=process.env.NEXT_PUBLIC_API_URL||"http://localhost:8001/api",b=[{value:"stream.started",label:"Stream Started",description:"Triggered when a stream goes live"},{value:"stream.ended",label:"Stream Ended",description:"Triggered when a stream ends"},{value:"recording.ready",label:"Recording Ready",description:"Triggered when recording is ready"},{value:"viewer.joined",label:"Viewer Joined",description:"Triggered when a viewer joins"},{value:"wedding.created",label:"Wedding Created",description:"Triggered when a wedding is created"},{value:"wedding.updated",label:"Wedding Updated",description:"Triggered when wedding details are updated"}];function v(){let e=(0,i.useRouter)(),[t,s]=(0,a.useState)(null),[v,j]=(0,a.useState)([]),[f,w]=(0,a.useState)(!1),[k,N]=(0,a.useState)(!1),[Z,q]=(0,a.useState)(null),[_,C]=(0,a.useState)([]),[S,P]=(0,a.useState)({url:"",events:[],description:""}),$=async()=>{try{let e=localStorage.getItem("token"),t=await l.Z.get(`${y}/premium/webhooks`,{headers:{Authorization:`Bearer ${e}`}});j(t.data.webhooks||[])}catch(e){console.error("Failed to fetch webhooks:",e)}},z=async()=>{if(!S.url.trim()){o.toast.error("Please enter webhook URL");return}if(0===S.events.length){o.toast.error("Please select at least one event");return}w(!0);try{let e=localStorage.getItem("token");await l.Z.post(`${y}/premium/webhooks`,S,{headers:{Authorization:`Bearer ${e}`}}),o.toast.success("Webhook created successfully!"),N(!1),P({url:"",events:[],description:""}),$()}catch(e){o.toast.error(e.response?.data?.detail||"Failed to create webhook")}finally{w(!1)}},A=async(e,t)=>{let s="active"===t?"paused":"active";try{let t=localStorage.getItem("token");await l.Z.put(`${y}/premium/webhooks/${e}`,{status:s},{headers:{Authorization:`Bearer ${t}`}}),o.toast.success(`Webhook ${"active"===s?"activated":"paused"}`),$()}catch(e){o.toast.error("Failed to update webhook status")}},W=async e=>{if(confirm("Are you sure you want to delete this webhook?"))try{let t=localStorage.getItem("token");await l.Z.delete(`${y}/premium/webhooks/${e}`,{headers:{Authorization:`Bearer ${t}`}}),o.toast.success("Webhook deleted successfully"),$()}catch(e){o.toast.error("Failed to delete webhook")}},M=async e=>{q(e);try{let t=localStorage.getItem("token"),s=await l.Z.get(`${y}/premium/webhooks/${e.id}/logs`,{headers:{Authorization:`Bearer ${t}`}});C(s.data.logs||[])}catch(e){console.error("Failed to fetch logs:",e),C([])}},L=e=>{S.events.includes(e)?P({...S,events:S.events.filter(t=>t!==e)}):P({...S,events:[...S.events,e]})};return t?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("div",{className:"bg-white shadow",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[r.jsx(n,{className:"w-8 h-8 text-indigo-600"}),"Webhooks"]}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Receive real-time notifications about events"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>e.push("/settings"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Back to Settings"}),(0,r.jsxs)("button",{onClick:()=>N(!0),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 flex items-center gap-2",children:[r.jsx(c.Z,{className:"w-4 h-4"}),"Create Webhook"]})]})]})})}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8",children:r.jsx("div",{className:"bg-white rounded-lg shadow",children:0===v.length?(0,r.jsxs)("div",{className:"p-12 text-center",children:[r.jsx(n,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No webhooks configured"}),r.jsx("p",{className:"text-gray-500 mb-4",children:"Create a webhook to receive real-time notifications"}),r.jsx("button",{onClick:()=>N(!0),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Create Webhook"})]}):r.jsx("div",{className:"divide-y divide-gray-200",children:v.map(e=>r.jsx("div",{className:"p-6 hover:bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.description||"Webhook"}),r.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${"active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.status})]}),r.jsx("p",{className:"text-sm text-gray-600 font-mono bg-gray-100 px-3 py-1 rounded inline-block mb-2",children:e.url}),r.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:e.events.map(e=>r.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-800 rounded text-xs",children:e},e))}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[r.jsx(d.Z,{className:"w-4 h-4 text-green-600"}),e.success_count," successes"]}),(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[r.jsx(x.Z,{className:"w-4 h-4 text-red-600"}),e.failure_count," failures"]}),e.last_triggered&&(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[r.jsx(u.Z,{className:"w-4 h-4"}),"Last: ",new Date(e.last_triggered).toLocaleString()]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 ml-4",children:[r.jsx("button",{onClick:()=>A(e.id,e.status),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"active"===e.status?"Pause":"Activate",children:"active"===e.status?r.jsx(h.Z,{className:"w-5 h-5"}):r.jsx(p.Z,{className:"w-5 h-5"})}),r.jsx("button",{onClick:()=>M(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"View logs",children:r.jsx(g.Z,{className:"w-5 h-5"})}),r.jsx("button",{onClick:()=>W(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:r.jsx(m.Z,{className:"w-5 h-5"})})]})]})},e.id))})})}),k&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6 my-8",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Create Webhook"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Webhook URL *"}),r.jsx("input",{type:"url",value:S.url,onChange:e=>P({...S,url:e.target.value}),placeholder:"https://your-api.com/webhook",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),r.jsx("input",{type:"text",value:S.description,onChange:e=>P({...S,description:e.target.value}),placeholder:"e.g., Production webhook",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Events to Subscribe *"}),r.jsx("div",{className:"space-y-2",children:b.map(e=>(0,r.jsxs)("div",{className:"flex items-start gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[r.jsx("input",{type:"checkbox",id:e.value,checked:S.events.includes(e.value),onChange:()=>L(e.value),className:"mt-1 w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("label",{htmlFor:e.value,className:"text-sm font-medium text-gray-900 cursor-pointer",children:e.label}),r.jsx("p",{className:"text-xs text-gray-500",children:e.description})]})]},e.value))})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[r.jsx("button",{onClick:()=>{N(!1),P({url:"",events:[],description:""})},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"}),r.jsx("button",{onClick:z,disabled:f||!S.url.trim()||0===S.events.length,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:f?"Creating...":"Create Webhook"})]})]})]})}),Z&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full p-6 my-8 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Webhook Logs"}),r.jsx("button",{onClick:()=>{q(null),C([])},className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:Z.url}),0===_.length?r.jsx("div",{className:"text-center py-12 text-gray-500",children:"No logs available yet"}):r.jsx("div",{className:"space-y-3",children:_.map((e,t)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.success?"Success":"Failed"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.event}),e.status_code>0&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["Status: ",e.status_code]})]}),r.jsx("span",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString()})]}),e.response&&r.jsx("div",{className:"mt-2 bg-gray-900 text-green-400 p-3 rounded text-xs font-mono overflow-x-auto",children:e.response})]},t))})]})})]}):r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})})}},30361:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(62881).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},69669:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(62881).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},48998:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(62881).Z)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},12714:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(62881).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},71059:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(62881).Z)("pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]])},94893:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(62881).Z)("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},83855:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(62881).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},98091:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(62881).Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},20768:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>o});var r=s(68570);let a=(0,r.createProxy)(String.raw`/app/frontend/app/webhooks/page.js`),{__esModule:i,$$typeof:l}=a;a.default;let o=(0,r.createProxy)(String.raw`/app/frontend/app/webhooks/page.js#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,168,4342],()=>s(57508));module.exports=r})();