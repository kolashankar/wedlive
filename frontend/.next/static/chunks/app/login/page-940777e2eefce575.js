(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626,6657],{81365:function(e,t,r){Promise.resolve().then(r.bind(r,77845))},77845:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n=r(57437),s=r(2265),o=r(15730),a=r(56360),l=r(92404),i=r(10273),c=r(10464),d=r(11980),u=r(64042),f=r(76780),m=r(3274),p=r(87138),g=r(16463),x=r(27776),v=r(38472);let h=r(20357).env.NEXT_PUBLIC_API_URL||"http://localhost:8001";function w(){let[e,t]=(0,s.useState)(""),[r,w]=(0,s.useState)(""),[y,b]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),[_,R]=(0,s.useState)(""),{login:I}=(0,o.a)(),S=(0,g.useRouter)(),A="true"===(0,g.useSearchParams)().get("expired");(0,s.useEffect)(()=>{A&&x.toast.error("Your session has expired. Please log in again.")},[A]);let E=async()=>{try{N(!0);let e=await v.Z.get("".concat(h,"/api/auth/google/login"));e.data.state&&localStorage.setItem("google_oauth_state",e.data.state),window.location.href=e.data.oauth_url}catch(e){console.error("Google login error:",e),x.toast.error("Failed to initiate Google login"),N(!1)}},P=async t=>{t.preventDefault(),R(""),b(!0);try{await I(e,r),x.toast.success("Welcome back!"),S.push("/dashboard")}catch(e){var n,s;R((null===(s=e.response)||void 0===s?void 0:null===(n=s.data)||void 0===n?void 0:n.detail)||"Invalid email or password"),x.toast.error("Login failed")}finally{b(!1)}};return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-white to-purple-50 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"w-full max-w-md",children:[(0,n.jsxs)(p.default,{href:"/",className:"flex items-center justify-center space-x-2 mb-8",children:[(0,n.jsx)(u.Z,{className:"w-8 h-8 text-rose-500"}),(0,n.jsx)("span",{className:"text-3xl font-bold bg-gradient-to-r from-rose-500 to-purple-600 bg-clip-text text-transparent",children:"WedLive"})]}),(0,n.jsxs)(i.Zb,{className:"border-2 shadow-lg",children:[(0,n.jsxs)(i.Ol,{children:[(0,n.jsx)(i.ll,{className:"text-2xl",children:"Welcome Back"}),(0,n.jsx)(i.SZ,{children:"Sign in to your WedLive account"})]}),(0,n.jsxs)("form",{onSubmit:P,children:[(0,n.jsxs)(i.aY,{className:"space-y-4",children:[A&&(0,n.jsxs)(d.bZ,{variant:"default",className:"border-orange-500 bg-orange-50",children:[(0,n.jsx)(f.Z,{className:"h-4 w-4 text-orange-600"}),(0,n.jsxs)(d.X,{className:"text-orange-800",children:[(0,n.jsx)("strong",{children:"Session Expired:"})," Your session has expired for security reasons. Please log in again to continue."]})]}),_&&(0,n.jsx)(d.bZ,{variant:"destructive",children:(0,n.jsx)(d.X,{children:_})}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(c._,{htmlFor:"email",children:"Email"}),(0,n.jsx)(l.I,{id:"email",type:"email",placeholder:"your@email.com",value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(c._,{htmlFor:"password",children:"Password"}),(0,n.jsx)(l.I,{id:"password",type:"password",placeholder:"••••••••",value:r,onChange:e=>w(e.target.value),required:!0})]})]}),(0,n.jsxs)(i.eW,{className:"flex flex-col space-y-4",children:[(0,n.jsx)(a.z,{type:"submit",className:"w-full bg-gradient-to-r from-rose-500 to-purple-600",disabled:y||j,children:y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,n.jsx)("span",{className:"w-full border-t"})}),(0,n.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,n.jsx)("span",{className:"bg-white px-2 text-muted-foreground",children:"Or continue with"})})]}),(0,n.jsx)(a.z,{type:"button",variant:"outline",className:"w-full",onClick:E,disabled:y||j,children:j?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting to Google..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"mr-2 h-4 w-4",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,n.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,n.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,n.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]})}),(0,n.jsxs)("p",{className:"text-sm text-center text-gray-600",children:["Don't have an account?"," ",(0,n.jsx)(p.default,{href:"/register",className:"text-rose-500 hover:underline font-medium",children:"Sign up"})]})]})]})]})]})})}function y(){return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-rose-50 via-white to-purple-50 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"w-full max-w-md",children:[(0,n.jsxs)(p.default,{href:"/",className:"flex items-center justify-center space-x-2 mb-8",children:[(0,n.jsx)(u.Z,{className:"w-8 h-8 text-rose-500"}),(0,n.jsx)("span",{className:"text-3xl font-bold bg-gradient-to-r from-rose-500 to-purple-600 bg-clip-text text-transparent",children:"WedLive"})]}),(0,n.jsxs)(i.Zb,{className:"border-2 shadow-lg",children:[(0,n.jsxs)(i.Ol,{children:[(0,n.jsx)(i.ll,{className:"text-2xl",children:"Welcome Back"}),(0,n.jsx)(i.SZ,{children:"Sign in to your WedLive account"})]}),(0,n.jsx)(i.aY,{className:"space-y-4",children:(0,n.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,n.jsx)(m.Z,{className:"h-8 w-8 animate-spin text-rose-500"})})})]})]})})}function b(){return(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(y,{}),children:(0,n.jsx)(w,{})})}},11980:function(e,t,r){"use strict";r.d(t,{X:function(){return c},bZ:function(){return i}});var n=r(57437),s=r(2265),o=r(13027),a=r(77700);let l=(0,o.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=s.forwardRef((e,t)=>{let{className:r,variant:s,...o}=e;return(0,n.jsx)("div",{ref:t,role:"alert",className:(0,a.cn)(l({variant:s}),r),...o})});i.displayName="Alert",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h5",{ref:t,className:(0,a.cn)("mb-1 font-medium leading-none tracking-tight",r),...s})}).displayName="AlertTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-sm [&_p]:leading-relaxed",r),...s})});c.displayName="AlertDescription"},56360:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var n=r(57437),s=r(2265),o=r(71538),a=r(13027),l=r(77700);let i=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:a,asChild:c=!1,...d}=e,u=c?o.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(i({variant:s,size:a,className:r})),ref:t,...d})});c.displayName="Button"},10273:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return a},aY:function(){return d},eW:function(){return u},ll:function(){return i}});var n=r(57437),s=r(2265),o=r(77700);let a=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});a.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...s})});l.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("font-semibold leading-none tracking-tight",r),...s})});i.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},92404:function(e,t,r){"use strict";r.d(t,{I:function(){return a}});var n=r(57437),s=r(2265),o=r(77700);let a=s.forwardRef((e,t)=>{let{className:r,type:s,...a}=e;return(0,n.jsx)("input",{type:s,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...a})});a.displayName="Input"},10464:function(e,t,r){"use strict";r.d(t,{_:function(){return c}});var n=r(57437),s=r(2265),o=r(38837),a=r(13027),l=r(77700);let i=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(o.f,{ref:t,className:(0,l.cn)(i(),r),...s})});c.displayName=o.f.displayName},6657:function(e,t,r){"use strict";r.r(t);var n=r(38472),s=r(78614);(0,s.ww)(),console.log("API Base URL:",(0,s.bR)());let o=n.Z.create({baseURL:(0,s.bR)(),headers:{"Content-Type":"application/json"},timeout:s.ZP.API.TIMEOUT});o.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),o.interceptors.response.use(e=>e,async e=>{var t,r,n,a,l,i,c;let d=e.config;if(console.error("API Error:",e),"ECONNABORTED"===e.code||"Network Error"===e.message){if(d.__retryCount||(d.__retryCount=0),d.__retryCount<s.ZP.API.RETRY_ATTEMPTS)return d.__retryCount+=1,console.warn("Retrying request (".concat(d.__retryCount,"/").concat(s.ZP.API.RETRY_ATTEMPTS,")...")),await new Promise(e=>setTimeout(e,s.ZP.API.RETRY_DELAY*d.__retryCount)),o(d);console.error("Request timeout after retries - API might be down")}if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&(console.error("❌ Authentication failed - token expired or invalid"),localStorage.removeItem("token"),localStorage.removeItem("user"),void 0!==window.toast&&(null===(a=window.toast)||void 0===a||a.error("Your session has expired. Please log in again.")),window.location.href="/login?expired=true"),(null===(r=e.response)||void 0===r?void 0:r.status)===403){console.error("❌ Access forbidden - you may not have permission or your session expired");let t=(null===(i=e.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.detail)||"";(t.toLowerCase().includes("not authorized")||t.toLowerCase().includes("permission"))&&(console.warn("⚠️ Token may be expired - redirecting to login"),localStorage.removeItem("token"),localStorage.removeItem("user"),void 0!==window.toast&&(null===(c=window.toast)||void 0===c||c.error("Your session has expired. Please log in again.")),window.location.href="/login?expired=true")}return(null===(n=e.response)||void 0===n?void 0:n.status)===404&&console.error("Resource not found - check API endpoint"),Promise.reject(e)}),t.default=o},15730:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return i},a:function(){return c}});var n=r(57437),s=r(2265),o=r(6657);let a=(0,s.createContext)({});function l(e){if(!e)return!0;let t=function(e){try{let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(r)}catch(e){return console.error("Failed to decode JWT:",e),null}}(e);return!t||!t.exp||1e3*t.exp-Date.now()<3e5}let i=e=>{let{children:t}=e,[r,i]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,f]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&t&&(l(e)?(console.warn("⚠️ JWT token expired - clearing auth state"),localStorage.removeItem("token"),localStorage.removeItem("user"),d(null),i(null)):(d(e),i(JSON.parse(t)))),f(!1)},[]);let m=async(e,t)=>{let{access_token:r,user:n}=(await o.default.post("/api/auth/login",{email:e,password:t})).data;return localStorage.setItem("token",r),localStorage.setItem("user",JSON.stringify(n)),d(r),i(n),n},p=async(e,t,r)=>{let{access_token:n,user:s}=(await o.default.post("/api/auth/register",{email:e,password:t,full_name:r})).data;return localStorage.setItem("token",n),localStorage.setItem("user",JSON.stringify(s)),d(n),i(s),s},g=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),d(null),i(null),window.location.href="/"},x=async()=>{try{let e=(await o.default.get("/api/auth/me")).data;return localStorage.setItem("user",JSON.stringify(e)),i(e),e}catch(t){var e;return console.error("Failed to refresh user data:",t),(null===(e=t.response)||void 0===e?void 0:e.status)===401&&(console.error("❌ Token invalid - logging out"),g()),null}};return(0,s.useEffect)(()=>{if(!c)return;let e=setInterval(()=>{l(c)&&(console.warn("⚠️ JWT token expired - logging out"),g())},6e4);return()=>clearInterval(e)},[c]),(0,n.jsx)(a.Provider,{value:{user:r,token:c,setToken:d,setUser:i,login:m,register:p,logout:g,refreshUser:x,loading:u,isTokenExpired:()=>l(c)},children:t})},c=()=>(0,s.useContext)(a)},78614:function(e,t,r){"use strict";r.d(t,{bR:function(){return a},ww:function(){return l}});var n=r(20357);let s=()=>{{let e=window.location.hostname;return e.includes("vercel.app")||e.includes("wedlive.vercel.app")}},o={API:{BASE_URL:(()=>{let e=n.env.NEXT_PUBLIC_BACKEND_URL||n.env.REACT_APP_BACKEND_URL||n.env.NEXT_PUBLIC_API_URL;if(e)return e;{let e=window.location.hostname;if(e.includes("emergentagent.com")||e.includes("preview.emergentagent.com"))return window.location.origin;if(e.includes("vercel.app")||e.includes("wedlive.vercel.app"))return"https://wedlive.onrender.com";e.includes("localhost")||e.includes("127.0.0.1")}return"http://localhost:8001"})(),TIMEOUT:3e5,RETRY_ATTEMPTS:2,RETRY_DELAY:1e3},MEDIA:{PROXY_ENDPOINT:"/api/media/telegram-proxy/photos/",SUPPORTED_FORMATS:["jpg","jpeg","png","webp"],MAX_FILE_SIZE:10485760},IMAGE:{MAX_RETRIES:2,RETRY_DELAY:1e3,FALLBACK_TIMEOUT:5e3,LOADING_PLACEHOLDER:"/images/placeholder.jpg"}},a=()=>o.API.BASE_URL,l=()=>{let e=a(),t=e.includes("localhost"),r=s();return console.log("\uD83D\uDD27 Configuration Validation:",{apiBaseUrl:e,environment:r?"production":"development",isLocal:t,mediaProxy:o.MEDIA.PROXY_ENDPOINT}),r&&t&&(console.error("❌ ERROR: Production frontend using localhost backend URL!"),console.error("Update NEXT_PUBLIC_API_URL in Vercel environment variables to: https://wedlive.onrender.com")),e.includes("8000")&&console.warn("⚠️ WARNING: API base URL is using port 8000, expected 8001 for local or 443 for production"),!0};t.ZP=o},77700:function(e,t,r){"use strict";r.d(t,{cn:function(){return o}});var n=r(44839),s=r(96164);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}},76780:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},64042:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},3274:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(78030).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},38837:function(e,t,r){"use strict";r.d(t,{f:function(){return i}});var n=r(2265);r(54887);var s=r(71538),o=r(57437),a=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,s.Z8)(`Primitive.${t}`),a=n.forwardRef((e,n)=>{let{asChild:s,...a}=e,l=s?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(l,{...a,ref:n})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{}),l=n.forwardRef((e,t)=>(0,o.jsx)(a.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var i=l}},function(e){e.O(0,[9767,4868,7776,7515,2971,7023,1744],function(){return e(e.s=81365)}),_N_E=e.O()}]);