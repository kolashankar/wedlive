(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2858],{75337:function(e,a,s){Promise.resolve().then(s.bind(s,73334))},73334:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return M}});var t=s(57437),r=s(2265),l=s(10273),o=s(56360),n=s(79004),i=s(3274),c=s(95137),d=s(76780),m=s(74697),g=s(22468),h=s(58184),u=s(39451),p=s(24863),x=s(10883),f=s(16463),b=s(38472),v=s(85398),y=s(91773),k=s(99913),w=s(21577),j=s(38296),N=s(24258),C=s(39348),T=s(3751),S=s(54775),_=s(75733),B=s(59061),P=s(82616),R=s(44828),F=s(92095);function z(e){let{imageUrl:a,onBorderSave:c,onClose:d,assetType:g="border",className:h="",borderId:p=null,previewPhotoUrl:x=null}=e,f=(0,r.useRef)(null),b=(0,r.useRef)(null),z=(0,r.useRef)(null),I=(0,r.useRef)(null),M=(0,r.useRef)(null),[A,E]=(0,r.useState)(!1),[O,D]=(0,r.useState)("pen"),[U,Z]=(0,r.useState)([]),[L,G]=(0,r.useState)([]),[W,Y]=(0,r.useState)(null),[X,H]=(0,r.useState)(1),[V,q]=(0,r.useState)({x:0,y:0}),[J,K]=(0,r.useState)(!0),[$,Q]=(0,r.useState)([.7]),[ee,ea]=(0,r.useState)([]),[es,et]=(0,r.useState)(-1),[er,el]=(0,r.useState)(null),[eo,en]=(0,r.useState)(!1),[ei,ec]=(0,r.useState)([]),[ed,em]=(0,r.useState)("detect"),[eg,eh]=(0,r.useState)([50]),[eu,ep]=(0,r.useState)([5]),[ex,ef]=(0,r.useState)([10]),[eb,ev]=(0,r.useState)([5]),[ey,ek]=(0,r.useState)(null),[ew,ej]=(0,r.useState)(!1),[eN,eC]=(0,r.useState)(!1),[eT,eS]=(0,r.useState)([]),[e_,eB]=(0,r.useState)(null),[eP,eR]=(0,r.useState)(!0),[eF,ez]=(0,r.useState)("auto"),[eI,eM]=(0,r.useState)("#00ff00"),[eA,eE]=(0,r.useState)([50]),[eO,eD]=(0,r.useState)([2]),[eU,eZ]=(0,r.useState)([50]),[eL,eG]=(0,r.useState)([20]),[eW,eY]=(0,r.useState)(null),[eX,eH]=(0,r.useState)(null),[eV,eq]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(a){console.log("Loading image from URL:",a);let e=new Image;e.crossOrigin="anonymous",e.onload=()=>{console.log("Image loaded successfully, dimensions:",e.width,"x",e.height),el(e),an(e),eJ(e)},e.onerror=e=>{console.error("Error loading image:",e),en(!1)},e.src=a}else console.log("No imageUrl provided")},[a]),(0,r.useEffect)(()=>{if(er&&eP&&I.current){console.log("Auto-running chroma key processing for loaded image");let e=setTimeout(()=>{ae()},100);return()=>clearTimeout(e)}},[er,eP,I.current]);let eJ=(0,r.useCallback)(e=>{console.log("Task 1: Initializing finalCanvas - Standardized Pipeline");let a=document.createElement("canvas");a.width=e.width,a.height=e.height;let s=a.getContext("2d");return I.current=a,M.current=s,console.log("Task 1: finalCanvas initialized with dimensions:",e.width,"x",e.height),console.log("Task 1: Standardized pipeline ready for composition"),a},[]),eK=(0,r.useCallback)(async e=>{let{transparentImage:a,maskPath:s,borderOverlay:t}=e;console.log("Task 1: Starting standardized pipeline composition");let r=I.current,l=M.current;if(!r||!l)return console.error("Task 1: finalCanvas not initialized"),null;if(l.clearRect(0,0,r.width,r.height),s&&s.length>0){console.log("Task 3: Applying mask clipping BEFORE drawing transparent image");let e=e$(s);e?(eQ(l,e),a&&(console.log("Task 3: Drawing transparent image WITHIN mask bounds"),l.drawImage(a,0,0)),e0(l)):a&&(console.log("Task 3: Mask creation failed, drawing transparent image without clipping"),l.drawImage(a,0,0))}else a&&(console.log("Task 3: No mask path available, drawing transparent image without clipping"),l.drawImage(a,0,0));return t?(console.log("Task 4: Overlaying floral frame as non-masked layer"),l.drawImage(t,0,0),console.log("Task 4: Floral frame overlay completed"),console.log("Task 4: Frame is visible outside mask, center remains transparent")):console.log("Task 4: No floral frame overlay provided"),console.log("Task 1: Pipeline composition completed"),r},[]),e$=(0,r.useCallback)(e=>{if(console.log("Task 2: Converting drawn border to Canvas Path2D mask"),!e||e.length<3)return console.error("Task 2: Insufficient points for mask path"),null;let a=new Path2D;a.moveTo(e[0].x,e[0].y);for(let s=1;s<e.length;s++)a.lineTo(e[s].x,e[s].y);return a.closePath(),console.log("Task 2: Mask path created with",e.length,"points"),console.log("Task 2: Path is closed and ready for clipping"),a},[]),eQ=(0,r.useCallback)((e,a)=>(console.log("Task 2: Applying mask clipping to canvas context"),a)?(e.save(),e.beginPath(),e.clip(a),console.log("Task 2: Mask clipping applied successfully"),console.log("Task 2: Canvas context is now clipped to mask path"),!0):(console.error("Task 2: No mask path provided for clipping"),!1),[]),e0=(0,r.useCallback)(e=>{console.log("Task 2: Restoring canvas context after clipping"),e.restore(),console.log("Task 2: Canvas context restored")},[]);(0,r.useCallback)(()=>{let e="draw"===ed&&U.length>3?U:ei;return console.log("Task 2: Final border points:",e.length,"points from mode:",ed),e},[ed,U,ei]),(0,r.useCallback)(async e=>{if(console.log("Task 3: Processing chroma key result with mask application"),!await ae()||!eX)return console.error("Task 3: No chroma key processed image available"),null;console.log("Task 3: Chroma key processing completed, applying mask");let a=await eK({transparentImage:eX,maskPath:e,borderOverlay:null});return a&&(console.log("Task 3: Mask successfully applied to transparent image"),console.log("Task 3: Final canvas dimensions:",a.width,"x",a.height)),a},[eX,eK]);let e2=(0,r.useCallback)(async()=>(console.log("Task 4: Loading floral frame overlay"),er)?(console.log("Task 4: Using original image as floral frame overlay"),console.log("Task 4: Frame dimensions:",er.width,"x",er.height),er):(console.error("Task 4: No original image available for floral frame"),null),[er]);(0,r.useCallback)(async e=>{console.log("Task 4: Starting complete composition with floral frame"),await e2();let a=await eK({transparentImage:eX,maskPath:e,borderOverlay:null});return a&&(console.log("Task 4: Complete composition with floral frame completed"),console.log("Task 4: Final result has transparent center + visible floral border")),a},[e2,eX,eK]);let e1=(0,r.useCallback)(async e=>(console.log("Task 5: Exporting PNG with alpha transparency"),e)?new Promise((a,s)=>{try{console.log("Task 5: Converting canvas to PNG blob with alpha"),console.log("Task 5: Canvas dimensions:",e.width,"x",e.height),e.toBlob(t=>{if(!t){console.error("Task 5: Failed to create PNG blob"),s(Error("Failed to create PNG blob"));return}if("image/png"!==t.type){console.error("Task 5: Export is not PNG format:",t.type),s(Error("Export is not PNG format"));return}console.log("Task 5: PNG export successful"),console.log("Task 5: File size:",(t.size/1024/1024).toFixed(2),"MB"),console.log("Task 5: Alpha transparency preserved");let r=URL.createObjectURL(t);a({blob:t,url:r,canvas:e,dimensions:{width:e.width,height:e.height},format:"PNG",hasAlpha:!0,quality:1})},"image/png",1)}catch(e){console.error("Task 5: Error during PNG export:",e),s(e)}}):(console.error("Task 5: No canvas provided for export"),null),[]),e4=(0,r.useCallback)(async e=>{console.log("Task 5: Exporting final composition - masked transparent image only");try{if(!eX){console.error("Save blocked: No processed transparent image available"),setError("Please process background removal first before saving the border");return}console.log("Save validation passed: Processed transparent image available"),eP&&(console.log("Task 5: Confirming chroma key processing before export"),await new Promise(e=>{let a=()=>{eX?(console.log("Task 5: Processed image confirmed ready for export"),e()):(ae(),setTimeout(a,200))};a()}));let a=await eK({transparentImage:eX,maskPath:e,borderOverlay:null});if(!a)return console.error("Task 5: Failed to create masked composition"),null;let s=await e1(a);return s&&(console.log("Task 5: Masked transparent image exported successfully"),console.log("Task 5: Ready for save/upload - no floral frame")),s}catch(e){return console.error("Task 5: Error exporting masked composition:",e),null}},[eX,eK,e1]),e5=(0,r.useCallback)((e,a)=>{console.log("Task 7: Creating mask metadata for dynamic photo reuse");let s=e3(e),t={maskPath:e,maskBounds:s,pointCount:e.length,feather:eu[0],shadowBlur:ex[0],shadowOffset:eb[0],chromaKeySettings:eP?{enabled:!0,mode:eF,keyColor:"auto"===eF?eW:eI,tolerance:eA[0],edgeFeather:eO[0],edgeSmoothness:eU[0],spillSuppression:eL[0]}:null,exportInfo:a?{dimensions:a.dimensions,format:a.format,hasAlpha:a.hasAlpha,quality:a.quality,timestamp:new Date().toISOString()}:null,autoFitMetadata:{maskArea:ag(e),aspectRatio:s?(s.width/s.height).toFixed(2):"1.0",centerPoint:am(e),scalingStrategy:"contain",padding:10},templateInfo:{assetType:g,mode:ed,createdAt:new Date().toISOString(),version:"1.0.0",pipeline:"chroma_key_mask_frame_png"}};return console.log("Task 7: Mask metadata created"),console.log("Task 7: Mask bounds:",s),console.log("Task 7: Point count:",e.length),t},[eu,ex,eb,eP,eF,eW,eI,eA,eO,eU,eL,g,ed]),e3=(0,r.useCallback)(e=>{if(console.log("Task 7: Calculating mask bounds for auto-fitting"),!e||0===e.length)return console.error("Task 7: No border points provided for bounds calculation"),null;let a=1/0,s=1/0,t=-1/0,r=-1/0;e.forEach(e=>{a=Math.min(a,e.x),s=Math.min(s,e.y),t=Math.max(t,e.x),r=Math.max(r,e.y)});let l={x:a,y:s,width:t-a,height:r-s,centerX:a+(t-a)/2,centerY:s+(r-s)/2};return console.log("Task 7: Mask bounds calculated:",l),l},[]),e7=(0,r.useCallback)(async(e,a)=>{console.log("Task 7: Persisting mask metadata for reuse");try{let t=e5(e,a);if(p){console.log("Task 7: Saving mask metadata to backend API");let e=(await s.e(6657).then(s.bind(s,6657))).default;await e.put("/api/admin/theme-assets/borders/".concat(p,"/mask-metadata"),t),console.log("Task 7: Backend metadata save completed")}try{let e="wedlive-mask-metadata-".concat(p||"temp");localStorage.setItem(e,JSON.stringify(t)),console.log("Task 7: LocalStorage backup completed")}catch(e){console.warn("Task 7: LocalStorage backup failed:",e)}try{let e="wedlive-mask-session-".concat(Date.now());sessionStorage.setItem(e,JSON.stringify(t)),console.log("Task 7: SessionStorage backup completed")}catch(e){console.warn("Task 7: SessionStorage backup failed:",e)}return console.log("Task 7: Mask metadata persistence completed"),console.log("Task 7: Metadata size:",JSON.stringify(t).length,"characters"),t}catch(e){return console.error("Task 7: Error persisting mask metadata:",e),null}},[p,e5]),e6=(0,r.useCallback)((e,a)=>{if(console.log("Task 8: Calculating auto-fit transform for photo"),!e||!a||!a.maskBounds)return console.error("Task 8: Missing photo image or mask metadata"),null;let{maskBounds:s,autoFitMetadata:t}=a,r=t.padding||10,l=s.width-2*r,o=s.height-2*r,n=l/e.width,i=o/e.height,c,d=0;switch(t.scalingStrategy){case"cover":c=Math.max(n,i);break;case"fill":c=n;break;default:c=Math.min(n,i)}let m=e.width*c,g=e.height*c,h={scale:c,offsetX:s.x+r+(l-m)/2,offsetY:s.y+r+(o-g)/2,scaledWidth:m,scaledHeight:g,sourceWidth:e.width,sourceHeight:e.height,maskBounds:s,scalingStrategy:t.scalingStrategy,padding:r};return console.log("Task 8: Auto-fit transform calculated:",h),h},[]),e8=(0,r.useCallback)((e,a,s,t)=>{if(console.log("Task 8: Applying photo to mask with auto-fit"),!e||!a||!s||!t)return console.error("Task 8: Missing required parameters for photo application"),!1;let r=e.getContext("2d"),l=e$(s.maskPath);return l?(r.clearRect(0,0,e.width,e.height),r.save(),r.beginPath(),r.clip(l),r.drawImage(a,t.offsetX,t.offsetY,t.scaledWidth,t.scaledHeight),r.restore(),console.log("Task 8: Photo applied to mask successfully"),console.log("Task 8: Photo dimensions:",t.scaledWidth,"x",t.scaledHeight),console.log("Task 8: Position:",t.offsetX,"x",t.offsetY),!0):(console.error("Task 8: Failed to create mask path"),!1)},[e$]),e9=(0,r.useCallback)(async(e,a,s)=>{console.log("Task 8: Creating dynamic photo composition");try{let t=e6(e,a);if(!t)return console.error("Task 8: Failed to calculate auto-fit transform"),null;let r=document.createElement("canvas");if(r.width=a.exportInfo.dimensions.width,r.height=a.exportInfo.dimensions.height,!e8(r,e,a,t))return console.error("Task 8: Failed to apply photo to mask"),null;s&&(r.getContext("2d").drawImage(s,0,0),console.log("Task 8: Floral frame overlay applied"));let l=await e1(r);return l&&(console.log("Task 8: Dynamic photo composition completed"),console.log("Task 8: Auto-fit strategy:",t.scalingStrategy),console.log("Task 8: Scale factor:",t.scale.toFixed(2))),l}catch(e){return console.error("Task 8: Error creating dynamic photo composition:",e),null}},[e6,e8,e1]);(0,r.useCallback)(async(e,a)=>(console.log("Task 8: Processing uploaded photo for dynamic fitting"),new Promise((s,t)=>{let r=new Image;r.onload=async()=>{console.log("Task 8: Photo loaded successfully:",r.width,"x",r.height);let e=await e9(r,a,er);e?(console.log("Task 8: Dynamic photo processing completed"),s(e)):t(Error("Failed to create dynamic photo composition"))},r.onerror=()=>{t(Error("Failed to load photo"))},r.src=URL.createObjectURL(e)})),[e9,er]);let ae=()=>{if(!er)return;console.log("Processing Simplified Background Removal");let e=document.createElement("canvas"),a=e.getContext("2d");e.width=er.width,e.height=er.height,a.drawImage(er,0,0);let s=a.getImageData(0,0,e.width,e.height),t=s.data,r=0;for(let e=0;e<t.length;e+=4)(t[e]+t[e+1]+t[e+2])/3<80&&(t[e+3]=0,r++);a.putImageData(s,0,0),console.log("Background removal completed: ".concat(r," pixels made transparent")),e.toBlob(a=>{let s=URL.createObjectURL(a),t=new Image;t.onload=()=>{eH(t),eq(e),console.log("Processed image with transparent background ready")},t.src=s},"image/png")};(0,r.useEffect)(()=>{if(eP&&er){let e=setTimeout(()=>{ae()},300);return()=>clearTimeout(e)}},[eP,eF,eI,eA,eO,eU,eL,er]);let aa=(0,r.useCallback)(()=>{let e=ee.slice(0,es+1);e.push(JSON.parse(JSON.stringify(L))),ea(e),et(e.length-1)},[L,ee,es]),as=(0,r.useCallback)(()=>{es>0&&(et(es-1),G(ee[es-1]))},[ee,es]),at=(0,r.useCallback)(()=>{es<ee.length-1&&(et(es+1),G(ee[es+1]))},[ee,es]),ar=e=>{if("pen"!==O||"draw"!==ed)return;let a=f.current,s=a.getBoundingClientRect(),t=a.width/s.width,r=a.height/s.height,l=(e.clientX-s.left)*t/X-V.x,o=(e.clientY-s.top)*r/X-V.y;console.log("Start drawing at:",{x:l,y:o,scaleX:t,scaleY:r,zoom:X}),E(!0),Z([{x:l,y:o}])},al=e=>{if(!A||"pen"!==O||"draw"!==ed)return;let a=f.current,s=a.getBoundingClientRect(),t=a.width/s.width,r=a.height/s.height,l=(e.clientX-s.left)*t/X-V.x,o=(e.clientY-s.top)*r/X-V.y;Z(e=>[...e,{x:l,y:o}])},ao=()=>{A&&U.length>3&&(G([...L,{id:Date.now(),type:"freehand",points:U,feather:eu[0],shadowBlur:ex[0],shadowOffset:eb[0]}]),ec(U),aa()),E(!1),Z([])},an=async e=>{en(!0);let a=f.current;if(!a)return;let s=a.getContext("2d");a.width=e.width,a.height=e.height,s.drawImage(e,0,0);try{let a=[{x:50,y:50},{x:e.width-50,y:50},{x:e.width-50,y:e.height-50},{x:50,y:e.height-50}],s=[];for(let e=0;e<a.length;e++){let t=a[e],r=a[(e+1)%a.length];s.push(t);let l=(t.x+r.x)/2,o=(t.y+r.y)/2;0===e?s.push({x:l,y:o-20}):1===e?s.push({x:l+20,y:o}):2===e?s.push({x:l,y:o+20}):s.push({x:l-20,y:o})}ec(s)}catch(a){console.error("Border detection failed:",a),ec([{x:50,y:50},{x:e.width-50,y:50},{x:e.width-50,y:e.height-50},{x:50,y:e.height-50}])}finally{en(!1)}},ai=()=>{"draw"===ed?ao():(E(!1),Z([]),eB(null))};(0,r.useEffect)(()=>{let e=f.current,a=b.current;if(!e||!a||!er)return;let s=e.getContext("2d"),t=a.getContext("2d"),r=z.current?z.current.clientWidth:800,l=z.current?z.current.clientHeight:600,o=Math.min(r/er.width,l/er.height,1),n=er.width*o,i=er.height*o;if(e.width=n,e.height=i,a.width=n,a.height=i,e.style.width=n+"px",e.style.height=i+"px",a.style.width=n+"px",a.style.height=i+"px",s.clearRect(0,0,e.width,e.height),t.clearRect(0,0,a.width,a.height),s.save(),t.save(),s.scale(X,X),t.scale(X,X),s.translate(V.x,V.y),t.translate(V.x,V.y),s.globalAlpha=$[0],eX?(console.log("Using processed transparent image as source of truth"),s.drawImage(eX,0,0,n,i)):er&&(console.log("Using original image (no processed image available)"),s.drawImage(er,0,0,n,i)),s.globalAlpha=1,J){t.strokeStyle="rgba(0, 0, 0, 0.1)",t.lineWidth=1;for(let a=0;a<e.width;a+=50)t.beginPath(),t.moveTo(a,0),t.lineTo(a,e.height),t.stroke();for(let a=0;a<e.height;a+=50)t.beginPath(),t.moveTo(0,a),t.lineTo(e.width,a),t.stroke()}let c="draw"===ed&&U.length>0?U:ei;c&&Array.isArray(c)&&c.length>0&&(ex[0]>0&&(t.shadowBlur=ex[0],t.shadowOffsetX=eb[0],t.shadowOffsetY=eb[0],t.shadowColor="rgba(0, 0, 0, 0.3)"),t.strokeStyle="draw"===ed?"#10b981":"#ef4444",t.lineWidth="draw"===ed?3:4,t.setLineDash("draw"===ed?[]:[5,5]),t.lineCap="round",t.lineJoin="round",t.beginPath(),c.forEach((e,a)=>{0===a?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)}),"draw"!==ed&&t.closePath(),t.stroke(),t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0,"edit"===ed&&ei&&Array.isArray(ei)&&(t.fillStyle="#ef4444",ei.forEach(e=>{t.beginPath(),t.arc(e.x,e.y,6,0,2*Math.PI),t.fill()}))),s.restore(),t.restore()},[er,ei,U,X,V,J,$,ed,ex,eb]);let ac=async()=>{console.log("Save button clicked"),console.log("Current mode:",ed),console.log("Current path length:",U.length),console.log("Detected border length:",ei.length),console.log("onBorderSave exists:",!!c);let e="draw"===ed&&U.length>3?U:ei;if(console.log("Final border length:",e.length),e.length>0)try{eC(!0),console.log("Task 6: Starting standardized pipeline: Chroma Key → Mask → Frame → PNG Export");let t=await e4(e);if(!t){console.error("Task 6: Pipeline failed - no export result");return}console.log("Task 6: Standardized pipeline completed successfully"),console.log("Task 6: Export result:",{dimensions:t.dimensions,format:t.format,hasAlpha:t.hasAlpha,fileSize:(t.blob.size/1024/1024).toFixed(2)+"MB"});let r=await e7(e,t),l={polygon_points:e,svg_path:ad(e),feather_radius:eu[0],inner_usable_area:ag(e),chroma_key_metadata:eP?{enabled:!0,mode:eF,key_color:"auto"===eF?eW:eI,tolerance:eA[0],edge_feather:eO[0],edge_smoothness:eU[0],spill_suppression:eL[0]}:null,processed_image_info:{originalSize:(t.blob.size/1024/1024).toFixed(2)+"MB",dimensions:t.dimensions,format:t.format,hasAlpha:t.hasAlpha,timestamp:new Date().toISOString(),processedImageUrl:t.url,processedBlob:t.blob},export_metadata:{pipeline:"chroma_key_mask_frame_png",quality:t.quality,transparency:"preserved",source:"processed_transparent_image"},comprehensive_metadata:r};if(p){console.log("Task 6: Saving to backend API");let e=(await s.e(6657).then(s.bind(s,6657))).default,{toast:a}=await s.e(7776).then(s.bind(s,27776));await e.put("/api/admin/theme-assets/borders/".concat(p,"/mask"),l),a.success("Border mask and processed image saved successfully!"),console.log("Task 6: Backend save completed")}c&&(console.log("Task 6: Calling onBorderSave with processed transparent image as primary source"),c({points:e,feather:eu[0],shadowBlur:ex[0],shadowOffset:eb[0],assetType:g,mode:ed,shapes:L,maskData:l,processedImage:t,processedImageUrl:t.url,processedBlob:t.blob,originalImage:er,originalImageUrl:a,source:"processed_transparent_image",hasTransparency:t.hasAlpha,pipeline:"chroma_key_mask_frame_png"}),console.log("Task 6: onBorderSave called with processed transparent image as source of truth")),eC(!1)}catch(e){console.error("Save failed:",e),setError("Failed to save border. Please try again."),eC(!1)}else console.log("Save conditions not met:",{hasBorder:e.length>0,hasCallback:!!c,borderLength:e.length})},ad=e=>{if(!e||0===e.length)return"";let a="M ".concat(e[0].x," ").concat(e[0].y);for(let s=1;s<e.length-1;s++){let t=e[s],r=e[s+1],l=(t.x+r.x)/2,o=(t.y+r.y)/2;a+=" Q ".concat(t.x," ").concat(t.y,", ").concat(l," ").concat(o)}if(e.length>2){let s=e[e.length-1],t=e[0];a+=" L ".concat(s.x," ").concat(s.y," L ").concat(t.x," ").concat(t.y)}return a+" Z"},am=e=>{let a=0,s=0,t=0;for(let r=0;r<e.length;r++){let l=e[r],o=e[(r+1)%e.length],n=l.x*o.y-o.x*l.y;t+=n,a+=(l.x+o.x)*n,s+=(l.y+o.y)*n}return Math.abs(t/=2)>1e-4?(a/=6*t,s/=6*t):(a=e.reduce((e,a)=>e+a.x,0)/e.length,s=e.reduce((e,a)=>e+a.y,0)/e.length),{x:a,y:s}},ag=e=>{if(!e||0===e.length)return{x:0,y:0,width:0,height:0};let a=e.map(e=>e.x),s=e.map(e=>e.y),t=Math.min(...a),r=Math.min(...s),l=eu[0];return{x:t+l,y:r+l,width:Math.max(...a)-t-2*l,height:Math.max(...s)-r-2*l}};return(0,t.jsxs)(l.Zb,{className:h,children:[(0,t.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(y.Z,{className:"w-5 h-5"}),"Border Editor - ",g.charAt(0).toUpperCase()+g.slice(1)]}),(0,t.jsx)(o.z,{onClick:d,variant:"ghost",size:"sm",children:(0,t.jsx)(m.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(o.z,{onClick:()=>em("detect"),variant:"detect"===ed?"default":"outline",size:"sm",children:[(0,t.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Auto Detect"]}),(0,t.jsxs)(o.z,{onClick:()=>em("draw"),variant:"draw"===ed?"default":"outline",size:"sm",children:[(0,t.jsx)(k.Z,{className:"w-4 h-4 mr-2"}),"Draw"]}),(0,t.jsxs)(o.z,{onClick:()=>em("edit"),variant:"edit"===ed?"default":"outline",size:"sm",children:[(0,t.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Edit"]})]}),(0,t.jsxs)(l.Zb,{className:"border-dashed",children:[(0,t.jsx)(l.Ol,{className:"pb-3",children:(0,t.jsxs)(l.ll,{className:"text-sm flex items-center gap-2",children:[(0,t.jsx)(w.Z,{className:"w-4 h-4"}),"Chroma Key Background Removal"]})}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:eP,onChange:e=>eR(e.target.checked),className:"mr-2 w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Enable Background Removal"})]}),eP&&(0,t.jsx)(n.C,{variant:"default",className:"text-xs",children:"Active"})]}),eP&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(o.z,{onClick:()=>ez("auto"),variant:"auto"===eF?"default":"outline",size:"sm",className:"text-xs",children:[(0,t.jsx)(j.Z,{className:"w-3 h-3 mr-1"}),"Auto Detect"]}),(0,t.jsxs)(o.z,{onClick:()=>ez("custom"),variant:"custom"===eF?"default":"outline",size:"sm",className:"text-xs",children:[(0,t.jsx)(w.Z,{className:"w-3 h-3 mr-1"}),"Custom Color"]})]}),"custom"===eF&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Key Color:"}),(0,t.jsx)("input",{type:"color",value:eI,onChange:e=>eM(e.target.value),className:"w-12 h-8 border rounded cursor-pointer"}),(0,t.jsx)("span",{className:"text-xs text-gray-600",children:eI})]}),"auto"===eF&&eW&&(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Detected:"}),(0,t.jsx)("div",{className:"w-12 h-8 border rounded",style:{backgroundColor:eW}}),(0,t.jsx)("span",{className:"text-xs text-gray-600",children:eW})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium mb-2 block",children:["Tolerance: ",eA[0],"%"]}),(0,t.jsx)(v.i,{value:eA,onValueChange:eE,max:100,min:0,step:1,className:"w-full"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium mb-2 block",children:["Edge Feather: ",eO[0],"px"]}),(0,t.jsx)(v.i,{value:eO,onValueChange:eD,max:10,min:0,step:.5,className:"w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium mb-2 block",children:["Edge Smoothness: ",eU[0],"%"]}),(0,t.jsx)(v.i,{value:eU,onValueChange:eZ,max:100,min:0,step:1,className:"w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium mb-2 block",children:["Spill Suppression: ",eL[0],"%"]}),(0,t.jsx)(v.i,{value:eL,onValueChange:eG,max:100,min:0,step:1,className:"w-full"})]})]}),(0,t.jsxs)(o.z,{onClick:()=>ae(),disabled:!er,size:"sm",className:"w-full",children:[(0,t.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),"Process Background Removal"]})]})]})]}),"draw"===ed&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.z,{onClick:()=>D("pen"),variant:"pen"===O?"default":"outline",size:"sm",children:(0,t.jsx)(k.Z,{className:"w-4 h-4"})}),(0,t.jsx)(o.z,{onClick:as,disabled:es<=0,variant:"outline",size:"sm",children:(0,t.jsx)(C.Z,{className:"w-4 h-4"})}),(0,t.jsx)(o.z,{onClick:at,disabled:es>=ee.length-1,variant:"outline",size:"sm",children:(0,t.jsx)(T.Z,{className:"w-4 h-4"})}),(0,t.jsx)(o.z,{onClick:()=>K(!J),variant:J?"default":"outline",size:"sm",children:(0,t.jsx)(S.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:["detect"===ed&&(0,t.jsxs)(o.z,{onClick:()=>{er&&(an(er),G([]),Z([]))},disabled:eo||!er,variant:"outline",size:"sm",children:[(0,t.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),eo?"Detecting...":"Redetect"]}),"draw"===ed&&(0,t.jsxs)(o.z,{onClick:()=>{Z([]),G([]),ec([]),aa()},variant:"outline",size:"sm",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Clear"]}),x&&(0,t.jsxs)(o.z,{onClick:()=>ej(!ew),variant:ew?"default":"outline",size:"sm",children:[(0,t.jsx)(_.Z,{className:"w-4 h-4 mr-2"}),ew?"Hide":"Show"," Preview"]}),(0,t.jsx)(o.z,{onClick:ac,disabled:eN||!p&&!c||"detect"===ed&&0===ei.length||"draw"===ed&&U.length<3,size:"sm",children:eN?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.Z,{className:"w-4 h-4 mr-2"}),"Save Border"]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.z,{onClick:()=>H(Math.max(.5,X-.25)),variant:"outline",size:"sm",children:(0,t.jsx)(P.Z,{className:"w-4 h-4"})}),(0,t.jsxs)("span",{className:"text-sm",children:[Math.round(100*X),"%"]}),(0,t.jsx)(o.z,{onClick:()=>H(Math.min(3,X+.25)),variant:"outline",size:"sm",children:(0,t.jsx)(R.Z,{className:"w-4 h-4"})})]}),(0,t.jsx)(o.z,{onClick:()=>{H(1),q({x:0,y:0})},variant:"outline",size:"sm",children:(0,t.jsx)(F.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Detection Sensitivity"}),(0,t.jsx)(v.i,{value:eg,onValueChange:eh,max:100,min:1,step:1,className:"w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Feather Radius"}),(0,t.jsx)(v.i,{value:eu,onValueChange:ep,max:20,min:0,step:1,className:"w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Shadow Blur"}),(0,t.jsx)(v.i,{value:ex,onValueChange:ef,max:50,min:0,step:1,className:"w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Shadow Offset"}),(0,t.jsx)(v.i,{value:eb,onValueChange:ev,max:20,min:0,step:1,className:"w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Template Opacity"}),(0,t.jsx)(v.i,{value:$,onValueChange:Q,max:1,min:.1,step:.1,className:"w-full"})]})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:["detect"===ed&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Redetect"})," to find borders automatically"]}),(0,t.jsxs)("p",{children:["• Switch to ",(0,t.jsx)("strong",{children:"Draw"})," mode to create custom borders"]})]}),"draw"===ed&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Click & Drag"})," to draw custom border shape"]}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Undo/Redo"})," to correct mistakes"]}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Grid"})," for precision drawing"]}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Natural freehand"})," - follows cursor path exactly"]})]}),"edit"===ed&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Move tool"})," to pan the canvas"]}),(0,t.jsxs)("p",{children:["• Switch to ",(0,t.jsx)("strong",{children:"Draw"})," mode to create new shapes"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.C,{variant:"detect"===ed?"default":"secondary",children:"detect"===ed?"Auto-Detect":"draw"===ed?"Drawing":"Editing"}),"draw"===ed&&U.length>0&&(0,t.jsxs)(n.C,{variant:"outline",children:[U.length," points"]}),J&&(0,t.jsx)(n.C,{variant:"outline",children:"Grid On"})]}),ew&&ey&&ei.length>0&&(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"text-sm flex items-center gap-2",children:[(0,t.jsx)(_.Z,{className:"w-4 h-4"}),"Real-time Mask Preview"]})}),(0,t.jsx)(l.aY,{children:(0,t.jsxs)("div",{className:"relative border rounded-lg overflow-hidden bg-gray-100",style:{maxWidth:"400px",maxHeight:"400px",margin:"0 auto"},children:[(0,t.jsx)("div",{style:{position:"relative",width:"100%",aspectRatio:"1",clipPath:ei.length>0?"polygon(".concat(ei.map(e=>"".concat(e.x,"px ").concat(e.y,"px")).join(", "),")"):"none"},children:(0,t.jsx)("img",{src:x,alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(".concat(eu[0],"px)")}})}),(0,t.jsxs)("div",{className:"absolute bottom-2 left-2 right-2 bg-black/60 text-white text-xs p-2 rounded",children:[(0,t.jsxs)("div",{children:["Feather: ",eu[0],"px"]}),(0,t.jsxs)("div",{children:["Points: ",ei.length]})]})]})})]}),eP&&eX&&(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"text-sm flex items-center gap-2",children:[(0,t.jsx)(w.Z,{className:"w-4 h-4"}),"Chroma Key Preview - Background Removed"]})}),(0,t.jsxs)(l.aY,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-red-700 mb-2",children:"Original"}),(0,t.jsx)("div",{className:"relative border rounded-lg overflow-hidden bg-gray-100",style:{maxHeight:"200px"},children:(0,t.jsx)("img",{src:a,alt:"Original",className:"w-full h-full object-contain",style:{maxHeight:"200px"}})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-green-700 mb-2",children:"Processed (Transparent)"}),(0,t.jsx)("div",{className:"relative border rounded-lg overflow-hidden",style:{maxHeight:"200px",backgroundImage:"repeating-conic-gradient(#e5e7eb 0% 25%, transparent 0% 50%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"},children:(0,t.jsx)("img",{src:eX.src,alt:"Processed",className:"w-full h-full object-contain",style:{maxHeight:"200px"}})})]})]}),(0,t.jsx)("div",{className:"mt-3 p-2 bg-gray-50 rounded text-xs",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Mode:"})," ",eF]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Tolerance:"})," ",eA[0],"%"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Feather:"})," ",eO[0],"px"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Key Color:"}),(0,t.jsx)("span",{className:"inline-block w-3 h-3 ml-1 border border-gray-300 rounded",style:{backgroundColor:"auto"===eF?eW:eI}})]})]})})]})]}),(0,t.jsxs)("div",{ref:z,className:"border rounded-lg overflow-auto bg-gray-50 max-h-96 relative",style:{minHeight:"400px",minWidth:"600px"},children:[!er&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-lg mb-2",children:"No image loaded"}),(0,t.jsx)("div",{className:"text-sm",children:"Please upload an image to edit borders"})]})}),(0,t.jsx)("canvas",{ref:f,className:"relative",style:{maxWidth:"100%",height:"auto",display:er?"block":"none",cursor:"draw"===ed&&"pen"===O?"crosshair":"edit"===ed?"move":"default"},onMouseDown:e=>{if("draw"===ed)ar(e);else if("edit"===ed){let a=f.current,s=a.getBoundingClientRect(),t=a.width/s.width,r=a.height/s.height,l=(e.clientX-s.left)*t/X-V.x,o=(e.clientY-s.top)*r/X-V.y;if(ei&&Array.isArray(ei)){let e=ei.findIndex(e=>10>Math.sqrt(Math.pow(e.x-l,2)+Math.pow(e.y-o,2)));if(-1!==e){eB(e),E(!0);return}}"move"===O&&(E(!0),Z([{x:e.clientX-V.x*X,y:e.clientY-V.y*X}]))}},onMouseMove:e=>{if("draw"===ed)al(e);else if("edit"===ed&&A){let a=f.current,s=a.getBoundingClientRect(),t=a.width/s.width,r=a.height/s.height,l=(e.clientX-s.left)*t/X-V.x,o=(e.clientY-s.top)*r/X-V.y;if(null!==e_){let e=[...ei];e[e_]={x:l,y:o},ec(e)}else"move"===O&&q({x:(e.clientX-U[0].x)/X,y:(e.clientY-U[0].y)/X})}},onMouseUp:ai,onMouseLeave:ai}),(0,t.jsx)("canvas",{ref:b,className:"absolute top-0 left-0 pointer-events-none",style:{maxWidth:"100%",height:"auto",display:er?"block":"none"}})]})]})]})}let I=s(20357).env.NEXT_PUBLIC_API_URL||"http://localhost:8001";function M(){let e=(0,f.useRouter)(),[a,s]=(0,r.useState)(!0),[v,y]=(0,r.useState)(!1),[k,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[C,T]=(0,r.useState)([]),[S,_]=(0,r.useState)("all"),[B,P]=(0,r.useState)(null),[R,F]=(0,r.useState)(null),[M,A]=(0,r.useState)(""),[E,O]=(0,r.useState)(""),[D,U]=(0,r.useState)(!0),[Z,L]=(0,r.useState)("border"),[G,W]=(0,r.useState)(!1),[Y,X]=(0,r.useState)(!1),[H,V]=(0,r.useState)(null),[q,J]=(0,r.useState)(0),[K,$]=(0,r.useState)(null),[Q,ee]=(0,r.useState)(!1),[ea,es]=(0,r.useState)(!1),[et,er]=(0,r.useState)(null),[el,eo]=(0,r.useState)(null),[en,ei]=(0,r.useState)(null);(0,r.useEffect)(()=>{ec(),ed()},[]);let ec=async()=>{let a=localStorage.getItem("token");if(!a){e.push("/login");return}try{let s=await b.Z.get("".concat(I,"/api/auth/me"),{headers:{Authorization:"Bearer ".concat(a)}});"admin"!==s.data.role&&(w("Access denied. Admin privileges required."),setTimeout(()=>e.push("/admin"),2e3))}catch(a){console.error("Auth check failed:",a),e.push("/login")}},ed=async()=>{let e=localStorage.getItem("token");if(e)try{s(!0);let a=await b.Z.get("".concat(I,"/api/admin/borders"),{headers:{Authorization:"Bearer ".concat(e)}});console.log("[ADMIN_BORDERS] API Response:",{totalBorders:a.data.length,borders:a.data.map(e=>({name:e.name,category:e.category}))});let t={all:a.data.length,border:a.data.filter(e=>"border"===(e.category||"border")).length,background:a.data.filter(e=>"background"===(e.category||"border")).length};console.log("[ADMIN_BORDERS] Category counts:",t),T(a.data)}catch(e){console.error("Error loading borders:",e),w("Failed to load borders")}finally{s(!1)}},em=async e=>{let a=e.target.files[0];if(!a)return;if(V(null),J(0),$(null),w(null),N(null),a.size>10485760){w("File size exceeds 10MB limit");return}if(!a.type.startsWith("image/")){w("Only image files are allowed");return}P(a);let s=new FileReader;s.onload=async e=>{let a=e.target.result;F(a),er(a),ee(!0);try{let e=await ep(a);$(e),"needs_removal"===e.recommendation?(W(!0),N("Black background detected! Background removal has been enabled automatically."),setTimeout(()=>{ef()},100)):"excellent"===e.recommendation&&N("Perfect! This image already has good transparency.")}catch(e){console.error("Transparency check failed:",e)}finally{ee(!1)}},s.readAsDataURL(a)},eg=async e=>{console.log("Border data received from editor:",e),eo(e.maskData),es(!1),N('Mask defined! Now click "Upload Border" to save.')},eh=async e=>new Promise((a,s)=>{console.log("[Background Removal] Starting ultra-fast processing");let t=performance.now(),r=new Image;r.onload=()=>{let e=r.width,l=r.height;if(e>1e3||l>1e3){let a=Math.min(1e3/e,1e3/l);e*=a,l*=a}let o=document.createElement("canvas"),n=o.getContext("2d");o.width=e,o.height=l,n.drawImage(r,0,0,e,l);let i=n.getImageData(0,0,e,l),c=i.data,d=0;for(let e=0;e<c.length;e+=4){let a=c[e],s=c[e+1],t=c[e+2];a<20&&s<20&&t<20&&(c[e+3]=0,d++)}n.putImageData(i,0,0);let m=performance.now()-t;console.log("[Background Removal] Ultra-fast processing completed in ".concat(m.toFixed(2),"ms - ").concat(d," pixels removed")),o.toBlob(e=>{e?a(e):s(Error("Failed to create PNG blob"))},"image/png",1)},r.onerror=s,r.src=URL.createObjectURL(e)}),eu=(e,a,s,t,r)=>{let l=(s*t+a)*4,o=(e[l]+e[l+1]+e[l+2])/3;for(let l=-2;l<=2;l++)for(let n=-2;n<=2;n++){if(0===l&&0===n)continue;let i=a+l,c=s+n;if(i>=0&&i<t&&c>=0&&c<r){let a=(c*t+i)*4;if(Math.abs(o-(e[a]+e[a+1]+e[a+2])/3)>60)return!0}}return!1},ep=async e=>new Promise(a=>{let s=new Image;s.crossOrigin="anonymous",s.onload=()=>{let e=document.createElement("canvas"),t=e.getContext("2d");e.width=s.width,e.height=s.height,t.drawImage(s,0,0);let r=t.getImageData(0,0,e.width,e.height).data,l=0,o=0,n=0,i=0;for(let a=0;a<r.length;a+=4){let s=r[a],t=r[a+1],c=r[a+2],d=r[a+3];if(n++,d<255&&l++,s<=30&&t<=30&&c<=30){o++;let s=a/4;eu(r,s%e.width,Math.floor(s/e.width),e.width,e.height)&&i++}}let c=l/n*100,d=(o-i)/n*100,m={hasTransparency:c>1,transparencyPercentage:c.toFixed(2),blackBackgroundPercentage:d.toFixed(2),totalPixels:n,transparentPixels:l,blackPixels:o,edgePixels:i,recommendation:ex(c,d)};console.log("[Transparency Check] Result:",m),a(m)},s.onerror=()=>{a({hasTransparency:!1,error:"Failed to load image for transparency check",recommendation:"error"})},s.src=e}),ex=(e,a)=>e>5?"excellent":e>1?"good":a>10?"needs_removal":a>1?"check_manually":"unknown",ef=async()=>{if(!B){console.warn("[Background Removal] No file selected");return}X(!0),J(50);try{console.log("[Background Removal] Starting instant processing for:",B.name);let e=await eh(B);J(90);let a=new FileReader;a.onload=a=>{V(a.target.result),J(100),X(!1);let s=(e.size/1024/1024).toFixed(2);console.log("[Background Removal] Completed instantly. File size: ".concat(s,"MB")),N("Background removed instantly! Processed file size: ".concat(s,"MB"))},a.readAsDataURL(e)}catch(e){console.error("Background removal failed:",e),w("Failed to remove background. Please try again."),X(!1),J(0)}},eb=()=>(console.log("[TRANSPARENT BORDER FIX] Auto-creating default rectangular mask for background-removed border"),{svg_path:"",polygon_points:[],feather_radius:8,inner_usable_area:{x:0,y:0,width:0,height:0},processedImage:null}),ev=async()=>{var e,a,s,t,r,l;if(!B){w("Please select an image file");return}if(!M.trim()){w("Please enter a border name");return}console.log("[BORDER_UPLOAD] Category selected:",Z),console.log("[BORDER_UPLOAD] Border name:",M),console.log("[BORDER_UPLOAD] Full upload details:",{name:M,category:Z,tags:E,supportsMirror:D,hasTransparency:G||null!==H});let o=el;if(!el&&(G||H)&&(console.log("[TRANSPARENT BORDER FIX] No mask defined, but background removal was done"),console.log("[TRANSPARENT BORDER FIX] Creating default mask to allow transparent border upload"),eo(o=eb())),!o){w("Please define mask using Border Editor or enable background removal");return}let n=localStorage.getItem("token"),i=new FormData,c=B,d=B.name.split(".").pop().toLowerCase(),m=d;if(o&&o.processedImage&&o.processedImage.blob)try{console.log("[Upload] Using processed transparent image from BorderEditor");let e=el.processedImage.blob;d="png",c=new File([e],B.name.replace(/\.[^/.]+$/,".png"),{type:"image/png"}),console.log("[Upload] PNG-32 format enforced with BorderEditor processed image:",{originalFormat:m,newFormat:"png",fileSize:(c.size/1024/1024).toFixed(2)+"MB",hasTransparency:!0,source:"BorderEditor processed image"})}catch(e){console.error("[Upload] Failed to use BorderEditor processed image:",e),w("Failed to use processed transparent image. Please try again.");return}else if(H)try{console.log("[Upload] Using processed image from old system - enforcing PNG-32 format");let e=await fetch(H),a=await e.blob();d="png",c=new File([a],B.name.replace(/\.[^/.]+$/,".png"),{type:"image/png"}),console.log("[Upload] PNG-32 format enforced (old system):",{originalFormat:m,newFormat:"png",fileSize:(c.size/1024/1024).toFixed(2)+"MB",hasTransparency:!0})}catch(e){console.error("[Upload] Failed to process image for PNG-32 conversion:",e),w("Failed to convert image to PNG-32 format. Please try again.");return}else if(G){console.log("[Upload] Background removal requested but no processed image - converting to PNG-32");let e=document.createElement("canvas"),a=e.getContext("2d"),s=new Image;await new Promise(t=>{s.onload=()=>{e.width=s.width,e.height=s.height,a.drawImage(s,0,0),e.toBlob(e=>{c=new File([e],B.name.replace(/\.[^/.]+$/,".png"),{type:"image/png"}),d="png",console.log("[Upload] PNG-32 conversion complete with full alpha channel"),t()},"image/png",1)},s.src=URL.createObjectURL(B)})}i.append("file",c),i.append("name",M),i.append("tags",E),i.append("supports_mirror",D),i.append("category",Z),console.log("[UPLOAD] FormData category being sent:",Z),console.log("[UPLOAD] FormData entries:",{name:M,category:Z,tags:E,supports_mirror:D});let g=G||null!==H||o&&o.processedImage;i.append("has_transparency",g.toString()),i.append("remove_background",G.toString()),console.log("[Upload] Transparency metadata:",{hasTransparency:g,removeBackground:G,processedPreview:!!H,maskDataProcessed:!!(o&&o.processedImage)}),o.svg_path&&i.append("mask_svg_path",o.svg_path),o.polygon_points&&o.polygon_points.length>0&&i.append("mask_polygon_points",JSON.stringify(o.polygon_points)),i.append("feather_radius",o.feather_radius||8),i.append("mask_x",(null===(e=o.inner_usable_area)||void 0===e?void 0:e.x)||0),i.append("mask_y",(null===(a=o.inner_usable_area)||void 0===a?void 0:a.y)||0),i.append("mask_width",(null===(s=o.inner_usable_area)||void 0===s?void 0:s.width)||0),i.append("mask_height",(null===(t=o.inner_usable_area)||void 0===t?void 0:t.height)||0);try{y(!0),w(null);let e=await b.Z.post("".concat(I,"/api/admin/borders/upload"),i,{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"multipart/form-data"}});N("Border uploaded successfully!"),console.log("[UPLOAD_SUCCESS] Border uploaded with details:",{id:e.data.id,name:e.data.name,category:e.data.category,expected_category:Z}),e.data.category!==Z&&console.error("[UPLOAD_WARNING] Category mismatch!",{selected:Z,saved:e.data.category}),T([e.data,...C]),P(null),F(null),A(""),O(""),U(!0),L("border"),eo(null),er(null),document.getElementById("border-file-input").value="",ed(),setTimeout(()=>N(null),3e3)}catch(e){console.error("Border upload failed:",e),w((null===(l=e.response)||void 0===l?void 0:null===(r=l.data)||void 0===r?void 0:r.detail)||"Failed to upload border")}finally{y(!1)}},ey=async e=>{ei(e),er(e.cdn_url),es(!0)},ek=async e=>{var a,s,t,r,l,o;if(!en)return;let n=localStorage.getItem("token"),i=new FormData,c=e.maskData;c.svg_path&&i.append("mask_svg_path",c.svg_path),c.polygon_points&&c.polygon_points.length>0&&i.append("mask_polygon_points",JSON.stringify(c.polygon_points)),i.append("feather_radius",c.feather_radius||8),i.append("mask_x",(null===(a=c.inner_usable_area)||void 0===a?void 0:a.x)||0),i.append("mask_y",(null===(s=c.inner_usable_area)||void 0===s?void 0:s.y)||0),i.append("mask_width",(null===(t=c.inner_usable_area)||void 0===t?void 0:t.width)||0),i.append("mask_height",(null===(r=c.inner_usable_area)||void 0===r?void 0:r.height)||0);try{y(!0);let e=await b.Z.put("".concat(I,"/api/admin/borders/").concat(en.id,"/mask"),i,{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"multipart/form-data"}});N("Border mask updated successfully!"),T(C.map(a=>a.id===en.id?e.data:a)),es(!1),ei(null),setTimeout(()=>N(null),3e3)}catch(e){console.error("Mask update failed:",e),w((null===(o=e.response)||void 0===o?void 0:null===(l=o.data)||void 0===l?void 0:l.detail)||"Failed to update mask")}finally{y(!1)}},ew=async e=>{if(!confirm("Are you sure you want to delete this border?"))return;let a=localStorage.getItem("token");try{await b.Z.delete("".concat(I,"/api/admin/borders/").concat(e),{headers:{Authorization:"Bearer ".concat(a)}}),T(C.filter(a=>a.id!==e)),N("Border deleted successfully"),setTimeout(()=>N(null),3e3)}catch(e){console.error("Delete failed:",e),w("Failed to delete border")}};return a?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(i.Z,{className:"w-12 h-12 text-rose-500 animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading borders..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)(o.z,{variant:"ghost",onClick:()=>e.push("/admin"),className:"mb-2",children:[(0,t.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"Back to Admin Dashboard"]}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Border Management"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Upload and manage photo borders with custom masks"})]})}),k&&(0,t.jsxs)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[(0,t.jsx)(d.Z,{className:"w-5 h-5 mr-2"}),k,(0,t.jsx)("button",{onClick:()=>w(null),className:"ml-auto",children:(0,t.jsx)(m.Z,{className:"w-4 h-4"})})]}),j&&(0,t.jsxs)("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center",children:[(0,t.jsx)(g.Z,{className:"w-5 h-5 mr-2"}),j,(0,t.jsx)("button",{onClick:()=>N(null),className:"ml-auto",children:(0,t.jsx)(m.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)(l.Zb,{className:"p-6 mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,t.jsx)(h.Z,{className:"w-5 h-5 mr-2 text-rose-500"}),"Upload New Border with Mask"]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Border Image (Max 10MB)"}),(0,t.jsx)("input",{id:"border-file-input",type:"file",accept:"image/*",onChange:em,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-rose-50 file:text-rose-700 hover:file:bg-rose-100"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:G,onChange:e=>{let a=e.target.checked;W(a),a&&B&&setTimeout(()=>{ef()},100)},className:"mr-2"}),(0,t.jsx)("span",{className:"text-sm",children:"Remove Background"})]}),B&&!G&&(0,t.jsx)("button",{onClick:()=>{W(!0),setTimeout(()=>{em({target:{files:[B]}})},100)},className:"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600 transition-colors",children:"Remove Background Now"})]}),Y&&(0,t.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-blue-900",children:"Processing background removal..."}),(0,t.jsxs)("span",{className:"text-sm text-blue-700",children:[q,"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(q,"%")}})})]}),R&&(0,t.jsx)("div",{className:"space-y-4",children:H?(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Original"}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("img",{src:R,alt:"Original",className:"w-full h-48 object-contain rounded-lg border-2 border-gray-200 bg-white"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-green-700 mb-2",children:"Processed (Transparent)"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-full h-48 rounded-lg border-2 border-green-200 overflow-hidden",style:{backgroundImage:"repeating-conic-gradient(#e5e7eb 0% 25%, transparent 0% 50%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"},children:(0,t.jsx)("img",{src:H,alt:"Processed",className:"w-full h-full object-contain"})}),(0,t.jsx)("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded",children:"Background Removed"})]})]})]}):(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-red-700 mb-2",children:"Original"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:R,alt:"Original",className:"w-full h-48 object-contain rounded-lg border-2 border-red-200 bg-white"}),(0,t.jsx)("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"Original Image"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-green-700 mb-2",children:"Processed (Transparent)"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-full h-48 rounded-lg border-2 border-green-200 overflow-hidden",style:{backgroundImage:"repeating-conic-gradient(#e5e7eb 0% 25%, transparent 0% 50%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"},children:el&&el.processedImage&&el.processedImage.url?(0,t.jsx)("img",{src:el.processedImage.url,alt:"Processed Transparent",className:"w-full h-full object-contain"}):H?(0,t.jsx)("img",{src:H,alt:"Processed",className:"w-full h-full object-contain"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:Y?(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-xs",children:"Processing..."})]}):(0,t.jsx)("p",{className:"text-xs",children:'Click "Remove Background" to process'})})}),(0,t.jsx)("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded",children:H?"Background Removed":"Waiting"})]})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Border Name *"}),(0,t.jsx)("input",{type:"text",value:M,onChange:e=>A(e.target.value),placeholder:"Floral Wedding Border",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Border Category *"}),(0,t.jsxs)("select",{value:Z,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500",children:[(0,t.jsx)("option",{value:"border",children:"Border"}),(0,t.jsx)("option",{value:"background",children:"Background"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"border"===Z?"✓ For: Bride/Groom photos (mirror effect), Couple, Studio, Precious Moments, Live stream background":"✓ For: Theme background, Live streaming page background"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (comma-separated)"}),(0,t.jsx)("input",{type:"text",value:E,onChange:e=>O(e.target.value),placeholder:"floral, elegant, traditional",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"supports-mirror",checked:D,onChange:e=>U(e.target.checked),className:"w-4 h-4 text-rose-600 border-gray-300 rounded focus:ring-rose-500"}),(0,t.jsx)("label",{htmlFor:"supports-mirror",className:"ml-2 text-sm font-medium text-gray-700",children:"Supports Mirror (for Bride/Groom separate mode)"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,t.jsxs)(o.z,{onClick:()=>{if(!B){w("Please select an image first");return}es(!0)},disabled:!B,variant:"outline",className:"flex items-center",children:[(0,t.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),el?"Edit Mask":"Define Mask"]}),B&&(0,t.jsx)(o.z,{onClick:()=>{G?(W(!1),V(null)):(W(!0),setTimeout(()=>{ef()},100))},variant:G?"default":"outline",className:"flex items-center ".concat(G?"bg-green-600 hover:bg-green-700":""),children:G?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Z,{className:"w-4 h-4 mr-2"}),"Background Removed"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Remove Background"]})}),el&&(0,t.jsxs)(n.C,{variant:"default",className:"flex items-center gap-1",children:[(0,t.jsx)(g.Z,{className:"w-3 h-3"}),"Mask Defined"]})]}),(0,t.jsx)(o.z,{onClick:ev,disabled:v||!B||!M,className:"w-full",children:v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Upload Border"]})})]})]}),(0,t.jsxs)(l.Zb,{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 flex items-center justify-between",children:(0,t.jsxs)("span",{children:["Uploaded Borders (",C.length,")"]})}),(0,t.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"All Borders"},{key:"border",label:"Border"},{key:"background",label:"Background"}].map(e=>{let a="all"===e.key?C.length:C.filter(a=>(a.category||"border")===e.key).length;return(0,t.jsxs)("button",{onClick:()=>_(e.key),className:"px-4 py-2 font-medium text-sm rounded-t-lg transition-colors ".concat(S===e.key?"bg-rose-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),"data-testid":"filter-".concat(e.key),children:[e.label," (",a,")"]},e.key)})})}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.filter(e=>{let a=e.category||"border";return"all"===S||a===S}).map(e=>{var a,s,r,l,i;return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:e.processed_image_url||e.cdn_url,alt:e.name,className:"w-full h-48 object-cover",style:{backgroundImage:e.processed_image_url?"repeating-conic-gradient(#f0f0f0 0% 25%, #ffffff 0% 50%) 50% / 20px 20px":"none"}}),(0,t.jsxs)("div",{className:"absolute top-2 right-2 flex gap-2",children:[(0,t.jsx)(o.z,{size:"sm",variant:"secondary",onClick:()=>ey(e),className:"bg-white/90 hover:bg-white",children:(0,t.jsx)(u.Z,{className:"w-3 h-3"})}),(0,t.jsx)(o.z,{size:"sm",variant:"destructive",onClick:()=>ew(e.id),className:"bg-red-500/90 hover:bg-red-600",children:(0,t.jsx)(x.Z,{className:"w-3 h-3"})})]})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg truncate",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[(0,t.jsx)("span",{children:e.orientation}),(0,t.jsxs)("span",{children:[e.width,"x",e.height]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,t.jsx)(n.C,{variant:"outline",className:"text-xs",children:(null===(a=e.mask)||void 0===a?void 0:a.suggested_aspect_ratio)||"1:1"}),e.supports_mirror&&(0,t.jsx)(n.C,{variant:"secondary",className:"text-xs",children:"Mirror Support"})]}),e.category&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(n.C,{variant:"default",className:"text-xs ".concat("border"===e.category?"bg-purple-500":"bg-green-500"),children:"border"===e.category?"Border":"Background"})}),e.tags&&e.tags.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.map((e,a)=>(0,t.jsx)(n.C,{variant:"secondary",className:"text-xs",children:e},a))}),(0,t.jsxs)("div",{className:"mt-3 text-xs text-gray-500",children:[(0,t.jsxs)("div",{children:["Feather: ",(null===(s=e.mask)||void 0===s?void 0:s.feather_radius)||8,"px"]}),(null===(r=e.mask)||void 0===r?void 0:r.svg_path)&&(0,t.jsx)("div",{className:"text-green-600",children:"✓ SVG Mask"}),(null===(i=e.mask)||void 0===i?void 0:null===(l=i.polygon_points)||void 0===l?void 0:l.length)>0&&(0,t.jsxs)("div",{className:"text-blue-600",children:["✓ Polygon Mask (",e.mask.polygon_points.length," points)"]}),e.mask_slots&&e.mask_slots.length>0&&(0,t.jsxs)("div",{className:"text-purple-600 font-semibold",children:["✓ ",e.mask_slots.length," Photo Slots"]})]})]})]},e.id)})}),0===C.filter(e=>{let a=e.category||"border";return"all"===S||a===S}).length&&(0,t.jsx)("p",{className:"text-center text-gray-500 py-8 col-span-3",children:"all"===S?"No borders uploaded yet":'No borders in "'.concat(S,'" category')})]}),ea&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-auto",children:(0,t.jsx)(z,{imageUrl:et,onBorderSave:en?ek:eg,onClose:()=>{es(!1),en||er(null),ei(null)},assetType:"border",className:"m-4"})})})]})})}},79004:function(e,a,s){"use strict";s.d(a,{C:function(){return n}});var t=s(57437);s(2265);var r=s(13027),l=s(77700);let o=(0,r.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:a,variant:s,...r}=e;return(0,t.jsx)("div",{className:(0,l.cn)(o({variant:s}),a),...r})}},56360:function(e,a,s){"use strict";s.d(a,{z:function(){return c}});var t=s(57437),r=s(2265),l=s(71538),o=s(13027),n=s(77700);let i=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,a)=>{let{className:s,variant:r,size:o,asChild:c=!1,...d}=e,m=c?l.g7:"button";return(0,t.jsx)(m,{className:(0,n.cn)(i({variant:r,size:o,className:s})),ref:a,...d})});c.displayName="Button"},10273:function(e,a,s){"use strict";s.d(a,{Ol:function(){return n},SZ:function(){return c},Zb:function(){return o},aY:function(){return d},eW:function(){return m},ll:function(){return i}});var t=s(57437),r=s(2265),l=s(77700);let o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});o.displayName="Card";let n=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});n.displayName="CardHeader";let i=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("font-semibold leading-none tracking-tight",s),...r})});i.displayName="CardTitle";let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent";let m=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})});m.displayName="CardFooter"},85398:function(e,a,s){"use strict";s.d(a,{i:function(){return n}});var t=s(57437),r=s(2265),l=s(67553),o=s(77700);let n=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsxs)(l.fC,{ref:a,className:(0,o.cn)("relative flex w-full touch-none select-none items-center",s),...r,children:[(0,t.jsx)(l.fQ,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:(0,t.jsx)(l.e6,{className:"absolute h-full bg-primary"})}),(0,t.jsx)(l.bU,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]})});n.displayName=l.fC.displayName},77700:function(e,a,s){"use strict";s.d(a,{cn:function(){return l}});var t=s(44839),r=s(96164);function l(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,r.m6)((0,t.W)(a))}}},function(e){e.O(0,[9767,4868,4287,7553,2494,2971,7023,1744],function(){return e(e.s=75337)}),_N_E=e.O()}]);