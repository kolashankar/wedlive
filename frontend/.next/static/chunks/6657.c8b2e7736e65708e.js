"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6657],{6657:function(e,o,r){r.r(o);var t=r(38472),n=r(78614);(0,n.ww)(),console.log("API Base URL:",(0,n.bR)());let s=t.Z.create({baseURL:(0,n.bR)(),headers:{"Content-Type":"application/json"},timeout:n.ZP.API.TIMEOUT});s.interceptors.request.use(e=>{let o=localStorage.getItem("token");return o&&(e.headers.Authorization="Bearer ".concat(o)),e}),s.interceptors.response.use(e=>e,async e=>{var o,r,t,i,a,l,u;let d=e.config;if(console.error("API Error:",e),"ECONNABORTED"===e.code||"Network Error"===e.message){if(d.__retryCount||(d.__retryCount=0),d.__retryCount<n.ZP.API.RETRY_ATTEMPTS)return d.__retryCount+=1,console.warn("Retrying request (".concat(d.__retryCount,"/").concat(n.ZP.API.RETRY_ATTEMPTS,")...")),await new Promise(e=>setTimeout(e,n.ZP.API.RETRY_DELAY*d.__retryCount)),s(d);console.error("Request timeout after retries - API might be down")}if((null===(o=e.response)||void 0===o?void 0:o.status)===401&&(console.error("❌ Authentication failed - token expired or invalid"),localStorage.removeItem("token"),localStorage.removeItem("user"),void 0!==window.toast&&(null===(i=window.toast)||void 0===i||i.error("Your session has expired. Please log in again.")),window.location.href="/login?expired=true"),(null===(r=e.response)||void 0===r?void 0:r.status)===403){console.error("❌ Access forbidden - you may not have permission or your session expired");let o=(null===(l=e.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.detail)||"";(o.toLowerCase().includes("not authorized")||o.toLowerCase().includes("permission"))&&(console.warn("⚠️ Token may be expired - redirecting to login"),localStorage.removeItem("token"),localStorage.removeItem("user"),void 0!==window.toast&&(null===(u=window.toast)||void 0===u||u.error("Your session has expired. Please log in again.")),window.location.href="/login?expired=true")}return(null===(t=e.response)||void 0===t?void 0:t.status)===404&&console.error("Resource not found - check API endpoint"),Promise.reject(e)}),o.default=s}}]);