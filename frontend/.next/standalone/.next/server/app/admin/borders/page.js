(()=>{var e={};e.id=2858,e.ids=[2858],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},77257:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>d}),t(225),t(73603),t(35866);var s=t(23191),r=t(88716),l=t(37922),o=t.n(l),n=t(95231),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);t.d(a,i);let d=["",{children:["admin",{children:["borders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,225)),"/app/frontend/app/admin/borders/page.js"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,73603)),"/app/frontend/app/layout.js"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/app/frontend/app/admin/borders/page.js"],m="/admin/borders/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/borders/page",pathname:"/admin/borders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},19020:(e,a,t)=>{Promise.resolve().then(t.bind(t,82374))},82374:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>E});var s=t(10326),r=t(17577),l=t(50560),o=t(18729),n=t(20835),i=t(77506),d=t(86333),c=t(41291),m=t(94019),u=t(32933),h=t(63685),g=t(62881);let p=(0,g.Z)("pen-line",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),x=(0,g.Z)("scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);var f=t(98091),y=t(35047),b=t(94464),k=t(64745);let v=(0,g.Z)("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);var j=t(85206);let w=(0,g.Z)("droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]),N=(0,g.Z)("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);var S=t(88378);let C=(0,g.Z)("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),T=(0,g.Z)("redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]),_=(0,g.Z)("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);var P=t(12714),M=t(31215);let B=(0,g.Z)("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var R=t(7937),z=t(99598);function F({imageUrl:e,onBorderSave:a,onClose:d,assetType:c="border",className:u="",borderId:h=null,previewPhotoUrl:g=null}){let x=(0,r.useRef)(null),f=(0,r.useRef)(null),y=(0,r.useRef)(null),b=(0,r.useRef)(null),F=(0,r.useRef)(null),[I,E]=(0,r.useState)(!1),[Z,A]=(0,r.useState)("pen"),[D,O]=(0,r.useState)([]),[$,U]=(0,r.useState)([]),[q,L]=(0,r.useState)(null),[G,H]=(0,r.useState)(1),[V,W]=(0,r.useState)({x:0,y:0}),[Y,X]=(0,r.useState)(!0),[J,K]=(0,r.useState)([.7]),[Q,ee]=(0,r.useState)([]),[ea,et]=(0,r.useState)(-1),[es,er]=(0,r.useState)(null),[el,eo]=(0,r.useState)(!1),[en,ei]=(0,r.useState)([]),[ed,ec]=(0,r.useState)("detect"),[em,eu]=(0,r.useState)([50]),[eh,eg]=(0,r.useState)([5]),[ep,ex]=(0,r.useState)([10]),[ef,ey]=(0,r.useState)([5]),[eb,ek]=(0,r.useState)(null),[ev,ej]=(0,r.useState)(!1),[ew,eN]=(0,r.useState)(!1),[eS,eC]=(0,r.useState)([]),[eT,e_]=(0,r.useState)(null),[eP,eM]=(0,r.useState)(!0),[eB,eR]=(0,r.useState)("auto"),[ez,eF]=(0,r.useState)("#00ff00"),[eI,eE]=(0,r.useState)([50]),[eZ,eA]=(0,r.useState)([2]),[eD,eO]=(0,r.useState)([50]),[e$,eU]=(0,r.useState)([20]),[eq,eL]=(0,r.useState)(null),[eG,eH]=(0,r.useState)(null),[eV,eW]=(0,r.useState)(null);(0,r.useCallback)(e=>{console.log("Task 1: Initializing finalCanvas - Standardized Pipeline");let a=document.createElement("canvas");a.width=e.width,a.height=e.height;let t=a.getContext("2d");return b.current=a,F.current=t,console.log("Task 1: finalCanvas initialized with dimensions:",e.width,"x",e.height),console.log("Task 1: Standardized pipeline ready for composition"),a},[]);let eY=(0,r.useCallback)(async({transparentImage:e,maskPath:a,borderOverlay:t})=>{console.log("Task 1: Starting standardized pipeline composition");let s=b.current,r=F.current;if(!s||!r)return console.error("Task 1: finalCanvas not initialized"),null;if(r.clearRect(0,0,s.width,s.height),a&&a.length>0){console.log("Task 3: Applying mask clipping BEFORE drawing transparent image");let t=eX(a);t?(eJ(r,t),e&&(console.log("Task 3: Drawing transparent image WITHIN mask bounds"),r.drawImage(e,0,0)),eK(r)):e&&(console.log("Task 3: Mask creation failed, drawing transparent image without clipping"),r.drawImage(e,0,0))}else e&&(console.log("Task 3: No mask path available, drawing transparent image without clipping"),r.drawImage(e,0,0));return t?(console.log("Task 4: Overlaying floral frame as non-masked layer"),r.drawImage(t,0,0),console.log("Task 4: Floral frame overlay completed"),console.log("Task 4: Frame is visible outside mask, center remains transparent")):console.log("Task 4: No floral frame overlay provided"),console.log("Task 1: Pipeline composition completed"),s},[]),eX=(0,r.useCallback)(e=>{if(console.log("Task 2: Converting drawn border to Canvas Path2D mask"),!e||e.length<3)return console.error("Task 2: Insufficient points for mask path"),null;let a=new Path2D;a.moveTo(e[0].x,e[0].y);for(let t=1;t<e.length;t++)a.lineTo(e[t].x,e[t].y);return a.closePath(),console.log("Task 2: Mask path created with",e.length,"points"),console.log("Task 2: Path is closed and ready for clipping"),a},[]),eJ=(0,r.useCallback)((e,a)=>(console.log("Task 2: Applying mask clipping to canvas context"),a)?(e.save(),e.beginPath(),e.clip(a),console.log("Task 2: Mask clipping applied successfully"),console.log("Task 2: Canvas context is now clipped to mask path"),!0):(console.error("Task 2: No mask path provided for clipping"),!1),[]),eK=(0,r.useCallback)(e=>{console.log("Task 2: Restoring canvas context after clipping"),e.restore(),console.log("Task 2: Canvas context restored")},[]);(0,r.useCallback)(()=>{let e="draw"===ed&&D.length>3?D:en;return console.log("Task 2: Final border points:",e.length,"points from mode:",ed),e},[ed,D,en]),(0,r.useCallback)(async e=>{if(console.log("Task 3: Processing chroma key result with mask application"),!await e6()||!eG)return console.error("Task 3: No chroma key processed image available"),null;console.log("Task 3: Chroma key processing completed, applying mask");let a=await eY({transparentImage:eG,maskPath:e,borderOverlay:null});return a&&(console.log("Task 3: Mask successfully applied to transparent image"),console.log("Task 3: Final canvas dimensions:",a.width,"x",a.height)),a},[eG,eY]);let eQ=(0,r.useCallback)(async()=>(console.log("Task 4: Loading floral frame overlay"),es)?(console.log("Task 4: Using original image as floral frame overlay"),console.log("Task 4: Frame dimensions:",es.width,"x",es.height),es):(console.error("Task 4: No original image available for floral frame"),null),[es]);(0,r.useCallback)(async e=>{console.log("Task 4: Starting complete composition with floral frame"),await eQ();let a=await eY({transparentImage:eG,maskPath:e,borderOverlay:null});return a&&(console.log("Task 4: Complete composition with floral frame completed"),console.log("Task 4: Final result has transparent center + visible floral border")),a},[eQ,eG,eY]);let e0=(0,r.useCallback)(async e=>(console.log("Task 5: Exporting PNG with alpha transparency"),e)?new Promise((a,t)=>{try{console.log("Task 5: Converting canvas to PNG blob with alpha"),console.log("Task 5: Canvas dimensions:",e.width,"x",e.height),e.toBlob(s=>{if(!s){console.error("Task 5: Failed to create PNG blob"),t(Error("Failed to create PNG blob"));return}if("image/png"!==s.type){console.error("Task 5: Export is not PNG format:",s.type),t(Error("Export is not PNG format"));return}console.log("Task 5: PNG export successful"),console.log("Task 5: File size:",(s.size/1024/1024).toFixed(2),"MB"),console.log("Task 5: Alpha transparency preserved");let r=URL.createObjectURL(s);a({blob:s,url:r,canvas:e,dimensions:{width:e.width,height:e.height},format:"PNG",hasAlpha:!0,quality:1})},"image/png",1)}catch(e){console.error("Task 5: Error during PNG export:",e),t(e)}}):(console.error("Task 5: No canvas provided for export"),null),[]),e1=(0,r.useCallback)(async e=>{console.log("Task 5: Exporting final composition - masked transparent image only");try{if(!eG){console.error("Save blocked: No processed transparent image available"),setError("Please process background removal first before saving the border");return}console.log("Save validation passed: Processed transparent image available"),eP&&(console.log("Task 5: Confirming chroma key processing before export"),await new Promise(e=>{let a=()=>{eG?(console.log("Task 5: Processed image confirmed ready for export"),e()):(e6(),setTimeout(a,200))};a()}));let a=await eY({transparentImage:eG,maskPath:e,borderOverlay:null});if(!a)return console.error("Task 5: Failed to create masked composition"),null;let t=await e0(a);return t&&(console.log("Task 5: Masked transparent image exported successfully"),console.log("Task 5: Ready for save/upload - no floral frame")),t}catch(e){return console.error("Task 5: Error exporting masked composition:",e),null}},[eG,eY,e0]),e2=(0,r.useCallback)((e,a)=>{console.log("Task 7: Creating mask metadata for dynamic photo reuse");let t=e3(e),s={maskPath:e,maskBounds:t,pointCount:e.length,feather:eh[0],shadowBlur:ep[0],shadowOffset:ef[0],chromaKeySettings:eP?{enabled:!0,mode:eB,keyColor:"auto"===eB?eq:ez,tolerance:eI[0],edgeFeather:eZ[0],edgeSmoothness:eD[0],spillSuppression:e$[0]}:null,exportInfo:a?{dimensions:a.dimensions,format:a.format,hasAlpha:a.hasAlpha,quality:a.quality,timestamp:new Date().toISOString()}:null,autoFitMetadata:{maskArea:ac(e),aspectRatio:t?(t.width/t.height).toFixed(2):"1.0",centerPoint:ad(e),scalingStrategy:"contain",padding:10},templateInfo:{assetType:c,mode:ed,createdAt:new Date().toISOString(),version:"1.0.0",pipeline:"chroma_key_mask_frame_png"}};return console.log("Task 7: Mask metadata created"),console.log("Task 7: Mask bounds:",t),console.log("Task 7: Point count:",e.length),s},[eh,ep,ef,eP,eB,eq,ez,eI,eZ,eD,e$,c,ed]),e3=(0,r.useCallback)(e=>{if(console.log("Task 7: Calculating mask bounds for auto-fitting"),!e||0===e.length)return console.error("Task 7: No border points provided for bounds calculation"),null;let a=1/0,t=1/0,s=-1/0,r=-1/0;e.forEach(e=>{a=Math.min(a,e.x),t=Math.min(t,e.y),s=Math.max(s,e.x),r=Math.max(r,e.y)});let l={x:a,y:t,width:s-a,height:r-t,centerX:a+(s-a)/2,centerY:t+(r-t)/2};return console.log("Task 7: Mask bounds calculated:",l),l},[]),e4=(0,r.useCallback)(async(e,a)=>{console.log("Task 7: Persisting mask metadata for reuse");try{let s=e2(e,a);if(h){console.log("Task 7: Saving mask metadata to backend API");let e=(await Promise.resolve().then(t.bind(t,89420))).default;await e.put(`/api/admin/theme-assets/borders/${h}/mask-metadata`,s),console.log("Task 7: Backend metadata save completed")}try{let e=`wedlive-mask-metadata-${h||"temp"}`;localStorage.setItem(e,JSON.stringify(s)),console.log("Task 7: LocalStorage backup completed")}catch(e){console.warn("Task 7: LocalStorage backup failed:",e)}try{let e=`wedlive-mask-session-${Date.now()}`;sessionStorage.setItem(e,JSON.stringify(s)),console.log("Task 7: SessionStorage backup completed")}catch(e){console.warn("Task 7: SessionStorage backup failed:",e)}return console.log("Task 7: Mask metadata persistence completed"),console.log("Task 7: Metadata size:",JSON.stringify(s).length,"characters"),s}catch(e){return console.error("Task 7: Error persisting mask metadata:",e),null}},[h,e2]),e5=(0,r.useCallback)((e,a)=>{if(console.log("Task 8: Calculating auto-fit transform for photo"),!e||!a||!a.maskBounds)return console.error("Task 8: Missing photo image or mask metadata"),null;let{maskBounds:t,autoFitMetadata:s}=a,r=s.padding||10,l=t.width-2*r,o=t.height-2*r,n=l/e.width,i=o/e.height,d,c=0;switch(s.scalingStrategy){case"cover":d=Math.max(n,i);break;case"fill":d=n;break;default:d=Math.min(n,i)}let m=e.width*d,u=e.height*d,h={scale:d,offsetX:t.x+r+(l-m)/2,offsetY:t.y+r+(o-u)/2,scaledWidth:m,scaledHeight:u,sourceWidth:e.width,sourceHeight:e.height,maskBounds:t,scalingStrategy:s.scalingStrategy,padding:r};return console.log("Task 8: Auto-fit transform calculated:",h),h},[]),e7=(0,r.useCallback)((e,a,t,s)=>{if(console.log("Task 8: Applying photo to mask with auto-fit"),!e||!a||!t||!s)return console.error("Task 8: Missing required parameters for photo application"),!1;let r=e.getContext("2d"),l=eX(t.maskPath);return l?(r.clearRect(0,0,e.width,e.height),r.save(),r.beginPath(),r.clip(l),r.drawImage(a,s.offsetX,s.offsetY,s.scaledWidth,s.scaledHeight),r.restore(),console.log("Task 8: Photo applied to mask successfully"),console.log("Task 8: Photo dimensions:",s.scaledWidth,"x",s.scaledHeight),console.log("Task 8: Position:",s.offsetX,"x",s.offsetY),!0):(console.error("Task 8: Failed to create mask path"),!1)},[eX]),e8=(0,r.useCallback)(async(e,a,t)=>{console.log("Task 8: Creating dynamic photo composition");try{let s=e5(e,a);if(!s)return console.error("Task 8: Failed to calculate auto-fit transform"),null;let r=document.createElement("canvas");if(r.width=a.exportInfo.dimensions.width,r.height=a.exportInfo.dimensions.height,!e7(r,e,a,s))return console.error("Task 8: Failed to apply photo to mask"),null;t&&(r.getContext("2d").drawImage(t,0,0),console.log("Task 8: Floral frame overlay applied"));let l=await e0(r);return l&&(console.log("Task 8: Dynamic photo composition completed"),console.log("Task 8: Auto-fit strategy:",s.scalingStrategy),console.log("Task 8: Scale factor:",s.scale.toFixed(2))),l}catch(e){return console.error("Task 8: Error creating dynamic photo composition:",e),null}},[e5,e7,e0]);(0,r.useCallback)(async(e,a)=>(console.log("Task 8: Processing uploaded photo for dynamic fitting"),new Promise((t,s)=>{let r=new Image;r.onload=async()=>{console.log("Task 8: Photo loaded successfully:",r.width,"x",r.height);let e=await e8(r,a,es);e?(console.log("Task 8: Dynamic photo processing completed"),t(e)):s(Error("Failed to create dynamic photo composition"))},r.onerror=()=>{s(Error("Failed to load photo"))},r.src=URL.createObjectURL(e)})),[e8,es]);let e6=()=>{if(!es)return;console.log("Processing Simplified Background Removal");let e=document.createElement("canvas"),a=e.getContext("2d");e.width=es.width,e.height=es.height,a.drawImage(es,0,0);let t=a.getImageData(0,0,e.width,e.height),s=t.data,r=0;for(let e=0;e<s.length;e+=4)(s[e]+s[e+1]+s[e+2])/3<80&&(s[e+3]=0,r++);a.putImageData(t,0,0),console.log(`Background removal completed: ${r} pixels made transparent`),e.toBlob(a=>{let t=URL.createObjectURL(a),s=new Image;s.onload=()=>{eH(s),eW(e),console.log("Processed image with transparent background ready")},s.src=t},"image/png")},e9=(0,r.useCallback)(()=>{let e=Q.slice(0,ea+1);e.push(JSON.parse(JSON.stringify($))),ee(e),et(e.length-1)},[$,Q,ea]),ae=(0,r.useCallback)(()=>{ea>0&&(et(ea-1),U(Q[ea-1]))},[Q,ea]),aa=(0,r.useCallback)(()=>{ea<Q.length-1&&(et(ea+1),U(Q[ea+1]))},[Q,ea]),at=e=>{if("pen"!==Z||"draw"!==ed)return;let a=x.current,t=a.getBoundingClientRect(),s=a.width/t.width,r=a.height/t.height,l=(e.clientX-t.left)*s/G-V.x,o=(e.clientY-t.top)*r/G-V.y;console.log("Start drawing at:",{x:l,y:o,scaleX:s,scaleY:r,zoom:G}),E(!0),O([{x:l,y:o}])},as=e=>{if(!I||"pen"!==Z||"draw"!==ed)return;let a=x.current,t=a.getBoundingClientRect(),s=a.width/t.width,r=a.height/t.height,l=(e.clientX-t.left)*s/G-V.x,o=(e.clientY-t.top)*r/G-V.y;O(e=>[...e,{x:l,y:o}])},ar=()=>{I&&D.length>3&&(U([...$,{id:Date.now(),type:"freehand",points:D,feather:eh[0],shadowBlur:ep[0],shadowOffset:ef[0]}]),ei(D),e9()),E(!1),O([])},al=async e=>{eo(!0);let a=x.current;if(!a)return;let t=a.getContext("2d");a.width=e.width,a.height=e.height,t.drawImage(e,0,0);try{let a=[{x:50,y:50},{x:e.width-50,y:50},{x:e.width-50,y:e.height-50},{x:50,y:e.height-50}],t=[];for(let e=0;e<a.length;e++){let s=a[e],r=a[(e+1)%a.length];t.push(s);let l=(s.x+r.x)/2,o=(s.y+r.y)/2;0===e?t.push({x:l,y:o-20}):1===e?t.push({x:l+20,y:o}):2===e?t.push({x:l,y:o+20}):t.push({x:l-20,y:o})}ei(t)}catch(a){console.error("Border detection failed:",a),ei([{x:50,y:50},{x:e.width-50,y:50},{x:e.width-50,y:e.height-50},{x:50,y:e.height-50}])}finally{eo(!1)}},ao=()=>{"draw"===ed?ar():(E(!1),O([]),e_(null))},an=async()=>{console.log("Save button clicked"),console.log("Current mode:",ed),console.log("Current path length:",D.length),console.log("Detected border length:",en.length),console.log("onBorderSave exists:",!!a);let s="draw"===ed&&D.length>3?D:en;if(console.log("Final border length:",s.length),s.length>0)try{eN(!0),console.log("Task 6: Starting standardized pipeline: Chroma Key → Mask → Frame → PNG Export");let r=await e1(s);if(!r){console.error("Task 6: Pipeline failed - no export result");return}console.log("Task 6: Standardized pipeline completed successfully"),console.log("Task 6: Export result:",{dimensions:r.dimensions,format:r.format,hasAlpha:r.hasAlpha,fileSize:(r.blob.size/1024/1024).toFixed(2)+"MB"});let l=await e4(s,r),o={polygon_points:s,svg_path:ai(s),feather_radius:eh[0],inner_usable_area:ac(s),chroma_key_metadata:eP?{enabled:!0,mode:eB,key_color:"auto"===eB?eq:ez,tolerance:eI[0],edge_feather:eZ[0],edge_smoothness:eD[0],spill_suppression:e$[0]}:null,processed_image_info:{originalSize:(r.blob.size/1024/1024).toFixed(2)+"MB",dimensions:r.dimensions,format:r.format,hasAlpha:r.hasAlpha,timestamp:new Date().toISOString(),processedImageUrl:r.url,processedBlob:r.blob},export_metadata:{pipeline:"chroma_key_mask_frame_png",quality:r.quality,transparency:"preserved",source:"processed_transparent_image"},comprehensive_metadata:l};if(h){console.log("Task 6: Saving to backend API");let e=(await Promise.resolve().then(t.bind(t,89420))).default,{toast:a}=await Promise.resolve().then(t.bind(t,85999));await e.put(`/api/admin/theme-assets/borders/${h}/mask`,o),a.success("Border mask and processed image saved successfully!"),console.log("Task 6: Backend save completed")}a&&(console.log("Task 6: Calling onBorderSave with processed transparent image as primary source"),a({points:s,feather:eh[0],shadowBlur:ep[0],shadowOffset:ef[0],assetType:c,mode:ed,shapes:$,maskData:o,processedImage:r,processedImageUrl:r.url,processedBlob:r.blob,originalImage:es,originalImageUrl:e,source:"processed_transparent_image",hasTransparency:r.hasAlpha,pipeline:"chroma_key_mask_frame_png"}),console.log("Task 6: onBorderSave called with processed transparent image as source of truth")),eN(!1)}catch(e){console.error("Save failed:",e),setError("Failed to save border. Please try again."),eN(!1)}else console.log("Save conditions not met:",{hasBorder:s.length>0,hasCallback:!!a,borderLength:s.length})},ai=e=>{if(!e||0===e.length)return"";let a=`M ${e[0].x} ${e[0].y}`;for(let t=1;t<e.length-1;t++){let s=e[t],r=e[t+1],l=(s.x+r.x)/2,o=(s.y+r.y)/2;a+=` Q ${s.x} ${s.y}, ${l} ${o}`}if(e.length>2){let t=e[e.length-1],s=e[0];a+=` L ${t.x} ${t.y} L ${s.x} ${s.y}`}return a+" Z"},ad=e=>{let a=0,t=0,s=0;for(let r=0;r<e.length;r++){let l=e[r],o=e[(r+1)%e.length],n=l.x*o.y-o.x*l.y;s+=n,a+=(l.x+o.x)*n,t+=(l.y+o.y)*n}return Math.abs(s/=2)>1e-4?(a/=6*s,t/=6*s):(a=e.reduce((e,a)=>e+a.x,0)/e.length,t=e.reduce((e,a)=>e+a.y,0)/e.length),{x:a,y:t}},ac=e=>{if(!e||0===e.length)return{x:0,y:0,width:0,height:0};let a=e.map(e=>e.x),t=e.map(e=>e.y),s=Math.min(...a),r=Math.min(...t),l=eh[0];return{x:s+l,y:r+l,width:Math.max(...a)-s-2*l,height:Math.max(...t)-r-2*l}};return(0,s.jsxs)(l.Zb,{className:u,children:[(0,s.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)(l.ll,{className:"flex items-center gap-2",children:[s.jsx(v,{className:"w-5 h-5"}),"Border Editor - ",c.charAt(0).toUpperCase()+c.slice(1)]}),s.jsx(o.z,{onClick:d,variant:"ghost",size:"sm",children:s.jsx(m.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)(l.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(o.z,{onClick:()=>ec("detect"),variant:"detect"===ed?"default":"outline",size:"sm",children:[s.jsx(v,{className:"w-4 h-4 mr-2"}),"Auto Detect"]}),(0,s.jsxs)(o.z,{onClick:()=>ec("draw"),variant:"draw"===ed?"default":"outline",size:"sm",children:[s.jsx(j.Z,{className:"w-4 h-4 mr-2"}),"Draw"]}),(0,s.jsxs)(o.z,{onClick:()=>ec("edit"),variant:"edit"===ed?"default":"outline",size:"sm",children:[s.jsx(p,{className:"w-4 h-4 mr-2"}),"Edit"]})]}),(0,s.jsxs)(l.Zb,{className:"border-dashed",children:[s.jsx(l.Ol,{className:"pb-3",children:(0,s.jsxs)(l.ll,{className:"text-sm flex items-center gap-2",children:[s.jsx(w,{className:"w-4 h-4"}),"Chroma Key Background Removal"]})}),(0,s.jsxs)(l.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("label",{className:"flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:eP,onChange:e=>eM(e.target.checked),className:"mr-2 w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Enable Background Removal"})]}),eP&&s.jsx(n.C,{variant:"default",className:"text-xs",children:"Active"})]}),eP&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(o.z,{onClick:()=>eR("auto"),variant:"auto"===eB?"default":"outline",size:"sm",className:"text-xs",children:[s.jsx(N,{className:"w-3 h-3 mr-1"}),"Auto Detect"]}),(0,s.jsxs)(o.z,{onClick:()=>eR("custom"),variant:"custom"===eB?"default":"outline",size:"sm",className:"text-xs",children:[s.jsx(w,{className:"w-3 h-3 mr-1"}),"Custom Color"]})]}),"custom"===eB&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm font-medium",children:"Key Color:"}),s.jsx("input",{type:"color",value:ez,onChange:e=>eF(e.target.value),className:"w-12 h-8 border rounded cursor-pointer"}),s.jsx("span",{className:"text-xs text-gray-600",children:ez})]}),"auto"===eB&&eq&&(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("label",{className:"text-sm font-medium",children:"Detected:"}),s.jsx("div",{className:"w-12 h-8 border rounded",style:{backgroundColor:eq}}),s.jsx("span",{className:"text-xs text-gray-600",children:eq})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"text-sm font-medium mb-2 block",children:["Tolerance: ",eI[0],"%"]}),s.jsx(k.i,{value:eI,onValueChange:eE,max:100,min:0,step:1,className:"w-full"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"text-sm font-medium mb-2 block",children:["Edge Feather: ",eZ[0],"px"]}),s.jsx(k.i,{value:eZ,onValueChange:eA,max:10,min:0,step:.5,className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"text-sm font-medium mb-2 block",children:["Edge Smoothness: ",eD[0],"%"]}),s.jsx(k.i,{value:eD,onValueChange:eO,max:100,min:0,step:1,className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"text-sm font-medium mb-2 block",children:["Spill Suppression: ",e$[0],"%"]}),s.jsx(k.i,{value:e$,onValueChange:eU,max:100,min:0,step:1,className:"w-full"})]})]}),(0,s.jsxs)(o.z,{onClick:()=>e6(),disabled:!es,size:"sm",className:"w-full",children:[s.jsx(S.Z,{className:"w-4 h-4 mr-2"}),"Process Background Removal"]})]})]})]}),"draw"===ed&&(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(o.z,{onClick:()=>A("pen"),variant:"pen"===Z?"default":"outline",size:"sm",children:s.jsx(j.Z,{className:"w-4 h-4"})}),s.jsx(o.z,{onClick:ae,disabled:ea<=0,variant:"outline",size:"sm",children:s.jsx(C,{className:"w-4 h-4"})}),s.jsx(o.z,{onClick:aa,disabled:ea>=Q.length-1,variant:"outline",size:"sm",children:s.jsx(T,{className:"w-4 h-4"})}),s.jsx(o.z,{onClick:()=>X(!Y),variant:Y?"default":"outline",size:"sm",children:s.jsx(_,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:["detect"===ed&&(0,s.jsxs)(o.z,{onClick:()=>{es&&(al(es),U([]),O([]))},disabled:el||!es,variant:"outline",size:"sm",children:[s.jsx(v,{className:"w-4 h-4 mr-2"}),el?"Detecting...":"Redetect"]}),"draw"===ed&&(0,s.jsxs)(o.z,{onClick:()=>{O([]),U([]),ei([]),e9()},variant:"outline",size:"sm",children:[s.jsx(m.Z,{className:"w-4 h-4 mr-2"}),"Clear"]}),g&&(0,s.jsxs)(o.z,{onClick:()=>ej(!ev),variant:ev?"default":"outline",size:"sm",children:[s.jsx(P.Z,{className:"w-4 h-4 mr-2"}),ev?"Hide":"Show"," Preview"]}),s.jsx(o.z,{onClick:an,disabled:ew||!h&&!a||"detect"===ed&&0===en.length||"draw"===ed&&D.length<3,size:"sm",children:ew?(0,s.jsxs)(s.Fragment,{children:[s.jsx(i.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(M.Z,{className:"w-4 h-4 mr-2"}),"Save Border"]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(o.z,{onClick:()=>H(Math.max(.5,G-.25)),variant:"outline",size:"sm",children:s.jsx(B,{className:"w-4 h-4"})}),(0,s.jsxs)("span",{className:"text-sm",children:[Math.round(100*G),"%"]}),s.jsx(o.z,{onClick:()=>H(Math.min(3,G+.25)),variant:"outline",size:"sm",children:s.jsx(R.Z,{className:"w-4 h-4"})})]}),s.jsx(o.z,{onClick:()=>{H(1),W({x:0,y:0})},variant:"outline",size:"sm",children:s.jsx(z.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Detection Sensitivity"}),s.jsx(k.i,{value:em,onValueChange:eu,max:100,min:1,step:1,className:"w-full"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Feather Radius"}),s.jsx(k.i,{value:eh,onValueChange:eg,max:20,min:0,step:1,className:"w-full"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Shadow Blur"}),s.jsx(k.i,{value:ep,onValueChange:ex,max:50,min:0,step:1,className:"w-full"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Shadow Offset"}),s.jsx(k.i,{value:ef,onValueChange:ey,max:20,min:0,step:1,className:"w-full"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Template Opacity"}),s.jsx(k.i,{value:J,onValueChange:K,max:1,min:.1,step:.1,className:"w-full"})]})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:["detect"===ed&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"Redetect"})," to find borders automatically"]}),(0,s.jsxs)("p",{children:["• Switch to ",s.jsx("strong",{children:"Draw"})," mode to create custom borders"]})]}),"draw"===ed&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"Click & Drag"})," to draw custom border shape"]}),(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"Undo/Redo"})," to correct mistakes"]}),(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"Grid"})," for precision drawing"]}),(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"Natural freehand"})," - follows cursor path exactly"]})]}),"edit"===ed&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"Move tool"})," to pan the canvas"]}),(0,s.jsxs)("p",{children:["• Switch to ",s.jsx("strong",{children:"Draw"})," mode to create new shapes"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(n.C,{variant:"detect"===ed?"default":"secondary",children:"detect"===ed?"Auto-Detect":"draw"===ed?"Drawing":"Editing"}),"draw"===ed&&D.length>0&&(0,s.jsxs)(n.C,{variant:"outline",children:[D.length," points"]}),Y&&s.jsx(n.C,{variant:"outline",children:"Grid On"})]}),ev&&eb&&en.length>0&&(0,s.jsxs)(l.Zb,{children:[s.jsx(l.Ol,{children:(0,s.jsxs)(l.ll,{className:"text-sm flex items-center gap-2",children:[s.jsx(P.Z,{className:"w-4 h-4"}),"Real-time Mask Preview"]})}),s.jsx(l.aY,{children:(0,s.jsxs)("div",{className:"relative border rounded-lg overflow-hidden bg-gray-100",style:{maxWidth:"400px",maxHeight:"400px",margin:"0 auto"},children:[s.jsx("div",{style:{position:"relative",width:"100%",aspectRatio:"1",clipPath:en.length>0?`polygon(${en.map(e=>`${e.x}px ${e.y}px`).join(", ")})`:"none"},children:s.jsx("img",{src:g,alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover",filter:`blur(${eh[0]}px)`}})}),(0,s.jsxs)("div",{className:"absolute bottom-2 left-2 right-2 bg-black/60 text-white text-xs p-2 rounded",children:[(0,s.jsxs)("div",{children:["Feather: ",eh[0],"px"]}),(0,s.jsxs)("div",{children:["Points: ",en.length]})]})]})})]}),eP&&eG&&(0,s.jsxs)(l.Zb,{children:[s.jsx(l.Ol,{children:(0,s.jsxs)(l.ll,{className:"text-sm flex items-center gap-2",children:[s.jsx(w,{className:"w-4 h-4"}),"Chroma Key Preview - Background Removed"]})}),(0,s.jsxs)(l.aY,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-xs font-medium text-red-700 mb-2",children:"Original"}),s.jsx("div",{className:"relative border rounded-lg overflow-hidden bg-gray-100",style:{maxHeight:"200px"},children:s.jsx("img",{src:e,alt:"Original",className:"w-full h-full object-contain",style:{maxHeight:"200px"}})})]}),(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-xs font-medium text-green-700 mb-2",children:"Processed (Transparent)"}),s.jsx("div",{className:"relative border rounded-lg overflow-hidden",style:{maxHeight:"200px",backgroundImage:"repeating-conic-gradient(#e5e7eb 0% 25%, transparent 0% 50%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"},children:s.jsx("img",{src:eG.src,alt:"Processed",className:"w-full h-full object-contain",style:{maxHeight:"200px"}})})]})]}),s.jsx("div",{className:"mt-3 p-2 bg-gray-50 rounded text-xs",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-center",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"font-medium",children:"Mode:"})," ",eB]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"font-medium",children:"Tolerance:"})," ",eI[0],"%"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"font-medium",children:"Feather:"})," ",eZ[0],"px"]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"font-medium",children:"Key Color:"}),s.jsx("span",{className:"inline-block w-3 h-3 ml-1 border border-gray-300 rounded",style:{backgroundColor:"auto"===eB?eq:ez}})]})]})})]})]}),(0,s.jsxs)("div",{ref:y,className:"border rounded-lg overflow-auto bg-gray-50 max-h-96 relative",style:{minHeight:"400px",minWidth:"600px"},children:[!es&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg mb-2",children:"No image loaded"}),s.jsx("div",{className:"text-sm",children:"Please upload an image to edit borders"})]})}),s.jsx("canvas",{ref:x,className:"relative",style:{maxWidth:"100%",height:"auto",display:es?"block":"none",cursor:"draw"===ed&&"pen"===Z?"crosshair":"edit"===ed?"move":"default"},onMouseDown:e=>{if("draw"===ed)at(e);else if("edit"===ed){let a=x.current,t=a.getBoundingClientRect(),s=a.width/t.width,r=a.height/t.height,l=(e.clientX-t.left)*s/G-V.x,o=(e.clientY-t.top)*r/G-V.y;if(en&&Array.isArray(en)){let e=en.findIndex(e=>10>Math.sqrt(Math.pow(e.x-l,2)+Math.pow(e.y-o,2)));if(-1!==e){e_(e),E(!0);return}}"move"===Z&&(E(!0),O([{x:e.clientX-V.x*G,y:e.clientY-V.y*G}]))}},onMouseMove:e=>{if("draw"===ed)as(e);else if("edit"===ed&&I){let a=x.current,t=a.getBoundingClientRect(),s=a.width/t.width,r=a.height/t.height,l=(e.clientX-t.left)*s/G-V.x,o=(e.clientY-t.top)*r/G-V.y;if(null!==eT){let e=[...en];e[eT]={x:l,y:o},ei(e)}else"move"===Z&&W({x:(e.clientX-D[0].x)/G,y:(e.clientY-D[0].y)/G})}},onMouseUp:ao,onMouseLeave:ao}),s.jsx("canvas",{ref:f,className:"absolute top-0 left-0 pointer-events-none",style:{maxWidth:"100%",height:"auto",display:es?"block":"none"}})]})]})]})}let I=(0,t(61358).bR)();function E(){let e=(0,y.useRouter)(),[a,t]=(0,r.useState)(!0),[g,k]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),[w,N]=(0,r.useState)(null),[S,C]=(0,r.useState)([]),[T,_]=(0,r.useState)("all"),[P,M]=(0,r.useState)(null),[B,R]=(0,r.useState)(null),[z,E]=(0,r.useState)(""),[Z,A]=(0,r.useState)(""),[D,O]=(0,r.useState)(!0),[$,U]=(0,r.useState)("border"),[q,L]=(0,r.useState)(!1),[G,H]=(0,r.useState)(!1),[V,W]=(0,r.useState)(null),[Y,X]=(0,r.useState)(0),[J,K]=(0,r.useState)(null),[Q,ee]=(0,r.useState)(!1),[ea,et]=(0,r.useState)(!1),[es,er]=(0,r.useState)(null),[el,eo]=(0,r.useState)(null),[en,ei]=(0,r.useState)(null),ed=async()=>{let e=localStorage.getItem("token");if(e)try{t(!0);let a=await b.Z.get(`${I}/api/admin/borders`,{headers:{Authorization:`Bearer ${e}`}});console.log("[ADMIN_BORDERS] API Response:",{totalBorders:a.data.length,borders:a.data.map(e=>({name:e.name,category:e.category}))});let s={all:a.data.length,border:a.data.filter(e=>"border"===(e.category||"border")).length,background:a.data.filter(e=>"background"===(e.category||"border")).length};console.log("[ADMIN_BORDERS] Category counts:",s),C(a.data)}catch(e){console.error("Error loading borders:",e),j("Failed to load borders")}finally{t(!1)}},ec=async e=>{let a=e.target.files[0];if(!a)return;if(W(null),X(0),K(null),j(null),N(null),a.size>10485760){j("File size exceeds 10MB limit");return}if(!a.type.startsWith("image/")){j("Only image files are allowed");return}M(a);let t=new FileReader;t.onload=async e=>{let a=e.target.result;R(a),er(a),ee(!0);try{let e=await eg(a);K(e),"needs_removal"===e.recommendation?(L(!0),N("Black background detected! Background removal has been enabled automatically."),setTimeout(()=>{ex()},100)):"excellent"===e.recommendation&&N("Perfect! This image already has good transparency.")}catch(e){console.error("Transparency check failed:",e)}finally{ee(!1)}},t.readAsDataURL(a)},em=async e=>{console.log("Border data received from editor:",e),eo(e.maskData),et(!1),N('Mask defined! Now click "Upload Border" to save.')},eu=async e=>new Promise((a,t)=>{console.log("[Background Removal] Starting ultra-fast processing");let s=performance.now(),r=new Image;r.onload=()=>{let e=r.width,l=r.height;if(e>1e3||l>1e3){let a=Math.min(1e3/e,1e3/l);e*=a,l*=a}let o=document.createElement("canvas"),n=o.getContext("2d");o.width=e,o.height=l,n.drawImage(r,0,0,e,l);let i=n.getImageData(0,0,e,l),d=i.data,c=0;for(let e=0;e<d.length;e+=4){let a=d[e],t=d[e+1],s=d[e+2];a<20&&t<20&&s<20&&(d[e+3]=0,c++)}n.putImageData(i,0,0);let m=performance.now()-s;console.log(`[Background Removal] Ultra-fast processing completed in ${m.toFixed(2)}ms - ${c} pixels removed`),o.toBlob(e=>{e?a(e):t(Error("Failed to create PNG blob"))},"image/png",1)},r.onerror=t,r.src=URL.createObjectURL(e)}),eh=(e,a,t,s,r)=>{let l=(t*s+a)*4,o=(e[l]+e[l+1]+e[l+2])/3;for(let l=-2;l<=2;l++)for(let n=-2;n<=2;n++){if(0===l&&0===n)continue;let i=a+l,d=t+n;if(i>=0&&i<s&&d>=0&&d<r){let a=(d*s+i)*4;if(Math.abs(o-(e[a]+e[a+1]+e[a+2])/3)>60)return!0}}return!1},eg=async e=>new Promise(a=>{let t=new Image;t.crossOrigin="anonymous",t.onload=()=>{let e=document.createElement("canvas"),s=e.getContext("2d");e.width=t.width,e.height=t.height,s.drawImage(t,0,0);let r=s.getImageData(0,0,e.width,e.height).data,l=0,o=0,n=0,i=0;for(let a=0;a<r.length;a+=4){let t=r[a],s=r[a+1],d=r[a+2],c=r[a+3];if(n++,c<255&&l++,t<=30&&s<=30&&d<=30){o++;let t=a/4;eh(r,t%e.width,Math.floor(t/e.width),e.width,e.height)&&i++}}let d=l/n*100,c=(o-i)/n*100,m={hasTransparency:d>1,transparencyPercentage:d.toFixed(2),blackBackgroundPercentage:c.toFixed(2),totalPixels:n,transparentPixels:l,blackPixels:o,edgePixels:i,recommendation:ep(d,c)};console.log("[Transparency Check] Result:",m),a(m)},t.onerror=()=>{a({hasTransparency:!1,error:"Failed to load image for transparency check",recommendation:"error"})},t.src=e}),ep=(e,a)=>e>5?"excellent":e>1?"good":a>10?"needs_removal":a>1?"check_manually":"unknown",ex=async()=>{if(!P){console.warn("[Background Removal] No file selected");return}H(!0),X(50);try{console.log("[Background Removal] Starting instant processing for:",P.name);let e=await eu(P);X(90);let a=new FileReader;a.onload=a=>{W(a.target.result),X(100),H(!1);let t=(e.size/1024/1024).toFixed(2);console.log(`[Background Removal] Completed instantly. File size: ${t}MB`),N(`Background removed instantly! Processed file size: ${t}MB`)},a.readAsDataURL(e)}catch(e){console.error("Background removal failed:",e),j("Failed to remove background. Please try again."),H(!1),X(0)}},ef=()=>(console.log("[TRANSPARENT BORDER FIX] Auto-creating default rectangular mask for background-removed border"),{svg_path:"",polygon_points:[],feather_radius:8,inner_usable_area:{x:0,y:0,width:0,height:0},processedImage:null}),ey=async()=>{if(!P){j("Please select an image file");return}if(!z.trim()){j("Please enter a border name");return}console.log("[BORDER_UPLOAD] Category selected:",$),console.log("[BORDER_UPLOAD] Border name:",z),console.log("[BORDER_UPLOAD] Full upload details:",{name:z,category:$,tags:Z,supportsMirror:D,hasTransparency:q||null!==V});let e=el;if(!el&&(q||V)&&(console.log("[TRANSPARENT BORDER FIX] No mask defined, but background removal was done"),console.log("[TRANSPARENT BORDER FIX] Creating default mask to allow transparent border upload"),eo(e=ef())),!e){j("Please define mask using Border Editor or enable background removal");return}let a=localStorage.getItem("token"),t=new FormData,s=P,r=P.name.split(".").pop().toLowerCase(),l=r;if(e&&e.processedImage&&e.processedImage.blob)try{console.log("[Upload] Using processed transparent image from BorderEditor");let e=el.processedImage.blob;r="png",s=new File([e],P.name.replace(/\.[^/.]+$/,".png"),{type:"image/png"}),console.log("[Upload] PNG-32 format enforced with BorderEditor processed image:",{originalFormat:l,newFormat:"png",fileSize:(s.size/1024/1024).toFixed(2)+"MB",hasTransparency:!0,source:"BorderEditor processed image"})}catch(e){console.error("[Upload] Failed to use BorderEditor processed image:",e),j("Failed to use processed transparent image. Please try again.");return}else if(V)try{console.log("[Upload] Using processed image from old system - enforcing PNG-32 format");let e=await fetch(V),a=await e.blob();r="png",s=new File([a],P.name.replace(/\.[^/.]+$/,".png"),{type:"image/png"}),console.log("[Upload] PNG-32 format enforced (old system):",{originalFormat:l,newFormat:"png",fileSize:(s.size/1024/1024).toFixed(2)+"MB",hasTransparency:!0})}catch(e){console.error("[Upload] Failed to process image for PNG-32 conversion:",e),j("Failed to convert image to PNG-32 format. Please try again.");return}else if(q){console.log("[Upload] Background removal requested but no processed image - converting to PNG-32");let e=document.createElement("canvas"),a=e.getContext("2d"),t=new Image;await new Promise(l=>{t.onload=()=>{e.width=t.width,e.height=t.height,a.drawImage(t,0,0),e.toBlob(e=>{s=new File([e],P.name.replace(/\.[^/.]+$/,".png"),{type:"image/png"}),r="png",console.log("[Upload] PNG-32 conversion complete with full alpha channel"),l()},"image/png",1)},t.src=URL.createObjectURL(P)})}t.append("file",s),t.append("name",z),t.append("tags",Z),t.append("supports_mirror",D),t.append("category",$),console.log("[UPLOAD] FormData category being sent:",$),console.log("[UPLOAD] FormData entries:",{name:z,category:$,tags:Z,supports_mirror:D});let o=q||null!==V||e&&e.processedImage;t.append("has_transparency",o.toString()),t.append("remove_background",q.toString()),console.log("[Upload] Transparency metadata:",{hasTransparency:o,removeBackground:q,processedPreview:!!V,maskDataProcessed:!!(e&&e.processedImage)}),e.svg_path&&t.append("mask_svg_path",e.svg_path),e.polygon_points&&e.polygon_points.length>0&&t.append("mask_polygon_points",JSON.stringify(e.polygon_points)),t.append("feather_radius",e.feather_radius||8),t.append("mask_x",e.inner_usable_area?.x||0),t.append("mask_y",e.inner_usable_area?.y||0),t.append("mask_width",e.inner_usable_area?.width||0),t.append("mask_height",e.inner_usable_area?.height||0);try{k(!0),j(null);let e=await b.Z.post(`${I}/api/admin/borders/upload`,t,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"multipart/form-data"}});N("Border uploaded successfully!"),console.log("[UPLOAD_SUCCESS] Border uploaded with details:",{id:e.data.id,name:e.data.name,category:e.data.category,expected_category:$}),e.data.category!==$&&console.error("[UPLOAD_WARNING] Category mismatch!",{selected:$,saved:e.data.category}),C([e.data,...S]),M(null),R(null),E(""),A(""),O(!0),U("border"),eo(null),er(null),document.getElementById("border-file-input").value="",ed(),setTimeout(()=>N(null),3e3)}catch(e){console.error("Border upload failed:",e),j(e.response?.data?.detail||"Failed to upload border")}finally{k(!1)}},eb=async e=>{ei(e),er(e.cdn_url),et(!0)},ek=async e=>{if(!en)return;let a=localStorage.getItem("token"),t=new FormData,s=e.maskData;s.svg_path&&t.append("mask_svg_path",s.svg_path),s.polygon_points&&s.polygon_points.length>0&&t.append("mask_polygon_points",JSON.stringify(s.polygon_points)),t.append("feather_radius",s.feather_radius||8),t.append("mask_x",s.inner_usable_area?.x||0),t.append("mask_y",s.inner_usable_area?.y||0),t.append("mask_width",s.inner_usable_area?.width||0),t.append("mask_height",s.inner_usable_area?.height||0);try{k(!0);let e=await b.Z.put(`${I}/api/admin/borders/${en.id}/mask`,t,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"multipart/form-data"}});N("Border mask updated successfully!"),C(S.map(a=>a.id===en.id?e.data:a)),et(!1),ei(null),setTimeout(()=>N(null),3e3)}catch(e){console.error("Mask update failed:",e),j(e.response?.data?.detail||"Failed to update mask")}finally{k(!1)}},ev=async e=>{if(!confirm("Are you sure you want to delete this border?"))return;let a=localStorage.getItem("token");try{await b.Z.delete(`${I}/api/admin/borders/${e}`,{headers:{Authorization:`Bearer ${a}`}}),C(S.filter(a=>a.id!==e)),N("Border deleted successfully"),setTimeout(()=>N(null),3e3)}catch(e){console.error("Delete failed:",e),j("Failed to delete border")}};return a?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx(i.Z,{className:"w-12 h-12 text-rose-500 animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading borders..."})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex items-center justify-between mb-8",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)(o.z,{variant:"ghost",onClick:()=>e.push("/admin"),className:"mb-2",children:[s.jsx(d.Z,{className:"w-4 h-4 mr-2"}),"Back to Admin Dashboard"]}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Border Management"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Upload and manage photo borders with custom masks"})]})}),v&&(0,s.jsxs)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[s.jsx(c.Z,{className:"w-5 h-5 mr-2"}),v,s.jsx("button",{onClick:()=>j(null),className:"ml-auto",children:s.jsx(m.Z,{className:"w-4 h-4"})})]}),w&&(0,s.jsxs)("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center",children:[s.jsx(u.Z,{className:"w-5 h-5 mr-2"}),w,s.jsx("button",{onClick:()=>N(null),className:"ml-auto",children:s.jsx(m.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)(l.Zb,{className:"p-6 mb-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[s.jsx(h.Z,{className:"w-5 h-5 mr-2 text-rose-500"}),"Upload New Border with Mask"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Border Image (Max 10MB)"}),s.jsx("input",{id:"border-file-input",type:"file",accept:"image/*",onChange:ec,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-rose-50 file:text-rose-700 hover:file:bg-rose-100"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:q,onChange:e=>{let a=e.target.checked;L(a),a&&P&&setTimeout(()=>{ex()},100)},className:"mr-2"}),s.jsx("span",{className:"text-sm",children:"Remove Background"})]}),P&&!q&&s.jsx("button",{onClick:()=>{L(!0),setTimeout(()=>{ec({target:{files:[P]}})},100)},className:"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600 transition-colors",children:"Remove Background Now"})]}),G&&(0,s.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Processing background removal..."}),(0,s.jsxs)("span",{className:"text-sm text-blue-700",children:[Y,"%"]})]}),s.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Y}%`}})})]}),B&&s.jsx("div",{className:"space-y-4",children:V?(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Original"}),s.jsx("div",{className:"relative",children:s.jsx("img",{src:B,alt:"Original",className:"w-full h-48 object-contain rounded-lg border-2 border-gray-200 bg-white"})})]}),(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-green-700 mb-2",children:"Processed (Transparent)"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("div",{className:"w-full h-48 rounded-lg border-2 border-green-200 overflow-hidden",style:{backgroundImage:"repeating-conic-gradient(#e5e7eb 0% 25%, transparent 0% 50%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"},children:s.jsx("img",{src:V,alt:"Processed",className:"w-full h-full object-contain"})}),s.jsx("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded",children:"Background Removed"})]})]})]}):(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-red-700 mb-2",children:"Original"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("img",{src:B,alt:"Original",className:"w-full h-48 object-contain rounded-lg border-2 border-red-200 bg-white"}),s.jsx("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"Original Image"})]})]}),(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-green-700 mb-2",children:"Processed (Transparent)"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("div",{className:"w-full h-48 rounded-lg border-2 border-green-200 overflow-hidden",style:{backgroundImage:"repeating-conic-gradient(#e5e7eb 0% 25%, transparent 0% 50%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"},children:el&&el.processedImage&&el.processedImage.url?s.jsx("img",{src:el.processedImage.url,alt:"Processed Transparent",className:"w-full h-full object-contain"}):V?s.jsx("img",{src:V,alt:"Processed",className:"w-full h-full object-contain"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:G?(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto mb-2"}),s.jsx("p",{className:"text-xs",children:"Processing..."})]}):s.jsx("p",{className:"text-xs",children:'Click "Remove Background" to process'})})}),s.jsx("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded",children:V?"Background Removed":"Waiting"})]})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Border Name *"}),s.jsx("input",{type:"text",value:z,onChange:e=>E(e.target.value),placeholder:"Floral Wedding Border",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Border Category *"}),(0,s.jsxs)("select",{value:$,onChange:e=>U(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500",children:[s.jsx("option",{value:"border",children:"Border"}),s.jsx("option",{value:"background",children:"Background"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"border"===$?"✓ For: Bride/Groom photos (mirror effect), Couple, Studio, Precious Moments, Live stream background":"✓ For: Theme background, Live streaming page background"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (comma-separated)"}),s.jsx("input",{type:"text",value:Z,onChange:e=>A(e.target.value),placeholder:"floral, elegant, traditional",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-500"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"supports-mirror",checked:D,onChange:e=>O(e.target.checked),className:"w-4 h-4 text-rose-600 border-gray-300 rounded focus:ring-rose-500"}),s.jsx("label",{htmlFor:"supports-mirror",className:"ml-2 text-sm font-medium text-gray-700",children:"Supports Mirror (for Bride/Groom separate mode)"})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,s.jsxs)(o.z,{onClick:()=>{if(!P){j("Please select an image first");return}et(!0)},disabled:!P,variant:"outline",className:"flex items-center",children:[s.jsx(p,{className:"w-4 h-4 mr-2"}),el?"Edit Mask":"Define Mask"]}),P&&s.jsx(o.z,{onClick:()=>{q?(L(!1),W(null)):(L(!0),setTimeout(()=>{ex()},100))},variant:q?"default":"outline",className:`flex items-center ${q?"bg-green-600 hover:bg-green-700":""}`,children:q?(0,s.jsxs)(s.Fragment,{children:[s.jsx(u.Z,{className:"w-4 h-4 mr-2"}),"Background Removed"]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(x,{className:"w-4 h-4 mr-2"}),"Remove Background"]})}),el&&(0,s.jsxs)(n.C,{variant:"default",className:"flex items-center gap-1",children:[s.jsx(u.Z,{className:"w-3 h-3"}),"Mask Defined"]})]}),s.jsx(o.z,{onClick:ey,disabled:g||!P||!z,className:"w-full",children:g?(0,s.jsxs)(s.Fragment,{children:[s.jsx(i.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(h.Z,{className:"w-4 h-4 mr-2"}),"Upload Border"]})})]})]}),(0,s.jsxs)(l.Zb,{className:"p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4 flex items-center justify-between",children:(0,s.jsxs)("span",{children:["Uploaded Borders (",S.length,")"]})}),s.jsx("div",{className:"mb-6 border-b border-gray-200",children:s.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"All Borders"},{key:"border",label:"Border"},{key:"background",label:"Background"}].map(e=>{let a="all"===e.key?S.length:S.filter(a=>(a.category||"border")===e.key).length;return(0,s.jsxs)("button",{onClick:()=>_(e.key),className:`px-4 py-2 font-medium text-sm rounded-t-lg transition-colors ${T===e.key?"bg-rose-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,"data-testid":`filter-${e.key}`,children:[e.label," (",a,")"]},e.key)})})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.filter(e=>{let a=e.category||"border";return"all"===T||a===T}).map(e=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow",children:[(0,s.jsxs)("div",{className:"relative",children:[s.jsx("img",{src:e.processed_image_url||e.cdn_url,alt:e.name,className:"w-full h-48 object-cover",style:{backgroundImage:e.processed_image_url?"repeating-conic-gradient(#f0f0f0 0% 25%, #ffffff 0% 50%) 50% / 20px 20px":"none"}}),(0,s.jsxs)("div",{className:"absolute top-2 right-2 flex gap-2",children:[s.jsx(o.z,{size:"sm",variant:"secondary",onClick:()=>eb(e),className:"bg-white/90 hover:bg-white",children:s.jsx(p,{className:"w-3 h-3"})}),s.jsx(o.z,{size:"sm",variant:"destructive",onClick:()=>ev(e.id),className:"bg-red-500/90 hover:bg-red-600",children:s.jsx(f.Z,{className:"w-3 h-3"})})]})]}),(0,s.jsxs)("div",{className:"p-4",children:[s.jsx("h3",{className:"font-semibold text-lg truncate",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[s.jsx("span",{children:e.orientation}),(0,s.jsxs)("span",{children:[e.width,"x",e.height]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[s.jsx(n.C,{variant:"outline",className:"text-xs",children:e.mask?.suggested_aspect_ratio||"1:1"}),e.supports_mirror&&s.jsx(n.C,{variant:"secondary",className:"text-xs",children:"Mirror Support"})]}),e.category&&s.jsx("div",{className:"mt-2",children:s.jsx(n.C,{variant:"default",className:`text-xs ${"border"===e.category?"bg-purple-500":"bg-green-500"}`,children:"border"===e.category?"Border":"Background"})}),e.tags&&e.tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.map((e,a)=>s.jsx(n.C,{variant:"secondary",className:"text-xs",children:e},a))}),(0,s.jsxs)("div",{className:"mt-3 text-xs text-gray-500",children:[(0,s.jsxs)("div",{children:["Feather: ",e.mask?.feather_radius||8,"px"]}),e.mask?.svg_path&&s.jsx("div",{className:"text-green-600",children:"✓ SVG Mask"}),e.mask?.polygon_points?.length>0&&(0,s.jsxs)("div",{className:"text-blue-600",children:["✓ Polygon Mask (",e.mask.polygon_points.length," points)"]}),e.mask_slots&&e.mask_slots.length>0&&(0,s.jsxs)("div",{className:"text-purple-600 font-semibold",children:["✓ ",e.mask_slots.length," Photo Slots"]})]})]})]},e.id))}),0===S.filter(e=>{let a=e.category||"border";return"all"===T||a===T}).length&&s.jsx("p",{className:"text-center text-gray-500 py-8 col-span-3",children:"all"===T?"No borders uploaded yet":`No borders in "${T}" category`})]}),ea&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-auto",children:s.jsx(F,{imageUrl:es,onBorderSave:en?ek:em,onClose:()=>{et(!1),en||er(null),ei(null)},assetType:"border",className:"m-4"})})})]})})}},20835:(e,a,t)=>{"use strict";t.d(a,{C:()=>n});var s=t(10326);t(17577);var r=t(79360),l=t(46084);let o=(0,r.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:a,...t}){return s.jsx("div",{className:(0,l.cn)(o({variant:a}),e),...t})}},50560:(e,a,t)=>{"use strict";t.d(a,{Ol:()=>n,SZ:()=>d,Zb:()=>o,aY:()=>c,eW:()=>m,ll:()=>i});var s=t(10326),r=t(17577),l=t(46084);let o=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...a}));o.displayName="Card";let n=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...a}));n.displayName="CardHeader";let i=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",e),...a}));i.displayName="CardTitle";let d=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",e),...a}));d.displayName="CardDescription";let c=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,l.cn)("p-6 pt-0",e),...a}));c.displayName="CardContent";let m=r.forwardRef(({className:e,...a},t)=>s.jsx("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",e),...a}));m.displayName="CardFooter"},64745:(e,a,t)=>{"use strict";t.d(a,{i:()=>n});var s=t(10326),r=t(17577),l=t(87131),o=t(46084);let n=r.forwardRef(({className:e,...a},t)=>(0,s.jsxs)(l.fC,{ref:t,className:(0,o.cn)("relative flex w-full touch-none select-none items-center",e),...a,children:[s.jsx(l.fQ,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:s.jsx(l.e6,{className:"absolute h-full bg-primary"})}),s.jsx(l.bU,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));n.displayName=l.fC.displayName},86333:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},32933:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},12714:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},77506:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},99598:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("move",[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]])},85206:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},31215:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},88378:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},98091:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},63685:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},94019:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7937:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]])},225:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$typeof:()=>o,__esModule:()=>l,default:()=>n});var s=t(68570);let r=(0,s.createProxy)(String.raw`/app/frontend/app/admin/borders/page.js`),{__esModule:l,$$typeof:o}=r;r.default;let n=(0,s.createProxy)(String.raw`/app/frontend/app/admin/borders/page.js#default`)},37125:(e,a,t)=>{"use strict";function s(e,[a,t]){return Math.min(t,Math.max(a,e))}t.d(a,{u:()=>s})},82561:(e,a,t)=>{"use strict";function s(e,a,{checkForDefaultPrevented:t=!0}={}){return function(s){if(e?.(s),!1===t||!s.defaultPrevented)return a?.(s)}}t.d(a,{Mj:()=>s}),"undefined"!=typeof window&&window.document&&window.document.createElement},93095:(e,a,t)=>{"use strict";t.d(a,{b:()=>o,k:()=>l});var s=t(17577),r=t(10326);function l(e,a){let t=s.createContext(a),l=e=>{let{children:a,...l}=e,o=s.useMemo(()=>l,Object.values(l));return(0,r.jsx)(t.Provider,{value:o,children:a})};return l.displayName=e+"Provider",[l,function(r){let l=s.useContext(t);if(l)return l;if(void 0!==a)return a;throw Error(`\`${r}\` must be used within \`${e}\``)}]}function o(e,a=[]){let t=[],l=()=>{let a=t.map(e=>s.createContext(e));return function(t){let r=t?.[e]||a;return s.useMemo(()=>({[`__scope${e}`]:{...t,[e]:r}}),[t,r])}};return l.scopeName=e,[function(a,l){let o=s.createContext(l),n=t.length;t=[...t,l];let i=a=>{let{scope:t,children:l,...i}=a,d=t?.[e]?.[n]||o,c=s.useMemo(()=>i,Object.values(i));return(0,r.jsx)(d.Provider,{value:c,children:l})};return i.displayName=a+"Provider",[i,function(t,r){let i=r?.[e]?.[n]||o,d=s.useContext(i);if(d)return d;if(void 0!==l)return l;throw Error(`\`${t}\` must be used within \`${a}\``)}]},function(...e){let a=e[0];if(1===e.length)return a;let t=()=>{let t=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=t.reduce((a,{useScope:t,scopeName:s})=>{let r=t(e)[`__scope${s}`];return{...a,...r}},{});return s.useMemo(()=>({[`__scope${a.scopeName}`]:r}),[r])}};return t.scopeName=a.scopeName,t}(l,...a)]}},77335:(e,a,t)=>{"use strict";t.d(a,{WV:()=>d,jH:()=>c});var s=t(17577),r=t(60962),l=t(48051),o=t(10326),n=Symbol("radix.slottable");function i(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===n}var d=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let t=function(e){let a=function(e){let a=s.forwardRef((e,a)=>{let{children:t,...r}=e;if(s.isValidElement(t)){let e,o;let n=(e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?t.props.ref:t.props.ref||t.ref,i=function(e,a){let t={...a};for(let s in a){let r=e[s],l=a[s];/^on[A-Z]/.test(s)?r&&l?t[s]=(...e)=>{let a=l(...e);return r(...e),a}:r&&(t[s]=r):"style"===s?t[s]={...r,...l}:"className"===s&&(t[s]=[r,l].filter(Boolean).join(" "))}return{...e,...t}}(r,t.props);return t.type!==s.Fragment&&(i.ref=a?(0,l.F)(a,n):n),s.cloneElement(t,i)}return s.Children.count(t)>1?s.Children.only(null):null});return a.displayName=`${e}.SlotClone`,a}(e),t=s.forwardRef((e,t)=>{let{children:r,...l}=e,n=s.Children.toArray(r),d=n.find(i);if(d){let e=d.props.children,r=n.map(a=>a!==d?a:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,o.jsx)(a,{...l,ref:t,children:s.isValidElement(e)?s.cloneElement(e,void 0,r):null})}return(0,o.jsx)(a,{...l,ref:t,children:r})});return t.displayName=`${e}.Slot`,t}(`Primitive.${a}`),r=s.forwardRef((e,s)=>{let{asChild:r,...l}=e,n=r?t:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(n,{...l,ref:s})});return r.displayName=`Primitive.${a}`,{...e,[a]:r}},{});function c(e,a){e&&r.flushSync(()=>e.dispatchEvent(a))}},52067:(e,a,t)=>{"use strict";t.d(a,{T:()=>n});var s,r=t(17577),l=t(65819),o=(s||(s=t.t(r,2)))[" useInsertionEffect ".trim().toString()]||l.b;function n({prop:e,defaultProp:a,onChange:t=()=>{},caller:s}){let[l,n,i]=function({defaultProp:e,onChange:a}){let[t,s]=r.useState(e),l=r.useRef(t),n=r.useRef(a);return o(()=>{n.current=a},[a]),r.useEffect(()=>{l.current!==t&&(n.current?.(t),l.current=t)},[t,l]),[t,s,n]}({defaultProp:a,onChange:t}),d=void 0!==e,c=d?e:l;{let a=r.useRef(void 0!==e);r.useEffect(()=>{let e=a.current;if(e!==d){let a=d?"controlled":"uncontrolled";console.warn(`${s} is changing from ${e?"controlled":"uncontrolled"} to ${a}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}a.current=d},[d,s])}return[c,r.useCallback(a=>{if(d){let t="function"==typeof a?a(e):a;t!==e&&i.current?.(t)}else n(a)},[d,e,n,i])]}Symbol("RADIX:SYNC_STATE")},65819:(e,a,t)=>{"use strict";t.d(a,{b:()=>r});var s=t(17577),r=globalThis?.document?s.useLayoutEffect:()=>{}},53405:(e,a,t)=>{"use strict";t.d(a,{D:()=>r});var s=t(17577);function r(e){let a=s.useRef({value:e,previous:e});return s.useMemo(()=>(a.current.value!==e&&(a.current.previous=a.current.value,a.current.value=e),a.current.previous),[e])}},2566:(e,a,t)=>{"use strict";t.d(a,{t:()=>l});var s=t(17577),r=t(65819);function l(e){let[a,t]=s.useState(void 0);return(0,r.b)(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});let a=new ResizeObserver(a=>{let s,r;if(!Array.isArray(a)||!a.length)return;let l=a[0];if("borderBoxSize"in l){let e=l.borderBoxSize,a=Array.isArray(e)?e[0]:e;s=a.inlineSize,r=a.blockSize}else s=e.offsetWidth,r=e.offsetHeight;t({width:s,height:r})});return a.observe(e,{box:"border-box"}),()=>a.unobserve(e)}t(void 0)},[e]),a}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[8948,168,6451,7131,4342],()=>t(77257));module.exports=s})();