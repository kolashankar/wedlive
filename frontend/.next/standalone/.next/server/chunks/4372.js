exports.id=4372,exports.ids=[4372],exports.modules={58359:()=>{},93739:()=>{},2815:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var a=s(10326),r=s(17577),n=s(18729),l=s(26655),i=s(50560),o=s(6952),c=s(59593),d=s(91438),m=s(85206),u=s(98091),x=s(69436),f=s(40617),p=s(77506),h=s(85999),g=s(89420),j=s(88646),y=s(66393),N=s(97401);function v({comment:e,onReply:t,onLike:s,onDelete:i,onEdit:o,currentUserId:f,depth:p=0}){let[h,g]=(0,r.useState)(!0),[j,y]=(0,r.useState)(!1),[w,b]=(0,r.useState)(!1),[C,_]=(0,r.useState)(e.comment),[S,k]=(0,r.useState)(""),[R,E]=(0,r.useState)(!1),Z=f===e.user_id,z=e.replies&&e.replies.length>0,F=async s=>{s.preventDefault(),S.trim()&&(await t(e.id,S),k(""),y(!1))},D=async()=>{C.trim()&&(await o(e.id,C),b(!1))};return a.jsx("div",{className:`${p>0?"ml-12 mt-4":"mt-6"}`,children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(l.qE,{className:"w-10 h-10",children:[a.jsx(l.F$,{src:e.user_avatar}),a.jsx(l.Q5,{className:"bg-gradient-to-br from-rose-500 to-purple-600 text-white",children:e.user_name?.charAt(0)?.toUpperCase()||"U"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"font-semibold text-sm",children:e.user_name}),R&&a.jsx("span",{className:"text-xs text-gray-500",suppressHydrationWarning:!0,children:(0,N.Q)(new Date(e.created_at),{addSuffix:!0})}),e.updated_at&&a.jsx("span",{className:"text-xs text-gray-400",children:"(edited)"})]}),w?(0,a.jsxs)("div",{className:"mb-2",children:[a.jsx("textarea",{value:C,onChange:e=>_(e.target.value),className:"w-full p-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-rose-500",rows:3}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[a.jsx(n.z,{size:"sm",onClick:D,children:"Save"}),a.jsx(n.z,{size:"sm",variant:"outline",onClick:()=>{_(e.comment),b(!1)},children:"Cancel"})]})]}):a.jsx("p",{className:"text-sm text-gray-800 mb-2 whitespace-pre-wrap",children:e.comment}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{onClick:()=>s(e.id),className:`flex items-center gap-1 text-sm transition-colors ${e.is_liked_by_user?"text-rose-600 font-semibold":"text-gray-600 hover:text-rose-600"}`,children:[a.jsx(c.Z,{className:`w-4 h-4 ${e.is_liked_by_user?"fill-rose-600":""}`}),a.jsx("span",{children:e.likes_count>0?e.likes_count:"Like"})]}),p<2&&(0,a.jsxs)("button",{onClick:()=>y(!j),className:"flex items-center gap-1 text-sm text-gray-600 hover:text-rose-600 transition-colors",children:[a.jsx(d.Z,{className:"w-4 h-4"}),a.jsx("span",{children:"Reply"})]}),Z&&!w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>b(!0),className:"flex items-center gap-1 text-sm text-gray-600 hover:text-blue-600 transition-colors",children:[a.jsx(m.Z,{className:"w-3 h-3"}),a.jsx("span",{children:"Edit"})]}),(0,a.jsxs)("button",{onClick:()=>i(e.id),className:"flex items-center gap-1 text-sm text-gray-600 hover:text-red-600 transition-colors",children:[a.jsx(u.Z,{className:"w-3 h-3"}),a.jsx("span",{children:"Delete"})]})]})]}),j&&a.jsx("form",{onSubmit:F,className:"mt-3",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:S,onChange:e=>k(e.target.value),placeholder:"Write a reply...",className:"flex-1 px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-rose-500",autoFocus:!0}),a.jsx(n.z,{type:"submit",size:"sm",disabled:!S.trim(),children:a.jsx(x.Z,{className:"w-4 h-4"})})]})}),z&&a.jsx("div",{className:"mt-3",children:e.replies.map(e=>a.jsx(v,{comment:e,onReply:t,onLike:s,onDelete:i,onEdit:o,currentUserId:f,depth:p+1},e.id))})]})]})})}function w({weddingId:e}){let{user:t}=(0,j.a)(),{socket:s}=(0,y.s)(),[c,d]=(0,r.useState)([]),[m,u]=(0,r.useState)(""),[x,N]=(0,r.useState)(!0),[w,b]=(0,r.useState)(!1),C=(0,r.useRef)(null),_=async s=>{if(s.preventDefault(),m.trim()){if(!t){h.toast.error("Please log in to comment");return}try{b(!0),await g.default.post("/api/comments",{wedding_id:e,comment:m,parent_comment_id:null}),u("")}catch(e){console.error("Error posting comment:",e),h.toast.error(e.response?.data?.detail||"Failed to post comment")}finally{b(!1)}}},S=async(s,a)=>{if(!t){h.toast.error("Please log in to reply");return}try{await g.default.post("/api/comments",{wedding_id:e,comment:a,parent_comment_id:s})}catch(e){console.error("Error posting reply:",e),h.toast.error("Failed to post reply")}},k=async e=>{if(!t){h.toast.error("Please log in to like comments");return}try{await g.default.post(`/api/comments/${e}/like`)}catch(e){console.error("Error liking comment:",e),h.toast.error("Failed to like comment")}},R=async(e,t)=>{try{await g.default.put(`/api/comments/${e}`,{comment:t}),h.toast.success("Comment updated")}catch(e){console.error("Error editing comment:",e),h.toast.error("Failed to edit comment")}},E=async e=>{if(confirm("Are you sure you want to delete this comment?"))try{await g.default.delete(`/api/comments/${e}`),h.toast.success("Comment deleted")}catch(e){console.error("Error deleting comment:",e),h.toast.error("Failed to delete comment")}};return(0,a.jsxs)(i.Zb,{children:[a.jsx(i.Ol,{children:(0,a.jsxs)(i.ll,{className:"flex items-center gap-2",children:[a.jsx(f.Z,{className:"w-5 h-5"}),"Comments (",c.length,")"]})}),(0,a.jsxs)(i.aY,{children:[t?a.jsx("form",{onSubmit:_,className:"mb-6",children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(l.qE,{className:"w-10 h-10",children:[a.jsx(l.F$,{src:t.avatar_url}),a.jsx(l.Q5,{className:"bg-gradient-to-br from-rose-500 to-purple-600 text-white",children:t.full_name?.charAt(0)?.toUpperCase()||"U"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("textarea",{value:m,onChange:e=>u(e.target.value),placeholder:"Add a comment...",className:"w-full p-3 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-rose-500 resize-none",rows:3}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[a.jsx(n.z,{type:"button",variant:"outline",size:"sm",onClick:()=>u(""),disabled:!m.trim(),children:"Cancel"}),a.jsx(n.z,{type:"submit",size:"sm",disabled:!m.trim()||w,children:w?a.jsx(p.Z,{className:"w-4 h-4 animate-spin"}):"Comment"})]})]})]})}):a.jsx("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-md text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Please ",a.jsx("a",{href:"/login",className:"text-rose-600 hover:underline font-semibold",children:"log in"})," to leave a comment"]})}),a.jsx(o.Z,{className:"mb-6"}),x?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(p.Z,{className:"w-6 h-6 animate-spin text-rose-500"})}):0===c.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx(f.Z,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),a.jsx("p",{className:"text-gray-500",children:"No comments yet"}),a.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Be the first to share your thoughts!"})]}):a.jsx("div",{className:"space-y-1",children:c.map(e=>a.jsx(v,{comment:e,onReply:S,onLike:k,onDelete:E,onEdit:R,currentUserId:t?.id,depth:0},e.id))}),a.jsx("div",{ref:C})]})]})}},26655:(e,t,s)=>{"use strict";s.d(t,{F$:()=>o,Q5:()=>c,qE:()=>i});var a=s(10326),r=s(17577),n=s(4720),l=s(46084);let i=r.forwardRef(({className:e,...t},s)=>a.jsx(n.fC,{ref:s,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));i.displayName=n.fC.displayName;let o=r.forwardRef(({className:e,...t},s)=>a.jsx(n.Ee,{ref:s,className:(0,l.cn)("aspect-square h-full w-full",e),...t}));o.displayName=n.Ee.displayName;let c=r.forwardRef(({className:e,...t},s)=>a.jsx(n.NY,{ref:s,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));c.displayName=n.NY.displayName},20835:(e,t,s)=>{"use strict";s.d(t,{C:()=>i});var a=s(10326);s(17577);var r=s(79360),n=s(46084);let l=(0,r.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:t,...s}){return a.jsx("div",{className:(0,n.cn)(l({variant:t}),e),...s})}},50560:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>i,SZ:()=>c,Zb:()=>l,aY:()=>d,eW:()=>m,ll:()=>o});var a=s(10326),r=s(17577),n=s(46084);let l=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...t}));l.displayName="Card";let i=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let o=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let c=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));c.displayName="CardDescription";let d=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,n.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent";let m=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t}));m.displayName="CardFooter"},6952:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(10326),r=s(17577),n=s(17415),l=s(46084);let i=r.forwardRef(({className:e,orientation:t="horizontal",decorative:s=!0,...r},i)=>a.jsx(n.f,{ref:i,decorative:s,orientation:t,className:(0,l.cn)("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...r}));i.displayName=n.f.displayName},66393:(e,t,s)=>{"use strict";s.d(t,{s:()=>o,w:()=>i});var a=s(10326),r=s(17577);s(80057);var n=s(61358);let l=(0,r.createContext)(null);function i({children:e,weddingId:t}){let s=(0,r.useRef)(null),[n,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(0),[d,m]=(0,r.useState)([]),[u,x]=(0,r.useState)([]),[f,p]=(0,r.useState)(null),[h,g]=(0,r.useState)(null),[j,y]=(0,r.useState)(null),N={socket:s.current,isConnected:n,viewerCount:o,messages:d,reactions:u,recordingStatus:f,qualityChanged:h,newMedia:j,sendMessage:(e,a="Anonymous")=>{s.current&&n&&s.current.emit("send_message",{wedding_id:t,message:e,guest_name:a,timestamp:new Date().toISOString()})},sendReaction:(e,a="Anonymous")=>{s.current&&n&&s.current.emit("send_reaction",{wedding_id:t,emoji:e,guest_name:a,timestamp:new Date().toISOString()})},switchCamera:e=>{s.current&&n&&s.current.emit("camera_switch",{wedding_id:t,camera_id:e})},updateQuality:e=>{s.current&&n&&s.current.emit("stream_quality_update",{wedding_id:t,quality:{level:e}})}};return a.jsx(l.Provider,{value:N,children:e})}function o(){return(0,r.useContext)(l)||{socket:null,isConnected:!1,viewerCount:0,messages:[],reactions:[],recordingStatus:null,qualityChanged:null,newMedia:null,sendMessage:()=>{},sendReaction:()=>{},switchCamera:()=>{},updateQuality:()=>{}}}process.env.NEXT_PUBLIC_SOCKET_URL||(0,n.bR)()}};